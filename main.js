!function(){"use strict";function t(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t){for(var n=2,i=arguments.length;n<i;++n)e+=arguments[n];throw Error(e)}}function r(t){var e={};return o(t,function(t,n){e[t]=n}),e}function o(t,e){if(null!=t)for(var n in t)uo.call(t,n)&&e(n,t[n])}function s(t,e){for(var n=t.length-1;e<n;)t[e]=t[++e];t.pop()}function a(t,e){var n=t.indexOf(e);return i(n>=0,'"',t,'" does not contain "',e,'"!'),{start:t.substr(0,n),end:t.substr(n+1)}}function u(t){if(!t)return{};for(var e={},n=0,i=t.length;n<i;++n)for(var r=t[n],o=0,s=r.length;o<s;++o)for(var a=r[o],u=e[a]||(e[a]=[]),h=0;h<s;++h){var l=r[h];l!==a&&u.indexOf(l)===-1&&u.push(l)}return e}function h(t){var e=/^(\d?\d):(\d\d)(:\d\d)?$/.exec(String(t).trim());if(e){var n=60*+e[1]*60+60*+e[2];return e[3]&&(n+=+e[3].slice(1)),n}}function l(t){return t=0|t,c({length:t})}function c(t){function e(t){if(null==t)return 0;t=""+t;var e=o[t];if(e)return e;var n=r.length;return i(n<=255,"The number of activities exceeds the limit of 255!"),r.push(t),o[t]=n,n}var n=t.buffer,r=t.activityForId,o=t.idForActivity,s=t.length;s=0|s,i(s>=0,"Can't create a timespan of negative length (",s,")!"),n=n||new ArrayBuffer(p(s));var a=createASM(window,{length:s},n),u=new Uint8Array(n,0,s);r=r||[""],o=o||{};var h=Object.freeze({length:s,overwrite:function(t){var n=t.from,i=t.to,r=t.activity;return a.overwrite(n,i,e(r))},underwrite:function(t){var n=t.from,i=t.to,r=t.activity;return a.underwrite(n,i,e(r))},overwritePeriodically:function(t){var n=t.from,i=t.to,r=t.period,o=t.cycles,s=t.activity;return a.overwritePeriodically(n,i,r,o,e(s))},findStartOf:function(t){var e=t.activity,n=t.from,i=t.to;void 0===i&&(i=s);var r=void 0===e?0:o[e];return"number"!=typeof r?i:a.findStartOf(r,n,i)},findEnd:function(t){var e=t.from,n=t.to;return a.findEnd(e,void 0===n?s:n)},findStart:function(t){var e=t.from;return a.findStart(e)},get:function(t){if(t>=0&&t<s){var e=u[0|t];if(e)return r[e]}},resize:function(t){if(t===s)return h;if(t<s)return a.overwrite(t,s,0),c({buffer:n,activityForId:r,idForActivity:o,length:t});if(t>s){var e=p(t);if(e<=n.byteLength)return c({buffer:n,activityForId:r,idForActivity:o,length:t});for(var i=new ArrayBuffer(e),u=Math.ceil(s/4),l=new Uint32Array(n,0,u),f=new Uint32Array(i,0,u),d=0;d<u;++d)f[d]=l[d];return c({buffer:i,activityForId:r,idForActivity:o,length:t})}},copyFrom:function(t){var e=t.other,n=t.from,i=t.to,r=t.start;e=e||h,n=0|n,i=void 0===i?e.length:0|i,r=0|r;for(var o=n;o<i;){var s=e.findEnd({from:o,to:i});h.overwrite({from:o-n+r,to:s-n+r,activity:e.get(o)}),o=s}}});return h}function p(t){return t=0|t,t<=65536?65536:t>=67108864?t+67108863&-67108864:(--t,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1)}function createASM(t,e,n){"use asm";var i=e.length|0;var r=new t.Uint8Array(n);var o=new t.Uint32Array(n);function s(t,e,n){t=t|0;e=e|0;n=n|0;var s=0,a=0,u=0,h=0;if((t|0)<0){t=0}if((e|0)>(i|0)){e=i}if((e|0)<=(t|0)){return 0}a=t+3&~3;u=e&~3;if((a|0)>(e|0)?1:(u|0)<(t|0)){a=e;u=e}else{s=n|n<<8|n<<16|n<<24}h=e-t|0;while((t|0)<(a|0)){r[t>>0]=n;t=t+1|0}while((a|0)<(u|0)){o[a>>2]=s;a=a+4|0}while((u|0)<(e|0)){r[u>>0]=n;u=u+1|0}return h|0}function a(t,e,n){t=t|0;e=e|0;n=n|0;var s=0,a=0,u=0;if((t|0)<0){t=0}if((e|0)>(i|0)){e=i}if((e|0)<=(t|0)){return}a=t+3&~3;u=e&~3;if((a|0)>(e|0)?1:(u|0)<(t|0)){a=e;u=e}else{s=n|n<<8|n<<16|n<<24}while((t|0)<(a|0)){if(!(r[t>>0]|0)){r[t>>0]=n}t=t+1|0}while((a|0)<(u|0)){if(o[a>>2]|0){if(!(r[a>>0]|0)){r[a>>0]=n}for(a=a+1|0;a&3;a=a+1|0){if(!(r[a>>0]|0)){r[a>>0]=n}}}else{o[a>>2]=s;a=a+4|0}}while((u|0)<(e|0)){if(!(r[u>>0]|0)){r[u>>0]=n}u=u+1|0}}function u(t,e,n,i,r){t=t|0;e=e|0;n=n|0;i=i|0;r=r|0;var o=0,a=0;if((n|0)<0){a=i;while((a|0)>1){a=a-1|0;o=o+n|0}t=t+o|0;e=e+o|0;n=-n|0;o=0;a=0}if((e-t|0)>=(n|0)){if((i|0)<=0?1:(e|0)<=(t|0)){return 0}while((i|0)>1){i=i-1|0;o=o+n|0}return s(t,e+o|0,r)|0}while((i|0)>0){a=a+(s(t+o|0,e+o|0,r)|0)|0;i=i-1|0;o=o+n|0}return a|0}function h(t,e,n){t=t|0;e=e|0;n=n|0;var s=0,a=0,u=0;if((n|0)>(i|0)){n=i}if((e|0)<0){e=0}else if((e|0)>=(n|0)){return n|0}else{a=e+3&~3;if((a|0)>(n|0)){a=n}while((e|0)<(a|0)){if((r[e>>0]|0)==(t|0)){return e|0}e=e+1|0}}u=n-3|0;while(1){if((a|0)>=(n|0)){return n|0}if((r[a>>0]|0)==(t|0)){return a|0}a=a+1|0;if((a|0)>=(n|0)){return n|0}if((r[a>>0]|0)==(t|0)){return a|0}a=a+1|0;if((a|0)>=(n|0)){return n|0}if((r[a>>0]|0)==(t|0)){return a|0}a=a+1|0;if((a|0)>=(n|0)){return n|0}if((r[a>>0]|0)==(t|0)){return a|0}s=o[a>>2]|0;a=a+1|0;while((a|0)<(u|0)){if((o[a>>2]|0)!=(s|0)){break}a=a+4|0}}return n|0}function l(t,e){t=t|0;e=e|0;var n=0,s=0,a=0,u=0;if((e|0)>(i|0)){e=i}if((t|0)<0){return 0}else if((t|0)>=(e|0)){return e|0}n=r[t>>0]|0;a=t+3&~3;if((a|0)>(e|0)){a=e}for(t=t+1|0;(t|0)<(a|0);t=t+1|0){if((r[t>>0]|0)!=(n|0)){return t|0}}s=n|n<<8|n<<16|n<<24;u=e-3|0;while(1){while((a|0)<(u|0)){if((o[a>>2]|0)!=(s|0)){break}a=a+4|0}if((a|0)>=(e|0)){return e|0}if((r[a>>0]|0)!=(n|0)){return a|0}a=a+1|0;if((a|0)>=(e|0)){return e|0}if((r[a>>0]|0)!=(n|0)){return a|0}a=a+1|0;if((a|0)>=(e|0)){return e|0}if((r[a>>0]|0)!=(n|0)){return a|0}a=a+1|0;if((a|0)>=(e|0)){return e|0}if((r[a>>0]|0)!=(n|0)){return a|0}a=a+1|0}return e|0}function c(t){t=t|0;var e=0,n=0,s=0;if((t|0)<0){return 0}else if((t|0)>=(i|0)){return i|0}e=r[t>>0]|0;s=t&~3;for(t=t-1|0;(t|0)>=(s|0);t=t-1|0){if((r[t>>0]|0)!=(e|0)){return t+1|0}}n=e|e<<8|e<<16|e<<24;s=s-1|0;while(1){while(1){if((s|0)<0){return 0}if((o[s>>2]|0)!=(n|0)){break}s=s-4|0}if((r[s>>0]|0)!=(e|0)){return s+1|0}if((r[s-1>>0]|0)!=(e|0)){return s|0}if((r[s-2>>0]|0)!=(e|0)){return s-1|0}if((r[s-3>>0]|0)!=(e|0)){return s-2|0}s=s-4|0}return 0}return{overwrite:s,underwrite:a,overwritePeriodically:u,findStartOf:h,findEnd:l,findStart:c}}function f(t){function e(){var t=1/0;o(x,function(e,n){n=0|n,t=Math.min(t,n/E[e])}),t=0|t,t>0&&o(x,function(e,n){n=0|n,x[e]=n-t*E[e]})}function n(t,e){t=Math.max(t,0),e=Math.min(e,f);for(var n=[],i=t;;){var r=d.findStartOf({from:i,to:e});if(r>=e)break;i=d.findEnd({from:r,to:e}),n.push({from:r,to:i})}return n.reverse(),function t(e){return{blocks:e,allocate:function(t){for(var n=t.length,i=t.activity;;){if(!e.length)return n;var r=e[e.length-1],o=r.to-r.from;if(o>n)return d.overwrite({from:r.from,to:r.from+=n,activity:i}),x[i]=(0|x[i])+n,0;d.overwrite({from:r.from,to:r.to,activity:i}),n-=o,x[i]=(0|x[i])+o,e.pop()}},clone:function(){return t(e.map(function(t){return{from:t.from,to:t.to}}))},wipe:function(){e.forEach(d.overwrite)}}}(n)}var h=t.dayLength,c=t.dayCount,p=t.activities;h=0|h,c=0|c,i(h>=0,"dayLength of ",h," is less than zero!"),i(c>=0,"dayCount of ",c," is less than zero!");for(var f=h*c,d=l(f),m=p.patterns||[p.pattern],v=m.length,g=Array(v),y=Array(v),b=function(t){var e=m[t];if(!e)return g[t]=void 0,"continue";e.requires&&e.requires.forEach(function(t){return t.forEach(function(t){return i(e.slots[t],"Can't require nonexistent slot \"",t,'"!')})}),e.excludes&&e.excludes.forEach(function(t){return t.forEach(function(t){return i(e.slots[t],"Can't exclude nonexistent slot \"",t,'"!')})}),g[t]={requires:u(e.requires),excludes:u(e.excludes)};var n=y[t]={},r={};o(e.slots,function(t,e){var i=e.activity,s=n[t]=[],a=r[i];void 0!==a&&(s.push(a),n[a.sister].push({sister:t,tweens:a.tweens})),r[i]={sister:t,tweens:[]},o(r,function(e,n){e!==i&&n.tweens.push(t)})})},w=0;w<v;++w){b(w)}var k=p.week;k&&(m=k.map(function(t){return m[t]}),g=k.map(function(t){return g[t]}),y=k.map(function(t){return y[t]}),v=Math.min(m.length,c));for(var x=r(p.timeSpentSoFar),E={},_=1,A=0;A<v;++A)o(m[A].slots,function(t,e){var n=e.activity;if(uo.call(x,n)){var r=x[n];i(r===(0|r),"Time spent so far of ",r," isn't an integer!")}else x[n]=0;if(!E[n])if(p.allotments){var o=p.allotments[n];i(o===(0|o),"Allotment of ",o," isn't an integer!"),i(o>0,"Allotment of ",o," isn't greater than zero!"),E[n]=o,o>_&&(_=o)}else E[n]=1});for(var C=function(t){var e=m[t%v];return e?void o(e.once,function(e,n){var i=a(e,":"),r=i.startS,o=i.endS,s=+r,u=+o;d.overwrite({from:Math.max(s,0)+t*h,to:Math.min(u,h)+t*h,activity:n}),x[n]=(0|x[n])+(u-s)}):"continue"},S=0;S<c;++S){C(S)}o(p.once,function(t,e){var n=a(t,":"),i=n.startS,r=n.endS,o=+i,s=+r;d.overwrite({from:o,to:s,activity:e}),x[e]=(0|x[e])+(s-o)});for(var O=function(t){var a=m[t%v];if(!a)return"continue";var u=g[t%v],l=u.requires,c=u.excludes,p=y[t%v],f=a.slots,d=a.nonoptional;e();var b={};o(E,function(t,e){b[t]=e*Math.pow(.85,x[t]*_/e)});for(var w=n(t*h,t*h+h),k=w.blocks.reduce(function(t,e){return t+e.to-e.from},0),A=function(){var t=[],e=[],n={};o(f,function(t,i){e.push(t),n[i.activity]=(0|n[i.activity])+1});var a=0,u=0,h=function t(i){var r=e.indexOf(i);if(r!==-1){s(e,r),n[i]-=1;var o=l[i];o&&o.forEach(t)}},m=function n(r,o){var p=e.indexOf(r);if(p!==-1||!o){i(p!==-1,'Slot "',r,'" was not pending!'),s(e,p),t.push(r);var d=f[r];u+=d.preferredTime,a+=d.minimumTime;var m=l[r],v=c[r];v&&v.forEach(h),m&&m.forEach(function(t){return n(t,!0)})}};d&&d.forEach(m),i(a<=k,"Non-optional slots add up to at least ",a,"; day length is only ",k,"!");for(var v=function(){var i={minimumTime:a,preferredTime:u,includedSlots:t.slice(),pendingSlots:e.slice(),numberOfSlotsForActivity:r(n)},s=0;o(b,function(t,n){n>s&&e.some(function(e){return f[e].activity===t})&&(s=n)});var l=void 0,c=0;do l=e[Math.random()*e.length|0];while(++c<=1e3&&(Math.random()>=b[f[l].activity]/s/n[f[l].activity]||p[l].some(function(e){var n=e.sister,i=e.tweens;return t.indexOf(n)!==-1&&i.every(function(e){return t.indexOf(e)===-1})})));m(l),a>k&&(a=i.minimumTime,u=i.preferredTime,t=i.includedSlots,e=i.pendingSlots,n=i.numberOfSlotsForActivity,h(l))};u<k&&e.length;)v();for(var g=w,y=[],x=t.map(function(t){return{slotName:t,slotObj:f[t],time:f[t].preferredTime}}),E=0;x.length;){var _=x.reduce(function(t,e){return t+e.time},0)+y.reduce(function(t,e){return t+e.time},0);if(_===k)break;for(var A=(k-_)/x.length,C=0;C<x.length;){var S=x[C],O=S.time+A+E,T=S.time=O+.5|0;E=O-T;var N=S.slotObj;T>N.maximumTime?(S.time=N.maximumTime,s(x,C),y.push(S)):T<N.minimumTime?(S.time=N.minimumTime,s(x,C),y.push(S)):++C}}y.push.apply(y,x);var F={};return y.forEach(function(t){var e=t.slotName,n=t.time;F[e]=n}),o(f,function(t,e){var n=F[t];n&&g.allocate({length:n,activity:e.activity})}),"break"};;){var C=A();if("break"===C)break}},T=0;T<c;++T){O(T)}return d}function d(){return fo.createDocumentFragment()}function m(t){var e;if(t&&"boolean"!=typeof t)return po&&fo&&t?t.nodeType?t:"string"==typeof t&&(e=fo.getElementById(t),!e&&fo.querySelector&&(e=fo.querySelector(t)),e&&e.nodeType)?e:t[0]&&t[0].nodeType?t[0]:null:null}function v(t){return t&&"unknown"!=typeof t.parentNode&&t.parentNode&&t.parentNode.removeChild(t),t}function g(t){return null!=t&&t.toString?""+t:""}function y(t){return g(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function b(t){return t.replace(Ko,function(t){return"-"+t.toLowerCase()})}function w(t){for(var e,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.forEach(function(n){for(e in n)qo.call(n,e)&&(t[e]=n[e])}),t}function k(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return n.forEach(function(e){for(var n in e)!qo.call(e,n)||n in t||(t[n]=e[n])}),t}function x(t){return"[object Array]"===zo.call(t)}function E(t,e){return null===t&&null===e||"object"!=typeof t&&"object"!=typeof e&&t===e}function _(t){return!isNaN(parseFloat(t))&&isFinite(t)}function A(t){return t&&"[object Object]"===zo.call(t)}function C(t,e){return t.replace(/%s/g,function(){return e.shift()})}function S(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];throw t=C(t,n),new Error(t)}function O(){Gr.DEBUG&&Ro.apply(null,arguments)}function T(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];t=C(t,n),Do(t,n)}function N(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];t=C(t,n),Wo[t]||(Wo[t]=!0,Do(t,n))}function F(){Gr.DEBUG&&T.apply(null,arguments)}function j(){Gr.DEBUG&&N.apply(null,arguments)}function P(t,e,n){var i=M(t,e,n);return i?i[t][n]:null}function M(t,e,n){for(;e;){if(n in e[t])return e;if(e.isolated)return null;e=e.parent}}function B(t,e,n,i){if(t===e)return null;if(i){var r=P("interpolators",n,i);if(r)return r(t,e)||null;S(Yo(i,"interpolator"))}return Jo.number(t,e)||Jo.array(t,e)||Jo.object(t,e)||null}function I(t){return function(){return t}}function L(t,e){var n=t.indexOf(e);n===-1&&t.push(e)}function V(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]==e)return!0;return!1}function K(t,e){var n;if(!x(t)||!x(e))return!1;if(t.length!==e.length)return!1;for(n=t.length;n--;)if(t[n]!==e[n])return!1;return!0}function R(t){return"string"==typeof t?[t]:void 0===t?[]:t}function D(t){return t[t.length-1]}function U(t,e){if(t){var n=t.indexOf(e);n!==-1&&t.splice(n,1)}}function q(t){for(var e=[],n=t.length;n--;)e[n]=t[n];return e}function z(t){setTimeout(t,0)}function H(t,e){return function(){for(var n;n=t.shift();)n(e)}}function W(t,e,n,i){var r;if(e===t)throw new TypeError("A promise's fulfillment handler cannot return the same promise");if(e instanceof Qo)e.then(n,i);else if(!e||"object"!=typeof e&&"function"!=typeof e)n(e);else{try{r=e.then}catch(t){return void i(t)}if("function"==typeof r){var o,s,a;s=function(e){o||(o=!0,W(t,e,n,i))},a=function(t){o||(o=!0,i(t))};try{r.call(e,s,a)}catch(t){if(!o)return i(t),void(o=!0)}}else n(e)}}function Q(t){t.detach()}function $(t){t.detachNodes()}function G(t){!t.ready||t.outros.length||t.outroChildren||(t.outrosComplete||(t.outrosComplete=!0,t.parent&&!t.parent.outrosComplete?t.parent.decrementOutros(t):t.detachNodes()),t.intros.length||t.totalChildren||("function"==typeof t.callback&&t.callback(),t.parent&&!t.notifiedTotal&&(t.notifiedTotal=!0,t.parent.decrementTotal())))}function Y(t){var e=t.detachQueue,n=J(t),i=e.length,r=0,o=void 0,s=void 0;t:for(;i--;){for(o=e[i].node,r=n.length;r--;)if(s=n[r].element.node,s===o||s.contains(o)||o.contains(s))continue t;e[i].detach(),e.splice(i,1)}}function J(t,e){if(e){for(var n=t.children.length;n--;)e=J(t.children[n],e);return e=e.concat(t.outros)}e=[];for(var i=t;i.parent;)i=i.parent;return J(i,e)}function Z(t){t.dispatch()}function X(){var t=ss.immediateObservers;ss.immediateObservers=[],t.forEach(Z);var e=ss.fragments.length,n=void 0;t=ss.fragments,ss.fragments=[];var i=ss.ractives;for(ss.ractives=[];e--;){n=t[e];var r=n.ractive;Object.keys(r.viewmodel.changes).length&&os.fire(r,r.viewmodel.changes),r.viewmodel.changes={},U(i,r),n.update()}for(e=i.length;e--;){var o=i[e];os.fire(o,o.viewmodel.changes),o.viewmodel.changes={}}ss.transitionManager.ready(),t=ss.deferredObservers,ss.deferredObservers=[],t.forEach(Z);var s=ss.tasks;for(ss.tasks=[],e=0;e<s.length;e+=1)s[e]();if(ss.fragments.length||ss.immediateObservers.length||ss.deferredObservers.length||ss.ractives.length||ss.tasks.length)return X()}function tt(t){return"string"==typeof t?t.replace(ls,"\\$&"):t}function et(t){return t?t.replace(us,".$1"):""}function nt(t){var e=[],n=void 0;for(t=et(t);n=hs.exec(t);){var i=n.index+n[1].length;e.push(t.substr(0,i)),t=t.substr(i+1)}return e.push(t),e}function it(t){return"string"==typeof t?t.replace(cs,"$1$2"):t}function rt(t,e){if(!/this/.test(t.toString()))return t;var n=t.bind(e);for(var i in t)n[i]=t[i];return n}function ot(t,e){for(var n=as.start(t,!0),i=e.length;i--;){var r=e[i],o=r[0],s=r[1];"function"==typeof s&&(s=rt(s,t)),o.set(s)}return as.end(),n}function st(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.viewmodel;return ps.test(e)?n.findMatches(nt(e)):[n.joinAll(nt(e))]}function at(t,e,n){var i=[];if(A(e)){var r=function(n){e.hasOwnProperty(n)&&i.push.apply(i,st(t,n).map(function(t){return[t,e[n]]}))};for(var o in e)r(o)}else i.push.apply(i,st(t,e).map(function(t){return[t,n]}));return i}function ut(t,e,n){if("string"!=typeof e||!_(n))throw new Error("Bad arguments");var i=at(t,e,n);return ot(t,i.map(function(t){var e=t[0],n=t[1],i=e.get();if(!_(n)||!_(i))throw new Error(fs);return[e,i+n]}))}function ht(t,e){return ut(this,t,void 0===e?1:+e)}function lt(t,e){t=t||{};var n=void 0;return t.easing&&(n="function"==typeof t.easing?t.easing:e.easing[t.easing]),{easing:n||ms,duration:"duration"in t?t.duration:400,complete:t.complete||Ho,step:t.step||Ho}}function ct(t,e,n,i){i=lt(i,t);var r=e.get();if(E(r,n))return i.complete(i.to),ds;var o=B(r,n,t,i.interpolator);return o?e.animate(r,n,i,o):(as.start(),e.set(n),as.end(),ds)}function pt(t,e,n){if("object"==typeof t){var i=Object.keys(t);throw new Error("ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  "+i.map(function(e){return"'"+e+"': "+t[e]}).join("\n  ")+"\n}, {...}), do\n\n"+i.map(function(e){return"ractive.animate('"+e+"', "+t[e]+", {...});"}).join("\n")+"\n")}return ct(this,this.viewmodel.joinAll(nt(t)),e,n)}function ft(){return this.isDetached?this.el:(this.el&&U(this.el.__ractive_instances__,this),this.el=this.fragment.detach(),this.isDetached=!0,vs.fire(this),this.el)}function dt(t){if(!this.el)throw new Error("Cannot call ractive.find('"+t+"') unless instance is rendered to the DOM");return this.fragment.find(t)}function mt(t,e){if(t.compareDocumentPosition){var n=t.compareDocumentPosition(e);return 2&n?1:-1}return vt(t,e)}function vt(t,e){for(var n=yt(t.component||t._ractive.proxy),i=yt(e.component||e._ractive.proxy),r=D(n),o=D(i),s=void 0;r&&r===o;)n.pop(),i.pop(),s=r,r=D(n),o=D(i);r=r.component||r,o=o.component||o;var a=r.parentFragment,u=o.parentFragment;if(a===u){var h=a.items.indexOf(r),l=u.items.indexOf(o);return h-l||n.length-i.length}var c=s.iterations;if(c){var p=c.indexOf(a),f=c.indexOf(u);return p-f||n.length-i.length}throw new Error("An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/ractivejs/ractive/issues - thanks!")}function gt(t){var e=t.parentFragment;return e?e.owner:t.component&&(e=t.component.parentFragment)?e.owner:void 0}function yt(t){for(var e=[t],n=gt(t);n;)e.push(n),n=gt(n);return e}function bt(t,e){if(!this.el)throw new Error("Cannot call ractive.findAll('"+t+"', ...) unless instance is rendered to the DOM");e=e||{};var n=this._liveQueries,i=n[t];return i?e&&e.live?i:i.slice():(i=new gs(this,t,(!!e.live),(!1)),i.live&&(n.push(t),n["_"+t]=i),this.fragment.findAll(t,i),i.init(),i.result)}function wt(t,e){e=e||{};var n=this._liveComponentQueries,i=n[t];return i?e&&e.live?i:i.slice():(i=new gs(this,t,(!!e.live),(!0)),i.live&&(n.push(t),n["_"+t]=i),this.fragment.findAllComponents(t,i),i.init(),i.result)}function kt(t){return this.fragment.findComponent(t)}function xt(t){return this.container?this.container.component&&this.container.component.name===t?this.container:this.container.findContainer(t):null}function Et(t){return this.parent?this.parent.component&&this.parent.component.name===t?this.parent:this.parent.findParent(t):null}function _t(t,e){t.event&&t._eventQueue.push(t.event),t.event=e}function At(t){t._eventQueue.length?t.event=t._eventQueue.pop():t.event=null}function Ct(t){var e,n,i,r,o,s;for(e=nt(t),(n=ys[e.length])||(n=St(e.length)),o=[],i=function(t,n){return t?"*":e[n]},r=n.length;r--;)s=n[r].map(i).join("."),o.hasOwnProperty(s)||(o.push(s),o[s]=!0);return o}function St(t){var e,n,i,r,o,s,a,u,h="";if(!ys[t]){for(i=[];h.length<t;)h+=1;for(e=parseInt(h,2),r=function(t){return"1"===t},o=0;o<=e;o+=1){for(n=o.toString(2);n.length<t;)n="0"+n;for(u=[],a=n.length,s=0;s<a;s++)u.push(r(n[s]));i[o]=u}ys[t]=i}return ys[t]}function Ot(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e){n.event?n.event.name=e:n.event={name:e,_noArg:!0};var i=Tt(e);return Nt(t,i,n.event,n.args,!0)}}function Tt(t){return bs.hasOwnProperty(t)?bs[t]:bs[t]=Ct(t)}function Nt(t,e,n,i){var r,o,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!0;for(_t(t,n),o=e.length;o>=0;o--)r=t._subs[e[o]],r&&(a=Ft(t,r,n,i)&&a);if(At(t),t.parent&&a){if(s&&t.component){var u=t.component.name+"."+e[e.length-1];e=Tt(u),n&&!n.component&&(n.component=t)}Nt(t.parent,e,n,i)}return a}function Ft(t,e,n,i){var r=null,o=!1;n&&!n._noArg&&(i=[n].concat(i)),e=e.slice();for(var s=0,a=e.length;s<a;s+=1)e[s].off||e[s].apply(t,i)!==!1||(o=!0);return n&&!n._noArg&&o&&(r=n.original)&&(r.preventDefault&&r.preventDefault(),r.stopPropagation&&r.stopPropagation()),!o}function jt(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Ot(this,t,{args:n})}function Pt(t){throw new Error("An index or key reference ("+t+") cannot have child properties")}function Mt(t,e){for(var n=t.findContext().root,i=nt(e),r=i[0],o=void 0,s=void 0,a=void 0;t;){if(t.isIteration){if(r===t.parent.keyRef)return i.length>1&&Pt(r),t.context.getKeyModel(t.key);if(r===t.parent.indexRef)return i.length>1&&Pt(r),t.context.getKeyModel(t.index)}if(((a=t.owner.aliases)||(a=t.aliases))&&a.hasOwnProperty(r)){var u=a[r];if(1===i.length)return u;if("function"==typeof u.joinAll)return u.joinAll(i.slice(1))}if(t.context&&(t.isRoot&&!t.ractive.component||(o=!0),t.context.has(r)))return s?n.createLink(r,t.context.joinKey(i.shift()),r).joinAll(i):t.context.joinAll(i);t.componentParent&&!t.ractive.isolated?(t=t.componentParent,s=!0):t=t.parent}if(!o)return n.joinAll(i)}function Bt(){ws.push(ks=[])}function It(){var t=ws.pop();return ks=ws[ws.length-1],t}function Lt(t){ks&&ks.push(t)}function Vt(t){t.bind()}function Kt(t){t.cancel()}function Rt(t){t.handleChange()}function Dt(t){t.mark()}function Ut(t){t.marked()}function qt(t){t.notifiedUpstream()}function zt(t){t.render()}function Ht(t){t.teardown()}function Wt(t){t.unbind()}function Qt(t){t.unrender()}function $t(t){t.unrender(!0)}function Gt(t){t.update()}function Yt(t){return t.toString()}function Jt(t){return t.toString(!0)}function Zt(t){t.updateFromBindings(!0)}function Xt(t){for(var e=t.length;e--;)if(t[e].bound){var n=t[e].owner;if(n){var i="checked"===n.name?n.node.checked:n.node.value;return{value:i}}}}function te(t){if(t){var e=As[t];As[t]=[];for(var n=e.length;n--;)e[n]();var i=Cs[t];for(Cs[t]=[],n=i.length;n--;)i[n].model.register(i[n].item)}else te("early"),te("mark")}function ee(t,e,n){var i=t.r||t;if(!i||"string"!=typeof i)return e;if("."===i||"@"===i[0]||(e||n).isKey||(e||n).isKeypath)return e;for(var r=i.split("/"),o=nt(r[r.length-1]),s=e||n,a=o.length,u=!0,h=!1;s&&a--;)s.shuffling&&(h=!0),o[a]!=s.key&&(u=!1),s=s.parent;return!e&&u&&h?n:e&&!u&&h?n:e}function ne(){as.start();var t=Fs(),e=void 0,n=void 0;for(e=0;e<js.length;e+=1)n=js[e],n.tick(t)||js.splice(e--,1);as.end(),js.length?Ns(ne):Ps=!1}function ie(t,e){var n,i={};if(!e)return t;e+=".";for(n in t)t.hasOwnProperty(n)&&(i[e+n]=t[n]);return i}function re(t){var e;return Bs[t]||(e=t?t+".":"",Bs[t]=function(n,i){var r;return"string"==typeof n?(r={},r[e+n]=i,r):"object"==typeof n?e?ie(n,t):n:void 0}),Bs[t]}function oe(t){for(var e=[],n=0;n<t.length;n++)e[n]=(t.childByKey[n]||{}).value;return e}function se(t,e){var n=t.findContext();if("."===e||"this"===e)return n;if(0===e.indexOf("@keypath")){var i=Ks.exec(e);if(i&&i[1]){var r=se(t,i[1]);if(r)return r.getKeypathModel()}return n.getKeypathModel()}if(0===e.indexOf("@rootpath")){for(;n.isRoot&&n.ractive.component;)n=n.ractive.component.parentFragment.findContext();var o=Ks.exec(e);if(o&&o[1]){var s=se(t,o[1]);if(s)return s.getKeypathModel(t.ractive.root)}return n.getKeypathModel(t.ractive.root)}if("@index"===e||"@key"===e){var a=t.findRepeatingFragment();if(!a.isIteration)return;return a.context.getKeyModel(a["i"===e[1]?"index":"key"])}if("@this"===e)return t.ractive.viewmodel.getRactiveModel();if("@global"===e)return Vs;if("~"===e[0])return t.ractive.viewmodel.joinAll(nt(e.slice(2)));if("."===e[0]){for(var u=e.split("/");"."===u[0]||".."===u[0];){var h=u.shift();".."===h&&(n=n.parent)}return e=u.join("/"),"."===e[0]&&(e=e.slice(1)),n.joinAll(nt(e))}return Mt(t,e)}function ae(t,e){if("string"!=typeof t)return this.viewmodel.get(!0,t);var n=nt(t),i=n[0],r=void 0;return this.viewmodel.has(i)||this.component&&!this.isolated&&(r=se(this.component.parentFragment,i),r&&this.viewmodel.map(i,r)),r=this.viewmodel.joinAll(n),r.get(!0,e)}function ue(t){for(var e={},n={};t;){if(t.parent&&(t.parent.indexRef||t.parent.keyRef)){var i=t.parent.indexRef;!i||i in n||(n[i]=t.index),i=t.parent.keyRef,!i||i in e||(e[i]=t.key)}t=t.componentParent&&!t.ractive.isolated?t.componentParent:t.parent}return{key:e,index:n}}function he(t,e,n){var i,r,o,s,a,u=[];if(i=le(t,e,n),!i)return null;for(s=i.length-2-i[1],r=Math.min(t,i[0]),o=r+i[1],u.startIndex=r,a=0;a<r;a+=1)u.push(a);for(;a<o;a+=1)u.push(-1);for(;a<t;a+=1)u.push(a+s);return 0!==s?u.touchedFrom=i[0]:u.touchedFrom=t,u}function le(t,e,n){switch(e){case"splice":for(void 0!==n[0]&&n[0]<0&&(n[0]=t+Math.max(n[0],-t)),void 0===n[0]&&(n[0]=0);n.length<2;)n.push(t-n[0]);return"number"!=typeof n[1]&&(n[1]=t-n[0]),n[1]=Math.min(n[1],t-n[0]),n;case"sort":case"reverse":return null;case"pop":return t?[t-1,1]:[0,0];case"push":return[t,0].concat(n);case"shift":return[0,t?1:0];case"unshift":return[0,0].concat(n)}}function ce(t){if(!t)return null;if(t===!0)return JSON.stringify;if("function"==typeof t)return t;if("string"==typeof t)return Us[t]||(Us[t]=function(e){return e[t]});throw new Error("If supplied, options.compare must be a string, function, or `true`")}function pe(t,e,n,i){var r=as.start(t,!0),o=e.get();if(!x(o)||!x(n))throw new Error("You cannot merge an array with a non-array");var s=ce(i&&i.compare);return e.merge(n,s),as.end(),r}function fe(t,e,n){return pe(this,this.viewmodel.joinAll(nt(t)),e,n)}function de(t,e){e.parent&&e.parent.wrapper&&e.parent.adapt();var n=as.start(t,!0);if(e.mark(),e.registerChange(e.getKeypath(),e.get()),!e.isRoot)for(var i=e.parent,r=e.key;i&&!i.isRoot;)i.clearUnresolveds&&i.clearUnresolveds(r),r=i.key,i=i.parent;return e.notifyUpstream(),as.end(),qs.fire(t,e),n}function me(t){return t&&(t=nt(t)),de(this,t?this.viewmodel.joinAll(t):this.viewmodel)}function ve(t,e,n){var i=[];if(A(e))for(var r in e)e.hasOwnProperty(r)&&i.push([be(t,r).model,e[r]]);else i.push([be(t,e).model,n]);return i}function ge(t){if(!t)return this._element.parentFragment.findContext().get(!0);var e=se(this._element.parentFragment,t);return e?e.get(!0):void 0}function ye(t,e){var n=be(this,t),i=n.model,r=n.instance;return i?i.getKeypath(e||r):t}function be(t,e){var n=t._element.parentFragment;return"string"!=typeof e?{model:n.findContext(),instance:e}:{model:se(n,e),instance:n.ractive}}function we(t,e){if(void 0===e&&(e=1),!_(e))throw new Error("Bad arguments");return ot(this.ractive,ve(this,t,e).map(function(t){var e=t[0],n=t[1],i=e.get();if(!_(n)||!_(i))throw new Error("Cannot add non-numeric value");return[e,i+n]}))}function ke(t,e,n){var i=be(this,t).model;return ct(this.ractive,i,e,n)}function xe(t,e){var n=be(this,t).model,i=be(this,e).model,r=as.start(this.ractive,!0);return i.link(n,t),as.end(),r}function Ee(t,e,n){return pe(this.ractive,be(this,t).model,e,n)}function _e(t){return Hs(be(this,t).model,[])}function Ae(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return zs(be(this,t).model,n)}function Ce(t){return Ys(be(this,t).model,[])}function Se(t,e){return ot(this.ractive,ve(this,t,e))}function Oe(t){return Ws(be(this,t).model,[])}function Te(t,e,n){for(var i=arguments.length,r=Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];return r.unshift(e,n),Gs(be(this,t).model,r)}function Ne(t){return $s(be(this,t).model,[])}function Fe(t,e){if(void 0===e&&(e=1),!_(e))throw new Error("Bad arguments");return ot(this.ractive,ve(this,t,e).map(function(t){var e=t[0],n=t[1],i=e.get();if(!_(n)||!_(i))throw new Error("Cannot add non-numeric value");return[e,i-n]}))}function je(t){var e=be(this,t),n=e.model;return ot(this.ractive,[[n,!n.get()]])}function Pe(t){var e=be(this,t).model,n=as.start(this.ractive,!0);return e.owner&&e.owner._link&&e.owner.unlink(),as.end(),n}function Me(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Qs(be(this,t).model,n)}function Be(t){return de(this.ractive,be(this,t).model)}function Ie(t,e){var n=be(this,t),i=n.model,r=as.start(this.ractive,!0);return i.updateFromBindings(e),as.end(),r}function Le(){var t=Re(this),e=t.model;return!!e}function Ve(t){var e=Re(this),n=e.model,i=e.instance;if(n)return n.getKeypath(t||i)}function Ke(){var t=Re(this),e=t.model;if(e)return e.get(!0)}function Re(t){var e=t._element;return{model:e.binding&&e.binding.model,instance:e.parentFragment.ractive}}function De(t){var e=Re(this),n=e.model;return ot(this.ractive,[[n,t]])}function Ue(){return j("Object property keypath is deprecated, please use resolve() instead."),this.resolve()}function qe(){return j("Object property rootpath is deprecated, please use resolve( ractive.root ) instead."),this.resolve(this.ractive.root)}function ze(){return j("Object property context is deprecated, please use get() instead."),this.get()}function He(){return j('Object property index is deprecated, you can use get( "indexName" ) instead.'),ue(this._element.parentFragment).index}function We(){return j('Object property key is deprecated, you can use get( "keyName" ) instead.'),ue(this._element.parentFragment).key}function Qe(t,e){return Vo(t,{_element:{value:e},ractive:{value:e.parentFragment.ractive},resolve:{value:ye},get:{value:ge},add:{value:we},animate:{value:ke},link:{value:xe},merge:{value:Ee},pop:{value:_e},push:{value:Ae},reverse:{value:Ce},set:{value:Se},shift:{value:Oe},sort:{value:Ne},splice:{value:Te},subtract:{value:Fe},toggle:{value:je},unlink:{value:Pe},unshift:{value:Me},update:{value:Be},updateModel:{value:Ie},isBound:{value:Le},getBindingPath:{value:Ve},getBinding:{value:Ke},setBinding:{value:De},keypath:{get:Ue},rootpath:{get:qe},context:{get:ze},index:{get:He},key:{get:We}}),t}function $e(t){return"string"==typeof t&&(t=this.find(t)),Zs(t)}function Ge(t,e){if(!this.fragment.rendered)throw new Error("The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.");if(t=m(t),e=m(e)||null,!t)throw new Error("You must specify a valid target to insert into");t.insertBefore(this.detach(),e),this.el=t,(t.__ractive_instances__||(t.__ractive_instances__=[])).push(this),this.isDetached=!1,Ye(this)}function Ye(t){Xs.fire(t),t.findAllComponents("*").forEach(function(t){Ye(t.instance)})}function Je(t,e){if(e===t||0===(t+".").indexOf(e+".")||0===(e+".").indexOf(t+"."))throw new Error("A keypath cannot be linked to itself.");var n=as.start(),i=void 0,r=nt(t);return!this.viewmodel.has(r[0])&&this.component&&(i=se(this.component.parentFragment,r[0]),i=i.joinAll(r.slice(1))),this.viewmodel.joinAll(nt(e)).link(i||this.viewmodel.joinAll(r),t),as.end(),n}function Ze(t,e,n){var i=this,r=[],o=void 0;if(A(t))o=t,n=e||{},Object.keys(o).forEach(function(t){var e=o[t],s=t.split(" ");s.length>1&&(s=s.filter(function(t){return t})),s.forEach(function(t){r.push(Xe(i,t,e,n))})});else{var s=void 0;"function"==typeof t?(n=e,e=t,s=[""]):s=t.split(" "),s.length>1&&(s=s.filter(function(t){return t})),s.forEach(function(t){r.push(Xe(i,t,e,n||{}))})}return this._observers.push.apply(this._observers,r),{cancel:function(){r.forEach(function(t){U(i._observers,t),t.cancel()})}}}function Xe(t,e,n,i){var r=t.viewmodel,o=nt(e),s=o.indexOf("*");if(i.keypath=e,!~s){var a=o[0],u=void 0;return""===a||r.has(a)?u=r.joinAll(o):t.component&&!t.isolated&&(u=se(t.component.parentFragment,a),u&&(r.map(a,u),u=r.joinAll(o))),new ea(t,u,n,i)}var h=0===s?r:r.joinAll(o.slice(0,s));
return new na(t,h,o.splice(s),n,i)}function tn(t,e,n){if("string"!=typeof t)throw new Error("ractive.observeList() must be passed a string as its first argument");var i=this.viewmodel.joinAll(nt(t)),r=new ia(this,i,e,n||{});return this._observers.push(r),{cancel:function(){r.cancel()}}}function en(){return-1}function nn(t,e,n){return A(t)||"function"==typeof t?(n=w(e||{},ra),this.observe(t,n)):(n=w(n||{},ra),this.observe(t,e,n))}function rn(t,e){var n=this;if(t){var i=t.split(" ").map(oa).filter(sa);i.forEach(function(t){var i=n._subs[t];if(i)if(e){e.off=!0;var r=i.indexOf(e);r!==-1&&i.splice(r,1)}else n._subs[t]=[]})}else for(t in this._subs)delete this._subs[t];return this}function on(t,e){var n=this;if("object"==typeof t){var i=function(){var e=[],i=void 0;for(i in t)t.hasOwnProperty(i)&&e.push(n.on(i,t[i]));return{v:{cancel:function(){for(var t=void 0;t=e.pop();)t.cancel()}}}}();if("object"==typeof i)return i.v}var r=t.split(" ").map(oa).filter(sa);return r.forEach(function(t){(n._subs[t]||(n._subs[t]=[])).push(e)}),{cancel:function(){return n.off(t,e)}}}function sn(t,e){var n=this.on(t,function(){e.apply(this,arguments),n.cancel()});return n}function an(t){la.push(t),ca=!0}function un(){fo&&ca&&(fa?pa.styleSheet.cssText=hn(null):pa.innerHTML=hn(null),ca=!1)}function hn(t){var e=t?la.filter(function(e){return~t.indexOf(e.id)}):la;return e.reduce(function(t,e){return t+"\n\n/* {"+e.id+"} */\n"+e.styles},ha)}function ln(t,e,n,i){var r=t.transitionsEnabled;t.noIntro&&(t.transitionsEnabled=!1);var o=as.start(t,!0);if(as.scheduleTask(function(){return da.fire(t)},!0),t.fragment.rendered)throw new Error("You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first");if(n=m(n)||t.anchor,t.el=e,t.anchor=n,t.cssId&&un(),e)if((e.__ractive_instances__||(e.__ractive_instances__=[])).push(t),n){var s=fo.createDocumentFragment();t.fragment.render(s),e.insertBefore(s,n)}else t.fragment.render(e,i);return as.end(),t.transitionsEnabled=r,o.then(function(){return ma.fire(t)})}function cn(t,e){if(this.torndown)return F("ractive.render() was called on a Ractive instance that was already torn down"),Promise.resolve();if(t=m(t)||this.el,!this.append&&t){var n=t.__ractive_instances__;n&&n.forEach(Ht),this.enhance||(t.innerHTML="")}var i=this.enhance?q(t.childNodes):null,r=ln(this,t,e,i);if(i)for(;i.length;)t.removeChild(i.pop());return r}function pn(t,e){for(var n=t.slice(),i=e.length;i--;)~n.indexOf(e[i])||n.push(e[i]);return n}function fn(t){return t.trim()}function dn(t){return t.str}function mn(t,e){for(var n=[],i=void 0;i=ba.exec(t);)n.push({str:i[0],base:i[1],modifiers:i[2]});for(var r=n.map(dn),o=[],s=n.length;s--;){var a=r.slice(),u=n[s];a[s]=u.base+e+u.modifiers||"";var h=r.slice();h[s]=e+" "+h[s],o.push(a.join(" "),h.join(" "))}return o.join(", ")}function vn(t,e){var n='[data-ractive-css~="{'+e+'}"]',i=void 0;return i=ka.test(t)?t.replace(ka,n):t.replace(ya,"").replace(ga,function(t,e){if(wa.test(e))return t;var i=e.split(",").map(fn),r=i.map(function(t){return mn(t,n)}).join(", ")+" ";return t.replace(e,r)})}function gn(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function yn(){return gn()+gn()+"-"+gn()+"-"+gn()+"-"+gn()+"-"+gn()+gn()+gn()}function bn(t){t&&t.constructor!==Object&&("function"==typeof t||("object"!=typeof t?S("data option must be an object or a function, `"+t+"` is not valid"):F("If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged")))}function wn(t,e){bn(e);var n="function"==typeof t,i="function"==typeof e;return e||n||(e={}),n||i?function(){var r=i?kn(e,this):e,o=n?kn(t,this):t;return xn(r,o)}:xn(e,t)}function kn(t,e){var n=t.call(e);if(n)return"object"!=typeof n&&S("Data function must return an object"),n.constructor!==Object&&j("Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged"),n}function xn(t,e){if(t&&e){for(var n in e)n in t||(t[n]=e[n]);return t}return t||e}function En(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new Array(e);e--;)n[e]="_"+e;return new Function([],"return function ("+n.join(",")+"){return("+t+");};")()}function _n(t,e){var n=void 0,i="return ("+t.replace(Aa,function(t,e){return n=!0,'__ractive.get("'+e+'")'})+");";n&&(i="var __ractive = this; "+i);var r=new Function(i);return n?r.bind(e):r}function An(t,e){return Ca[t]?Ca[t]:Ca[t]=On(t,e)}function Cn(t){if(t){var e=t.e;e&&Object.keys(e).forEach(function(t){Ca[t]||(Ca[t]=e[t])})}}function Sn(t,e,n){t||S("Missing Ractive.parse - cannot parse "+e+". "+n)}function On(t,e){return Sn(En,"new expression function",Ta),En(t,e)}function Tn(t,e){return Sn(_n,'compution string "${str}"',Na),_n(t,e)}function Nn(t){var e=t._config.template;if(e&&e.fn){var n=Fn(t,e.fn);return n!==e.result?(e.result=n,n):void 0}}function Fn(t,e){return e.call(t,{fromId:Fa.fromId,isParsed:Fa.isParsed,parse:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fa.getParseOptions(t);return Fa.parse(e,n)}})}function jn(t,e){return"string"==typeof t?t=Pn(t,e):(Mn(t),Cn(t)),t}function Pn(t,e){return"#"===t[0]&&(t=Fa.fromId(t)),Fa.parseFor(t,e)}function Mn(t){if(void 0==t)throw new Error("The template cannot be "+t+".");if("number"!=typeof t.v)throw new Error("The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.");if(t.v!==_a)throw new Error("Mismatched template version (expected "+_a+", got "+t.v+") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app")}function Bn(t,e,n){if(e)for(var i in e)!n&&t.hasOwnProperty(i)||(t[i]=e[i])}function In(t,e,n){function i(){var t=Ln(i._parent,e),r="_super"in this,o=this._super;this._super=t;var s=n.apply(this,arguments);return r?this._super=o:delete this._super,s}return/_super/.test(n)?(i._parent=t,i._method=n,i):n}function Ln(t,e){if(e in t){var n=function(){var n=t[e];return{v:"function"==typeof n?n:function(){return n}}}();if("object"==typeof n)return n.v}return Ho}function Vn(t,e,n){return"options."+t+" has been deprecated in favour of options."+e+"."+(n?" You cannot specify both options, please use options."+e+".":"")}function Kn(t,e,n){if(e in t){if(n in t)throw new Error(Vn(e,n,!0));F(Vn(e,n)),t[n]=t[e]}}function Rn(t){Kn(t,"beforeInit","onconstruct"),Kn(t,"init","onrender"),Kn(t,"complete","oncomplete"),Kn(t,"eventDefinitions","events"),x(t.adaptors)&&Kn(t,"adaptors","adapt")}function Dn(t,e,n,i){Rn(i);for(var r in i)if(Va.hasOwnProperty(r)){var o=i[r];"el"!==r&&"function"==typeof o?F(r+" is a Ractive option that does not expect a function and will be ignored","init"===t?n:null):n[r]=o}if(i.append&&i.enhance)throw new Error("Cannot use append and enhance at the same time");Ba.forEach(function(r){r[t](e,n,i)}),va[t](e,n,i),ja[t](e,n,i),xa[t](e,n,i),Un(e.prototype,n,i)}function Un(t,e,n){for(var i in n)if(!Ka[i]&&n.hasOwnProperty(i)){var r=n[i];"function"==typeof r&&(r=In(t,i,r)),e[i]=r}}function qn(t){var e={};return t.forEach(function(t){return e[t]=!0}),e}function zn(t){if(t=t||{},"object"!=typeof t)throw new Error("The reset method takes either no arguments, or an object containing new data");t=Ea.init(this.constructor,this,{data:t});var e=as.start(this,!0),n=this.viewmodel.wrapper;n&&n.reset?n.reset(t)===!1&&this.viewmodel.set(t):this.viewmodel.set(t);for(var i=Da.reset(this),r=void 0,o=i.length;o--;)if(Ua.indexOf(i[o])>-1){r=!0;break}return r&&(Wa.fire(this),this.fragment.resetTemplate(this.template),Ha.fire(this),qa.fire(this)),as.end(),za.fire(this,t),e}function Hn(t,e,n,i){t.forEach(function(t){if(t.type===Za&&(t.refName===e||t.name===e))return t.inAttribute=n,void i.push(t);if(t.fragment)Hn(t.fragment.iterations||t.fragment.items,e,n,i);else if(x(t.items))Hn(t.items,e,n,i);else if(t.type===tu&&t.instance){if(t.instance.partials[e])return;Hn(t.instance.fragment.items,e,n,i)}t.type===Ja&&x(t.attributes)&&Hn(t.attributes,e,!0,i)})}function Wn(t){t.forceResetTemplate()}function Qn(t,e,n){var i=t.fragment.resolve(e,function(e){U(t.resolvers,i),t.models[n]=e,t.bubble()});t.resolvers.push(i)}function $n(t,e){return e.r?se(t,e.r):e.x?new bu(t,e.x):e.rx?new ku(t,e.rx):void 0}function Gn(t){if(t.template.z){t.aliases={};for(var e=t.template.z,n=0;n<e.length;n++)t.aliases[e[n].n]=$n(t.parentFragment,e[n].x)}}function Yn(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments[2];t&&(t.type!==Ja||n&&t.name!==n)&&(!e||t.type!==tu);)t=t.owner?t.owner:t.component?t.containerFragment||t.component.parentFragment:t.parent?t.parent:t.parentFragment?t.parentFragment:void 0;return t}function Jn(t){var e=[];return"string"!=typeof t?{}:t.replace(Au,function(t){return"\0"+(e.push(t)-1)}).replace(_u,"").split(";").filter(function(t){return!!t.trim()}).map(function(t){return t.replace(Cu,function(t,n){return e[n]})}).reduce(function(t,e){var n=e.indexOf(":"),i=e.substr(0,n).trim();return t[i]=e.substr(n+1).trim(),t},{})}function Zn(t){for(var e=t.split(Eu),n=e.length;n--;)e[n]||e.splice(n,1);return e}function Xn(t){var e=t.element,n=t.name;if("id"===n)return ti;if("value"===n){if(t.interpolator&&(t.interpolator.bound=!0),"select"===e.name&&"value"===n)return e.getAttribute("multiple")?ei:ni;if("textarea"===e.name)return si;if(null!=e.getAttribute("contenteditable"))return ii;if("input"===e.name){var i=e.getAttribute("type");if("file"===i)return Ho;if("radio"===i&&e.binding&&"name"===e.binding.attribute.name)return ri;if(~Su.indexOf(i))return si}return oi}var r=e.node;if(t.isTwoway&&"name"===n){if("radio"===r.type)return ai;if("checkbox"===r.type)return ui}if("style"===n)return hi;if(0===n.indexOf("style-"))return li;if("class"===n&&(!r.namespaceURI||r.namespaceURI===To))return ci;if(0===n.indexOf("class-"))return pi;if(t.isBoolean){var o=e.getAttribute("type");return!t.interpolator||"checked"!==n||"checkbox"!==o&&"radio"!==o||(t.interpolator.bound=!0),fi}return t.namespace&&t.namespace!==t.node.namespaceURI?mi:di}function ti(t){var e=this.node,n=this.getValue();return this.ractive.nodes[e.id]===e&&delete this.ractive.nodes[e.id],t?e.removeAttribute("id"):(this.ractive.nodes[n]=e,void(e.id=n))}function ei(t){var e=this.getValue();x(e)||(e=[e]);var n=this.node.options,i=n.length;if(t)for(;i--;)n[i].selected=!1;else for(;i--;){var r=n[i],o=r._ractive?r._ractive.value:r.value;r.selected=V(e,o)}}function ni(t){var e=this.getValue();if(!this.locked){this.node._ractive.value=e;var n=this.node.options,i=n.length,r=!1;if(t)for(;i--;)n[i].selected=!1;else for(;i--;){var o=n[i],s=o._ractive?o._ractive.value:o.value;if(o.disabled&&o.selected&&(r=!0),s==e)return void(o.selected=!0)}r||(this.node.selectedIndex=-1)}}function ii(t){var e=this.getValue();this.locked||(t?this.node.innerHTML="":this.node.innerHTML=void 0===e?"":e)}function ri(t){var e=this.node,n=e.checked,i=this.getValue();return t?e.checked=!1:(e.value=this.node._ractive.value=i,e.checked=i===this.element.getAttribute("name"),void(n&&!e.checked&&this.element.binding&&this.element.binding.rendered&&this.element.binding.group.model.set(this.element.binding.group.getValue())))}function oi(t){if(!this.locked){if(t)return this.node.removeAttribute("value"),void(this.node.value=this.node._ractive.value=null);var e=this.getValue();this.node.value=this.node._ractive.value=e,this.node.setAttribute("value",e)}}function si(t){if(!this.locked){if(t)return this.node._ractive.value="",void this.node.removeAttribute("value");var e=this.getValue();this.node._ractive.value=e,this.node.value=g(e),this.node.setAttribute("value",g(e))}}function ai(t){t?this.node.checked=!1:this.node.checked=this.getValue()==this.node._ractive.value}function ui(t){var e=this.element,n=this.node,i=e.binding,r=this.getValue(),o=e.getAttribute("value");if(x(r)){for(var s=r.length;s--;)if(o==r[s])return void(i.isChecked=n.checked=!0);i.isChecked=n.checked=!1}else i.isChecked=n.checked=r==o}function hi(t){for(var e=t?{}:Jn(this.getValue()||""),n=this.node.style,i=Object.keys(e),r=this.previous||[],o=0;o<i.length;){if(i[o]in n){var s=e[i[o]].replace("!important","");n.setProperty(i[o],s,s.length!==e[i[o]].length?"important":"")}o++}for(o=r.length;o--;)!~i.indexOf(r[o])&&r[o]in n&&n.setProperty(r[o],"","");this.previous=i}function li(t){this.style||(this.style=b(this.name.substr(6)));var e=t?"":g(this.getValue()),n=e.replace("!important","");this.node.style.setProperty(this.style,n,n.length!==e.length?"important":"")}function ci(t){for(var e=t?[]:Zn(g(this.getValue())),n=Zn(this.node.className),i=this.previous||n.slice(0),r=0;r<e.length;)~n.indexOf(e[r])||n.push(e[r]),r++;for(r=i.length;r--;)if(!~e.indexOf(i[r])){var o=n.indexOf(i[r]);~o&&n.splice(o,1)}var s=n.join(" ");s!==this.node.className&&(this.node.className=s),this.previous=e}function pi(t){var e=this.name.substr(6),n=Zn(this.node.className),i=!t&&this.getValue();this.inlineClass||(this.inlineClass=e),i&&!~n.indexOf(e)?n.push(e):!i&&~n.indexOf(e)&&n.splice(n.indexOf(e),1),this.node.className=n.join(" ")}function fi(t){if(!this.locked){if(t)return this.useProperty&&(this.node[this.propertyName]=!1),void this.node.removeAttribute(this.propertyName);this.useProperty?this.node[this.propertyName]=this.getValue():this.getValue()?this.node.setAttribute(this.propertyName,""):this.node.removeAttribute(this.propertyName)}}function di(t){t?this.node.removeAttribute(this.name):this.node.setAttribute(this.name,g(this.getString()))}function mi(t){t?this.node.removeAttributeNS(this.namespace,this.name.slice(this.name.indexOf(":")+1)):this.node.setAttributeNS(this.namespace,this.name.slice(this.name.indexOf(":")+1),g(this.getString()))}function vi(t){return t.replace(Pu,function(t,e){var n;return n="#"!==e[0]?Fu[e]:"x"===e[1]?parseInt(e.substring(2),16):parseInt(e.substring(1),10),n?Bu(yi(n)):t})}function gi(t){return t.replace(Vu,"&amp;").replace(Iu,"&lt;").replace(Lu,"&gt;")}function yi(t){return t?10===t?32:t<128?t:t<=159?ju[t-128]:t<55296?t:t<=57343?Ku:t<=65535?t:Mu?t>=65536&&t<=131071?t:t>=131072&&t<=196607?t:Ku:Ku:Ku}function bi(t,e){for(var n="xmlns:"+e;t;){if(t.hasAttribute&&t.hasAttribute(n))return t.getAttribute(n);t=t.parentNode}return Bo[e]}function wi(t,e,n){0===e?t.value=!0:"true"===e?t.value=!0:"false"===e||"0"===e?t.value=!1:t.value=e;var i=t.element[t.flag];return t.element[t.flag]=t.value,n&&!t.element.attributes.binding&&i!==t.value&&t.element.recreateTwowayBinding(),t.value}function ki(){return qu}function xi(t){qu=!0,t(),qu=!1}function Ei(t,e){var n=e?"svg":"div";return t?(Uu.innerHTML="<"+n+" "+t+"></"+n+">")&&q(Uu.childNodes[0].attributes):[]}function _i(t,e){for(var n=t.length;n--;)if(t[n].name===e.name)return!1;return!0}function Ai(t,e,n,i){if(t.set&&t.set.__magic)return t.set.__magic.dependants.push({ractive:e,keypath:n}),t;var r=void 0,o=[{ractive:e,keypath:n}],s={get:function(){return"value"in t?t.value:t.get.call(this)},set:function(e){r||("value"in t?t.value=e:t.set.call(this,e),i.locked||(r=!0,o.forEach(function(t){var n=t.ractive,i=t.keypath;n.set(i,e)}),r=!1))},enumerable:!0};return s.set.__magic={dependants:o,originalDescriptor:t},s}function Ci(t,e,n){if(!t.set||!t.set.__magic)return!0;for(var i=t.set.__magic,r=i.length;r--;){var o=i[r];if(o.ractive===e&&o.keypath===n)return i.splice(r,1),!1}}function Si(t){var e=t.replace(/^\t+/gm,function(t){return t.split("\t").join("  ")}).split("\n"),n=e.length<2?0:e.slice(1).reduce(function(t,e){return Math.min(t,/^\s*/.exec(e)[0].length)},1/0);return e.map(function(t,e){return"    "+(e?t.substring(n):t)}).join("\n")}function Oi(t){if(!t)return"";for(var e=t.split("\n"),n=ah.name+".getValue",i=[],r=e.length,o=1;o<r;o+=1){var s=e[o];if(~s.indexOf(n))return i.join("\n");i.push(s)}}function Ti(t,e,n){var i=void 0,r=void 0,o=void 0,s=void 0,a=void 0;return"function"==typeof n&&(i=rt(n,t),o=n.toString(),s=!0),"string"==typeof n&&(i=Tn(n,t),o=n),"object"==typeof n&&("string"==typeof n.get?(i=Tn(n.get,t),o=n.get):"function"==typeof n.get?(i=rt(n.get,t),o=n.get.toString(),s=!0):S("`%s` computation must have a `get()` method",e),"function"==typeof n.set&&(r=rt(n.set,t),a=n.set.toString())),{getter:i,setter:r,getterString:o,setterString:a,getterUseStack:s}}function Ni(t,e){Gr.DEBUG&&Uo(),Pi(t),Lo(t,"data",{get:Mi}),ch.fire(t,e),ph.forEach(function(n){t[n]=w(Io(t.constructor[n]||null),e[n])});var n=new lh({adapt:ji(t,t.adapt,e),data:Ea.init(t.constructor,t,e),ractive:t});t.viewmodel=n;var i=w(Io(t.constructor.prototype.computed),e.computed);for(var r in i){var o=Ti(t,r,i[r]);n.compute(r,o)}}function Fi(t){for(var e=[],n=e.concat.apply(e,t),i=n.length;i--;)~e.indexOf(n[i])||e.unshift(n[i]);return e}function ji(t,e,n){function i(e){return"string"==typeof e&&(e=P("adaptors",t,e),e||S(Yo(e,"adaptor"))),e}e=e.map(i);var r=R(n.adapt).map(i),o=[],s=[e,r];t.parent&&!t.isolated&&s.push(t.parent.viewmodel.adaptors),s.push(o);var a="magic"in n?n.magic:t.magic,u="modifyArrays"in n?n.modifyArrays:t.modifyArrays;if(a){if(!go)throw new Error("Getters and setters (magic mode) are not supported in this browser");u&&o.push(sh),o.push(ih)}return u&&o.push(Zu),Fi(s)}function Pi(t){t._guid="r-"+fh++,t._subs=Io(null),t._config={},t.nodes={},t.event=null,t._eventQueue=[],t._liveQueries=[],t._liveComponentQueries=[],t._observers=[],t.component||(t.root=t,t.parent=t.container=null)}function Mi(){throw new Error("Using `ractive.data` is no longer supported - you must use the `ractive.get()` API instead")}function Bi(t,e){return t[e._guid]||(t[e._guid]=[])}function Ii(t,e){var n=Bi(t.queue,e);for(t.hook.fire(e);n.length;)Ii(t,n.shift());delete t.queue[e._guid]}function Li(t,e,n){Object.keys(t.viewmodel.computations).forEach(function(e){var n=t.viewmodel.computations[e];t.viewmodel.value.hasOwnProperty(e)&&n.set(t.viewmodel.value[e])}),Da.init(t.constructor,t,e),mh.fire(t),vh.begin(t);var i=void 0;if(t.template){var r=void 0;(n.cssIds||t.cssId)&&(r=n.cssIds?n.cssIds.slice():[],t.cssId&&r.push(t.cssId)),t.fragment=i=new $l({owner:t,template:t.template,cssIds:r}).bind(t.viewmodel)}if(vh.end(t),i){var o=m(t.el);if(o){var s=t.render(o,t.append);Gr.DEBUG_PROMISES&&s.catch(function(e){throw j("Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\n  Ractive.DEBUG_PROMISES = false;"),F("An error happened during rendering",{ractive:t}),O(e),e})}}}function Vi(t){var e=t.ractive;do for(var n=e._liveComponentQueries,i=n.length;i--;){var r=n[i],o=n["_"+r];o.test(t)&&(o.add(t.instance),t.liveQueries.push(o))}while(e=e.parent)}function Ki(t){for(var e=t.ractive;e;){var n=e._liveComponentQueries["_"+t.name];n&&n.remove(t),e=e.parent}}function Ri(t){t.makeDirty()}function Di(t){var e=t.node,n=t.ractive;do for(var i=n._liveQueries,r=i.length;r--;){var o=i[r],s=i["_"+o];s.test(e)&&(s.add(e),t.liveQueries.push(s))}while(n=n.parent)}function Ui(t,e){j("The "+t+" being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity",{ractive:e})}function qi(){this._ractive.binding.handleChange()}function zi(t,e,n){var i=t+"-bindingGroup";return e[i]||(e[i]=new Nh(i,e,n))}function Hi(){var t=this.bindings.filter(function(t){return t.node&&t.node.checked}).map(function(t){return t.element.getAttribute("value")}),e=[];return t.forEach(function(t){V(e,t)||e.push(t)}),e}function Wi(){qi.call(this);var t=this._ractive.binding.model.get();this.value=void 0==t?"":t}function Qi(t){var e=void 0;return function(){var n=this;e&&clearTimeout(e),e=setTimeout(function(){var t=n._ractive.binding;t.rendered&&qi.call(n),e=null},t)}}function $i(t){return t.selectedOptions?q(t.selectedOptions):t.options?q(t.options).filter(function(t){return t.selected}):[]}function Gi(t){return Vh[t]||(Vh[t]=[])}function Yi(){var t=this.bindings.filter(function(t){return t.node.checked});if(t.length>0)return t[0].element.getAttribute("value")}function Ji(t){return t&&t.template.f&&1===t.template.f.length&&t.template.f[0].t===$a&&!t.template.f[0].s}function Zi(t){var e=t.attributeByName;if(t.getAttribute("contenteditable")||Ji(e.contenteditable))return Ji(e.value)?Ph:null;if("input"===t.name){var n=t.getAttribute("type");if("radio"===n||"checkbox"===n){var i=Ji(e.name),r=Ji(e.checked);if(i&&r){if("radio"!==n)return Th;F("A radio input can have two-way binding on its name attribute, or its checked attribute - not both",{ractive:t.root})}if(i)return"radio"===n?Rh:jh;if(r)return"radio"===n?Kh:Th}return"file"===n&&Ji(e.value)?Bh:Ji(e.value)?"number"===n||"range"===n?Lh:Mh:null}return"select"===t.name&&Ji(e.value)?t.getAttribute("multiple")?Ih:Dh:"textarea"===t.name&&Ji(e.value)?Mh:void 0}function Xi(t){t.makeDirty()}function tr(t){var e=t.attributeByName,n=e.type,i=e.value,r=e.name;if(n&&"radio"===n.value&&i&&r.interpolator)return i.getValue()===r.interpolator.model.get()||void 0}function er(t){var e=t.toString();return e?" "+e:""}function nr(t){for(var e=t.liveQueries.length;e--;){var n=t.liveQueries[e];n.remove(t.node)}}function ir(t){var e=t.getAttribute("xmlns");if(e)return e;if("svg"===t.name)return Fo;var n=t.parent;return n?"foreignobject"===n.name?To:n.node.namespaceURI:t.ractive.el.namespaceURI}function rr(){var t=this._ractive.proxy;as.start(),t.formBindings.forEach(or),as.end()}function or(t){t.model.set(t.resetValue)}function sr(t){var e;return(e=t.matchPattern(il))?{t:ru,v:e}:null}function ar(t){var e;return(e=nl(t))?ol.test(e.v)?e.v:'"'+e.v.replace(/"/g,'\\"')+'"':(e=sr(t))?e.v:(e=t.matchPattern(rl))?e:null}function ur(t){t.allowWhitespace();var e=ar(t);if(!e)return null;var n={key:e};if(t.allowWhitespace(),!t.matchString(":"))return null;t.allowWhitespace();var i=t.read();return i?(n.value=i.v,n):null}function hr(t){var e=t.template.f,n=t.element.instance.viewmodel,i=n.value;1===e.length&&e[0].t===$a?(t.model=$n(t.parentFragment,e[0]),t.model||(j("The "+t.name+"='{{"+e[0].r+"}}' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity",{ractive:t.element.instance}),t.parentFragment.ractive.get(t.name),t.model=t.parentFragment.findContext().joinKey(t.name)),t.link=n.createLink(t.name,t.model,e[0].r),void 0===t.model.get()&&t.name in i&&t.model.set(i[t.name])):(t.boundFragment=new $l({owner:t,template:e}).bind(),t.model=n.joinKey(t.name),t.model.set(t.boundFragment.valueOf()),t.boundFragment.bubble=function(){$l.prototype.bubble.call(t.boundFragment),as.scheduleTask(function(){t.boundFragment.update(),t.model.set(t.boundFragment.valueOf())})})}function lr(t,e,n){var i=cr(t,e,n||{});if(i)return i;if(i=Fa.fromId(e,{noThrow:!0})){var r=Fa.parseFor(i,t);return r.p&&k(t.partials,r.p),t.partials[e]=r.t}}function cr(t,e,n){var i=dr(e,n.owner);if(i)return i;var r=M("partials",t,e);if(r){i=r.partials[e];var o=void 0;if("function"==typeof i&&(o=i.bind(r),o.isOwner=r.partials.hasOwnProperty(e),i=o.call(t,Fa)),!i&&""!==i)return void F(Go,e,"partial","partial",{ractive:t});if(!Fa.isParsed(i)){var s=Fa.parseFor(i,r);s.p&&F("Partials ({{>%s}}) cannot contain nested inline partials",e,{ractive:t});var a=o?r:pr(r,e);a.partials[e]=i=s.t}return o&&(i._fn=o),i.v?i.t:i}}function pr(t,e){return t.partials.hasOwnProperty(e)?t:fr(t.constructor,e)}function fr(t,e){if(t)return t.partials.hasOwnProperty(e)?t:fr(t._Parent,e)}function dr(t,e){if(e){if(e.template&&e.template.p&&e.template.p[t])return e.template.p[t];if(e.parentFragment&&e.parentFragment.owner)return dr(t,e.parentFragment.owner)}}function mr(t,e,n){var i=void 0;try{i=Fa.parse(e,Fa.getParseOptions(n))}catch(e){F("Could not parse partial from expression '"+t+"'\n"+e.message)}return i||{t:[]}}function vr(t){return!t||x(t)&&0===t.length||A(t)&&0===Object.keys(t).length}function gr(t,e){return e||x(t)?hu:A(t)||"function"==typeof t?cu:void 0===t?null:au}function yr(t,e){for(var n=t.length;n--;)if(t[n]==e)return!0}function br(){Al=!fo[Cl]}function wr(){Al=!1}function kr(){Al=!0}function xr(t,e){e?t.setAttribute("style",e):(t.getAttribute("style"),t.removeAttribute("style"))}function Er(t){return Rl[t]||(Rl[t]=yo(t))}function _r(t,e){var n=M("components",t,e),i=void 0;if(n&&(i=n.components[e],!i._Parent)){var r=i.bind(n);if(r.isOwner=n.components.hasOwnProperty(e),i=r(),!i)return void F(Go,e,"component","component",{ractive:t});"string"==typeof i&&(i=_r(t,i)),i._fn=r,n.components[e]=i}return i}function Ar(t){if("string"==typeof t.template)return new kl(t);if(t.template.t===Ja){var e=_r(t.parentFragment.ractive,t.template.e);if(e)return new _h(t,e);var n=t.template.e.toLowerCase(),i=Ql[n]||qh;return new i(t)}var r=void 0;if(t.template.t===Xa){var o=t.owner;(!o||o.type!==tu&&o.type!==Ja)&&(o=Yn(t.parentFragment)),t.element=o,r=o.type===tu?dl:Ru}else r=Wl[t.template.t];if(!r)throw new Error("Unrecognised item type "+t.template.t);return new r(t)}function Cr(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return t.map(function(t){if(t.type===Qa)return t.template;if(t.fragment)return t.fragment.iterations?t.fragment.iterations.map(function(t){return Cr(t.items,e,n,i)}).join(""):Cr(t.fragment.items,e,n,i);var r=n+"-"+i++,o=t.model||t.newModel;return e[r]=o?o.wrapper?o.wrapperValue:o.get():void 0,"${"+r+"}"}).join("")}function Sr(t){t.unrender(!0)}function Or(t){ja.init(null,this,{template:t});var e=this.transitionsEnabled;this.transitionsEnabled=!1;var n=this.component;n&&(n.shouldDestroy=!0),this.unrender(),n&&(n.shouldDestroy=!1),this.fragment.unbind().unrender(!0),this.fragment=new $l({template:this.template,root:this,owner:this});var i=d();this.fragment.bind(this.viewmodel).render(i),n?this.fragment.findParentNode().insertBefore(i,n.findNextNode()):this.el.insertBefore(i,this.anchor),this.transitionsEnabled=e}function Tr(t,e){var n=this;return ot(n,at(n,t,e))}function Nr(t,e){return ut(this,t,void 0===e?-1:-e)}function Fr(){if(this.torndown)return F("ractive.teardown() was called on a Ractive instance that was already torn down"),is.resolve();this.torndown=!0,this.fragment.unbind(),this.viewmodel.teardown(),this._observers.forEach(Kt),this.fragment.rendered&&this.el.__ractive_instances__&&U(this.el.__ractive_instances__,this),this.shouldDestroy=!0;var t=this.fragment.rendered?this.unrender():is.resolve();return Xl.fire(this),t}function jr(t){if("string"!=typeof t)throw new TypeError($o);return ot(this,st(this,t).map(function(t){return[t,!t.get()]}))}function Pr(){var t=[this.cssId].concat(this.findAllComponents().map(function(t){return t.cssId})),e=Object.keys(t.reduce(function(t,e){return t[e]=!0,t},{}));return hn(e)}function Mr(){return this.fragment.toString(!0)}function Br(){return this.fragment.toString(!1)}function Ir(t,e,n){e instanceof HTMLElement||A(e)&&(n=e),e=e||this.event.node,e&&e._ractive||S("No node was supplied for transition "+t),n=n||{};var i=e._ractive.proxy,r=new Kl({owner:i,parentFragment:i.parentFragment,name:t,params:n});r.bind();var o=as.start(this,!0);return as.registerTransition(r),as.end(),o.then(function(){return r.unbind()}),o}function Lr(t){var e=as.start();return this.viewmodel.joinAll(nt(t),{lastLink:!1}).unlink(),as.end(),e}function Vr(){if(!this.fragment.rendered)return F("ractive.unrender() was called on a Ractive instance that was not rendered"),is.resolve();var t=as.start(this,!0),e=!this.component||this.component.shouldDestroy||this.shouldDestroy;return this.fragment.unrender(e),U(this.el.__ractive_instances__,this),tc.fire(this),as.end(),t}function Kr(t,e){var n=as.start(this,!0);return t?this.viewmodel.joinAll(nt(t)).updateFromBindings(e!==!1):this.viewmodel.updateFromBindings(!0),as.end(),n}function Rr(t,e){return"function"==typeof e&&/_super/.test(t)}function Dr(t){for(var e={};t;)Ur(t,e),zr(t,e),t=t._Parent!==Gr&&t._Parent;return e}function Ur(t,e){Ba.forEach(function(n){qr(n.useDefaults?t.prototype:t,e,n.name)})}function qr(t,e,n){var i,r=Object.keys(t[n]);r.length&&((i=e[n])||(i=e[n]={}),r.filter(function(t){return!(t in i)}).forEach(function(e){return i[e]=t[n][e]}))}function zr(t,e){Object.keys(t.prototype).forEach(function(n){if("computed"!==n){var i=t.prototype[n];if(n in e){if("function"==typeof e[n]&&"function"==typeof i&&e[n]._method){var r=void 0,o=i._method;o&&(i=i._method),r=ic(e[n]._method,i),o&&(r._method=r),e[n]=r}}else e[n]=i._method?i._method:i}})}function Hr(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length?e.reduce(Wr,this):Wr(this)}function Wr(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.prototype instanceof Gr&&(i=Dr(i)),e=function(t){return this instanceof e?(Ni(this,t||{}),void Li(this,t||{},{})):new e(t)},n=Io(t.prototype),n.constructor=e,Vo(e,{defaults:{value:n},extend:{value:Hr,writable:!0,configurable:!0},_Parent:{value:t}}),Da.extend(t,n,i),Ea.extend(t,n,i),i.computed&&(n.computed=w(Io(t.prototype.computed),i.computed)),e.prototype=n,e}function Qr(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.map(tt).join(".")}function $r(t){return nt(t).map(it)}function Gr(t){return this instanceof Gr?(Ni(this,t||{}),void Li(this,t||{},{})):new Gr(t)}function Yr(t){function e(){var e=t.value?+t.value:NaN,n=t.getAttribute("min"),o=+n||0,s=t.getAttribute("max"),a=+s||0;if(n&&e<o)i.set(r,o);else if(s&&e>a)i.set(r,a);else{var u=+t.getAttribute("step")||1,h=Math.round(e/u)*u;e!==h&&i.set(r,e===e?h:o)}}var n=Gr.getNodeInfo(t);if(!n.isBound())throw Error("The ClampedNumber decorator only works with two-way bindings!");var i=n.ractive,r=n.getBindingPath();t.addEventListener("blur",e,!1);var o=new MutationObserver(e);return o.observe(t,{attributes:!0,attributeFilter:["min","max","step"]}),{teardown:function(){t.removeEventListener("blur",e,!1),o.disconnect()}}}function Jr(t){function e(t){return("0"+Math.round(255*t).toString(16).toUpperCase()).slice(-2)}if(!t)return"#000000";var n=t.r,i=t.g,r=t.b;return"#"+e(n)+e(i)+e(r)}function Zr(t){function e(t){var e=parseInt(t,16);return 16*e+e}if(t)if(t.startsWith("#")&&(t=t.slice(1)),3===t.length){var n=e(t.charAt(0))/255,i=e(t.charAt(1))/255,r=e(t.charAt(2))/255;if(n===n&&i===i&&r===r)return{r:n,g:i,b:r}}else if(6===t.length){var o=parseInt(t.slice(0,2),16)/255,s=parseInt(t.slice(2,4),16)/255,a=parseInt(t.slice(4,6),16)/255;if(o===o&&s===s&&a===a)return{r:o,g:s,b:a}}}function Xr(t,e){function n(){var n=Zr(t.value);n&&i.set(e,n)}var i=Gr.getNodeInfo(t);return t.value=Jr(i.get(e)),t.addEventListener("change",n,!1),t.addEventListener("input",n,!1),{update:function(t){e=t,n()},teardown:function(){t.removeEventListener("change",n,!1),t.removeEventListener("input",n,!1)}}}function to(t,e){function n(e){t.setAttribute("title",e),t.setAttribute("aria-label",e)}return n(e),{update:n,teardown:function(){t.removeAttribute("title"),t.removeAttribute("aria-label")}}}function eo(t){return t.focus&&t.focus(),t.select&&t.select(),{teardown:function(){}}}function no(t){function e(e){"Enter"!==e.key&&" "!==e.key||t.click()}return t.addEventListener("keypress",e,!1),t.setAttribute("tabindex","0"),t.setAttribute("aria-role","button"),{teardown:function(){t.removeEventListener("keypress",e,!1),t.removeAttribute("tabindex"),t.removeAttribute("aria-role")}}}function io(t){function e(e){for(var n=function(n){var i=e[n];if(!i)return"continue";s.hasChildNodes()&&s.appendChild(document.createElement("hr"));var r=function(e){var n=document.createElement("menuitem");n.setAttribute("label",e),n.addEventListener("click",function(){var n=Gr.getNodeInfo(t);n.ractive.fire(i[e],n,t)}),s.appendChild(n)};for(var o in i)r(o)},i=0;i<e.length;++i){n(i)}}for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o="decorator-context-menu-"+fc++,s=document.createElement("menu");return s.setAttribute("type","context"),s.setAttribute("id",o),e(i),document.body.appendChild(s),t.setAttribute("contextmenu",o),{update:function(){for(;s.hasChildNodes();)s.removeChild(s.lastChild);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];
e(n)},teardown:function(){t.removeAttribute("contextmenu"),document.body.removeChild(s)}}}function ro(t){return t.map(function(t){return t.map(function(t){return t+1}).join(", ")}).join("\n")}function oo(t){return t.split("\n").map(function(t){return t.split(",").map(function(t){return parseInt(t.trim(),10)-1}).filter(function(t){return t===t})})}function so(){for(var t=0,e=dc.length;t<e;++t)dc[t]()}function ao(t,e){function n(){a.cancel(),a=i({init:!0})}function i(n){var i=n.init;return o.ractive.observe(o.resolve()+"."+e,function(){var n=ro(o.get(e));if(t.value!==n){var i=oo(t.value);i&&ro(i)===n||(t.value=n)}},{init:i})}function r(){var n=oo(t.value);n&&o.set(e,n)}var o=Gr.getNodeInfo(t.closest(".pattern"));dc.push(n);var a=i({init:!0});return t.value=ro(o.get(e)),t.addEventListener("change",r,!1),t.addEventListener("input",r,!1),{update:function(t){a.cancel(),e=t,r(),a=i({init:!1})},teardown:function(){a.cancel(),t.removeEventListener("change",r,!1),t.removeEventListener("input",r,!1),s(dc,dc.indexOf(n))}}}var uo=Object.prototype.hasOwnProperty,ho={el:void 0,append:!1,template:null,delimiters:["{{","}}"],tripleDelimiters:["{{{","}}}"],staticDelimiters:["[[","]]"],staticTripleDelimiters:["[[[","]]]"],csp:!0,interpolate:!1,preserveWhitespace:!1,sanitize:!1,stripComments:!0,contextLines:0,data:{},computed:{},magic:!1,modifyArrays:!1,adapt:[],isolated:!1,twoway:!0,lazy:!1,noIntro:!1,transitionsEnabled:!0,complete:void 0,css:null,noCssTransform:!1},lo={linear:function(t){return t},easeIn:function(t){return Math.pow(t,3)},easeOut:function(t){return Math.pow(t-1,3)+1},easeInOut:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)}},co=null,po="undefined"!=typeof window?window:null,fo=po?document:null,mo=!!fo,vo=("undefined"!=typeof navigator&&/jsDom/.test(navigator.appName),"undefined"!=typeof console&&"function"==typeof console.warn&&"function"==typeof console.warn.apply),go=void 0;try{Object.defineProperty({},"test",{value:0}),go=!0}catch(t){go=!1}var yo,bo,wo,ko,xo,Eo,_o,Ao,Co,So=!!fo&&fo.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),Oo=["o","ms","moz","webkit"],To="http://www.w3.org/1999/xhtml",No="http://www.w3.org/1998/Math/MathML",Fo="http://www.w3.org/2000/svg",jo="http://www.w3.org/1999/xlink",Po="http://www.w3.org/XML/1998/namespace",Mo="http://www.w3.org/2000/xmlns",Bo={html:To,mathml:No,svg:Fo,xlink:jo,xml:Po,xmlns:Mo};if(yo=So?function(t,e,n){return e&&e!==To?n?fo.createElementNS(e,t,n):fo.createElementNS(e,t):n?fo.createElement(t,n):fo.createElement(t)}:function(t,e,n){if(e&&e!==To)throw"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information";return n?fo.createElement(t,n):fo.createElement(t)},mo){for(wo=yo("div"),ko=["matches","matchesSelector"],Co=function(t){return function(e,n){return e[t](n)}},_o=ko.length;_o--&&!bo;)if(xo=ko[_o],wo[xo])bo=Co(xo);else for(Ao=Oo.length;Ao--;)if(Eo=Oo[_o]+xo.substr(0,1).toUpperCase()+xo.substring(1),wo[Eo]){bo=Co(Eo);break}bo||(bo=function(t,e){var n,i,r;for(i=t.parentNode,i||(wo.innerHTML="",i=wo,t=t.cloneNode(),wo.appendChild(t)),n=i.querySelectorAll(e),r=n.length;r--;)if(n[r]===t)return!0;return!1})}else bo=null;var Io,Lo,Vo,Ko=/[A-Z]/g;try{Object.defineProperty({},"test",{get:function(){},set:function(){}}),fo&&Object.defineProperty(yo("div"),"test",{value:0}),Lo=Object.defineProperty}catch(t){Lo=function(t,e,n){n.get?t[e]=n.get():t[e]=n.value}}try{try{Object.defineProperties({},{test:{value:0}})}catch(t){throw t}fo&&Object.defineProperties(yo("div"),{test:{value:0}}),Vo=Object.defineProperties}catch(t){Vo=function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&Lo(t,n,e[n])}}try{Object.create(null),Io=Object.create}catch(t){Io=function(){var t=function(){};return function(e,n){var i;return null===e?{}:(t.prototype=e,i=new t,n&&Object.defineProperties(i,n),i)}}()}var Ro,Do,Uo,qo=Object.prototype.hasOwnProperty,zo=Object.prototype.toString,Ho=function(){},Wo={};vo?!function(){var t=["%cRactive.js %c0.8.9 %cin debug mode, %cmore...","color: rgb(114, 157, 52); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;"],e="You're running Ractive 0.8.9 in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://docs.ractivejs.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n";Uo=function(){if(Gr.WELCOME_MESSAGE===!1)return void(Uo=Ho);var n="WELCOME_MESSAGE"in Gr?Gr.WELCOME_MESSAGE:e,i=!!console.groupCollapsed;i&&console.groupCollapsed.apply(console,t),console.log(n),i&&console.groupEnd(t),Uo=Ho},Do=function(t,e){if(Uo(),"object"==typeof e[e.length-1]){var n=e.pop(),i=n?n.ractive:null;if(i){var r=void 0;i.component&&(r=i.component.name)&&(t="<"+r+"> "+t);var o=void 0;(o=n.node||i.fragment&&i.fragment.rendered&&i.find("*"))&&e.push(o)}}console.warn.apply(console,["%cRactive.js: %c"+t,"color: rgb(114, 157, 52);","color: rgb(85, 85, 85);"].concat(e))},Ro=function(){console.log.apply(console,arguments)}}():Do=Ro=Uo=Ho;var Qo,$o="Bad arguments",Go='A function was specified for "%s" %s, but no %s was returned',Yo=function(t,e){return'Missing "'+t+'" '+e+" plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#"+e+"s"},Jo={number:function(t,e){var n;return _(t)&&_(e)?(t=+t,e=+e,n=e-t,n?function(e){return t+e*n}:function(){return t}):null},array:function(t,e){var n,i,r,o;if(!x(t)||!x(e))return null;for(n=[],i=[],o=r=Math.min(t.length,e.length);o--;)i[o]=B(t[o],e[o]);for(o=r;o<t.length;o+=1)n[o]=t[o];for(o=r;o<e.length;o+=1)n[o]=e[o];return function(t){for(var e=r;e--;)n[e]=i[e](t);return n}},object:function(t,e){var n,i,r,o,s;if(!A(t)||!A(e))return null;n=[],o={},r={};for(s in t)qo.call(t,s)&&(qo.call(e,s)?(n.push(s),r[s]=B(t[s],e[s])||I(e[s])):o[s]=t[s]);for(s in e)qo.call(e,s)&&!qo.call(t,s)&&(o[s]=e[s]);return i=n.length,function(t){for(var e,s=i;s--;)e=n[s],o[e]=r[e](t);return o}}},Zo={construct:{deprecated:"beforeInit",replacement:"onconstruct"},render:{deprecated:"init",message:'The "init" method has been deprecated and will likely be removed in a future release. You can either use the "oninit" method which will fire only once prior to, and regardless of, any eventual ractive instance being rendered, or if you need to access the rendered DOM, use "onrender" instead. See http://docs.ractivejs.org/latest/migrating for more information.'},complete:{deprecated:"complete",replacement:"oncomplete"}},Xo=function(){function t(e){n(this,t),this.event=e,this.method="on"+e,this.deprecate=Zo[e]}return t.prototype.call=function(t,e,n){if(e[t])return n?e[t](n):e[t](),!0},t.prototype.fire=function(t,e){this.call(this.method,t,e),!t[this.method]&&this.deprecate&&this.call(this.deprecate.deprecated,t,e)&&(this.deprecate.message?F(this.deprecate.message):F('The method "%s" has been deprecated in favor of "%s" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.',this.deprecate.deprecated,this.deprecate.replacement)),e?t.fire(this.event,e):t.fire(this.event)},t}(),ts={},es={},ns={};"function"==typeof Promise?Qo=Promise:(Qo=function(t){var e,n,i,r,o,s,a=[],u=[],h=ts;i=function(t){return function(i){h===ts&&(e=i,h=t,n=H(h===es?a:u,e),z(n))}},r=i(es),o=i(ns);try{t(r,o)}catch(t){o(t)}return s={then:function(t,e){var i=new Qo(function(r,o){var s=function(t,e,n){"function"==typeof t?e.push(function(e){var n;try{n=t(e),W(i,n,r,o)}catch(t){o(t)}}):e.push(n)};s(t,a,r),s(e,u,o),h!==ts&&z(n)});return i}},s.catch=function(t){return this.then(null,t)},s},Qo.all=function(t){return new Qo(function(e,n){var i,r,o,s=[];if(!t.length)return void e(s);for(o=function(t,r){t&&"function"==typeof t.then?t.then(function(t){s[r]=t,--i||e(s)},n):(s[r]=t,--i||e(s))},i=r=t.length;r--;)o(t[r],r)})},Qo.resolve=function(t){return new Qo(function(e){e(t)})},Qo.reject=function(t){return new Qo(function(e,n){n(t)})});var is=Qo,rs=function(){function t(e,i){n(this,t),this.callback=e,this.parent=i,this.intros=[],this.outros=[],this.children=[],this.totalChildren=this.outroChildren=0,this.detachQueue=[],this.outrosComplete=!1,i&&i.addChild(this)}return t.prototype.add=function(t){var e=t.isIntro?this.intros:this.outros;e.push(t)},t.prototype.addChild=function(t){this.children.push(t),this.totalChildren+=1,this.outroChildren+=1},t.prototype.decrementOutros=function(){this.outroChildren-=1,G(this)},t.prototype.decrementTotal=function(){this.totalChildren-=1,G(this)},t.prototype.detachNodes=function(){this.detachQueue.forEach(Q),this.children.forEach($)},t.prototype.ready=function(){Y(this)},t.prototype.remove=function(t){var e=t.isIntro?this.intros:this.outros;U(e,t),G(this)},t.prototype.start=function(){this.children.forEach(function(t){return t.start()}),this.intros.concat(this.outros).forEach(function(t){return t.start()}),this.ready=!0,G(this)},t}(),os=new Xo("change"),ss=void 0,as={start:function(t,e){var n,i;return e&&(n=new is(function(t){return i=t})),ss={previousBatch:ss,transitionManager:new rs(i,ss&&ss.transitionManager),fragments:[],tasks:[],immediateObservers:[],deferredObservers:[],ractives:[],instance:t},n},end:function(){X(),ss.previousBatch||ss.transitionManager.start(),ss=ss.previousBatch},addFragment:function(t){L(ss.fragments,t)},addFragmentToRoot:function(t){if(ss){for(var e=ss;e.previousBatch;)e=e.previousBatch;L(e.fragments,t)}},addInstance:function(t){ss&&L(ss.ractives,t)},addObserver:function(t,e){L(e?ss.deferredObservers:ss.immediateObservers,t)},registerTransition:function(t){t._manager=ss.transitionManager,ss.transitionManager.add(t)},detachWhenReady:function(t){ss.transitionManager.detachQueue.push(t)},scheduleTask:function(t,e){var n;if(ss){for(n=ss;e&&n.previousBatch;)n=n.previousBatch;n.tasks.push(t)}else t()}},us=/\[\s*(\*|[0-9]|[1-9][0-9]+)\s*\]/g,hs=/([^\\](?:\\\\)*)\./,ls=/\\|\./g,cs=/((?:\\)+)\1|\\(\.)/g,ps=/\*/,fs="Cannot add to a non-numeric value",ds=is.resolve();Lo(ds,"stop",{value:Ho});var ms=lo.linear,vs=new Xo("detach"),gs=function(){function t(e,i,r,o){n(this,t),this.ractive=e,this.selector=i,this.live=r,this.isComponentQuery=o,this.result=[],this.dirty=!0}return t.prototype.add=function(t){this.result.push(t),this.makeDirty()},t.prototype.cancel=function(){var t=this._root[this.isComponentQuery?"liveComponentQueries":"liveQueries"],e=this.selector,n=t.indexOf(e);n!==-1&&(t.splice(n,1),t[e]=null)},t.prototype.init=function(){this.dirty=!1},t.prototype.makeDirty=function(){var t=this;this.dirty||(this.dirty=!0,as.scheduleTask(function(){return t.update()}))},t.prototype.remove=function(t){var e=this.result.indexOf(this.isComponentQuery?t.instance:t);e!==-1&&this.result.splice(e,1)},t.prototype.update=function(){this.result.sort(this.isComponentQuery?vt:mt),this.dirty=!1},t.prototype.test=function(t){return this.isComponentQuery?!this.selector||t.name===this.selector:t?bo(t,this.selector):null},t}(),ys={},bs={},ws=[],ks=void 0,xs=function(){function t(e,i){n(this,t),this.value=e,this.isReadonly=this.isKey=!0,this.deps=[],this.links=[],this.parent=i}return t.prototype.get=function(t){return t&&Lt(this),it(this.value)},t.prototype.getKeypath=function(){return it(this.value)},t.prototype.rebinding=function(t,e){for(var n=this.deps.length;n--;)this.deps[n].rebinding(t,e,!1);for(n=this.links.length;n--;)this.links[n].rebinding(t,e,!1)},t.prototype.register=function(t){this.deps.push(t)},t.prototype.registerLink=function(t){L(this.links,t)},t.prototype.unregister=function(t){U(this.deps,t)},t.prototype.unregisterLink=function(t){U(this.links,t)},t}(),Es=function(){function t(e,i){n(this,t),this.parent=e,this.ractive=i,this.value=i?e.getKeypath(i):e.getKeypath(),this.deps=[],this.children={},this.isReadonly=this.isKeypath=!0}return t.prototype.get=function(t){return t&&Lt(this),this.value},t.prototype.getChild=function(e){if(!(e._guid in this.children)){var n=new t(this.parent,e);this.children[e._guid]=n,n.owner=this}return this.children[e._guid]},t.prototype.getKeypath=function(){return this.value},t.prototype.handleChange=function(){for(var t=Object.keys(this.children),e=t.length;e--;)this.children[t[e]].handleChange();this.deps.forEach(Rt)},t.prototype.rebindChildren=function(t){for(var e=Object.keys(this.children),n=e.length;n--;){var i=this.children[e[n]];i.value=t.getKeypath(i.ractive),i.handleChange()}},t.prototype.rebinding=function(t,e){for(var n=t?t.getKeypathModel(this.ractive):void 0,i=Object.keys(this.children),r=i.length;r--;)this.children[i[r]].rebinding(t,e,!1);for(r=this.deps.length;r--;)this.deps[r].rebinding(n,this,!1)},t.prototype.register=function(t){this.deps.push(t)},t.prototype.removeChild=function(t){t.ractive&&delete this.children[t.ractive._guid]},t.prototype.teardown=function(){this.owner&&this.owner.removeChild(this);for(var t=Object.keys(this.children),e=t.length;e--;)this.children[t[e]].teardown()},t.prototype.unregister=function(t){U(this.deps,t),this.deps.length||this.teardown()},t}(),_s=Object.prototype.hasOwnProperty,As={early:[],mark:[]},Cs={early:[],mark:[]},Ss=function(){function t(e){n(this,t),this.deps=[],this.children=[],this.childByKey={},this.links=[],this.keyModels={},this.unresolved=[],this.unresolvedByKey={},this.bindings=[],this.patternObservers=[],e&&(this.parent=e,this.root=e.root)}return t.prototype.addUnresolved=function(t,e){this.unresolvedByKey[t]||(this.unresolved.push(t),this.unresolvedByKey[t]=[]),this.unresolvedByKey[t].push(e)},t.prototype.addShuffleTask=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"early";As[e].push(t)},t.prototype.addShuffleRegister=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"early";Cs[e].push({model:this,item:t})},t.prototype.clearUnresolveds=function(t){for(var e=this.unresolved.length;e--;){var n=this.unresolved[e];if(!t||n===t){for(var i=this.unresolvedByKey[n],r=this.has(n),o=i.length;o--;)r&&i[o].attemptResolution(),i[o].resolved&&i.splice(o,1);i.length||(this.unresolved.splice(e,1),this.unresolvedByKey[n]=null)}}},t.prototype.findMatches=function(t){var e=t.length,n=[this],i=void 0,r=void 0,o=function(){var e=t[r];"*"===e?(i=[],n.forEach(function(t){i.push.apply(i,t.getValueChildren(t.get()))})):i=n.map(function(t){return t.joinKey(e)}),n=i};for(r=0;r<e;r+=1)o();return i},t.prototype.getKeyModel=function(t,e){return void 0===t||e?(t in this.keyModels||(this.keyModels[t]=new xs(tt(t),this)),this.keyModels[t]):this.parent.getKeyModel(t,!0)},t.prototype.getKeypath=function(t){return t!==this.ractive&&this._link?this._link.target.getKeypath(t):(this.keypath||(this.keypath=this.parent.isRoot?this.key:this.parent.getKeypath(t)+"."+tt(this.key)),this.keypath)},t.prototype.getValueChildren=function(t){var e=this,n=void 0;if(x(t))n=[],"length"in this&&this.length!==t.length&&n.push(this.joinKey("length")),t.forEach(function(t,i){n.push(e.joinKey(i))});else if(A(t)||"function"==typeof t)n=Object.keys(t).map(function(t){return e.joinKey(t)});else if(null!=t)return[];return n},t.prototype.getVirtual=function(t){var e=this.get(t,{virtual:!1});if(A(e)){for(var n=x(e)?[]:{},i=Object.keys(e),r=i.length;r--;){var o=this.childByKey[i[r]];o?o._link?n[i[r]]=o._link.getVirtual():n[i[r]]=o.getVirtual():n[i[r]]=e[i[r]]}for(r=this.children.length;r--;){var s=this.children[r];s.key in n||!s._link||(n[s.key]=s._link.getVirtual())}return n}return e},t.prototype.has=function(t){if(this._link)return this._link.has(t);var e=this.get();if(!e)return!1;if(t=it(t),_s.call(e,t))return!0;for(var n=e.constructor;n!==Function&&n!==Array&&n!==Object;){if(_s.call(n.prototype,t))return!0;n=n.constructor}return!1},t.prototype.joinAll=function(t,e){for(var n=this,i=0;i<t.length;i+=1){if(e&&e.lastLink===!1&&i+1===t.length&&n.childByKey[t[i]]&&n.childByKey[t[i]]._link)return n.childByKey[t[i]];n=n.joinKey(t[i],e)}return n},t.prototype.notifyUpstream=function(){for(var t=this.parent,e=[this.key];t;)t.patternObservers.length&&t.patternObservers.forEach(function(t){return t.notify(e.slice())}),e.unshift(t.key),t.links.forEach(qt),t.deps.forEach(Rt),t=t.parent},t.prototype.rebinding=function(t,e,n){for(var i=this.deps.length;i--;)this.deps[i].rebinding&&this.deps[i].rebinding(t,e,n);for(i=this.links.length;i--;){var r=this.links[i];r.owner._link&&r.relinking(t,!0,n)}for(i=this.children.length;i--;){var o=this.children[i];o.rebinding(t?t.joinKey(o.key):void 0,o,n)}for(i=this.unresolved.length;i--;)for(var s=this.unresolvedByKey[this.unresolved[i]],a=s.length;a--;)s[a].rebinding(t,e);for(this.keypathModel&&this.keypathModel.rebinding(t,e,!1),i=this.bindings.length;i--;)this.bindings[i].rebinding(t,e,n)},t.prototype.register=function(t){this.deps.push(t)},t.prototype.registerChange=function(t,e){this.isRoot?(this.changes[t]=e,as.addInstance(this.root.ractive)):this.root.registerChange(t,e)},t.prototype.registerLink=function(t){L(this.links,t)},t.prototype.registerPatternObserver=function(t){this.patternObservers.push(t),this.register(t)},t.prototype.registerTwowayBinding=function(t){this.bindings.push(t)},t.prototype.removeUnresolved=function(t,e){var n=this.unresolvedByKey[t];n&&U(n,e)},t.prototype.shuffled=function(){for(var t=this.children.length;t--;)this.children[t].shuffled();this.wrapper&&(this.wrapper.teardown(),this.wrapper=null,this.rewrap=!0)},t.prototype.unregister=function(t){U(this.deps,t)},t.prototype.unregisterLink=function(t){U(this.links,t)},t.prototype.unregisterPatternObserver=function(t){U(this.patternObservers,t),this.unregister(t)},t.prototype.unregisterTwowayBinding=function(t){U(this.bindings,t)},t.prototype.updateFromBindings=function(t){for(var e=this.bindings.length;e--;){var n=this.bindings[e].getValue();n!==this.value&&this.set(n)}if(!this.bindings.length){var i=Xt(this.deps);i&&i.value!==this.value&&this.set(i.value)}t&&(this.children.forEach(Zt),this.links.forEach(Zt),this._link&&this._link.updateFromBindings(t))},t}();xs.prototype.addShuffleTask=Ss.prototype.addShuffleTask,xs.prototype.addShuffleRegister=Ss.prototype.addShuffleRegister,Es.prototype.addShuffleTask=Ss.prototype.addShuffleTask,Es.prototype.addShuffleRegister=Ss.prototype.addShuffleRegister;var Os=function(i){function r(e,o,s,a){n(this,r);var u=t(this,i.call(this,e));return u.owner=o,u.target=s,u.key=void 0===a?o.key:a,o.isLink&&(u.sourcePath=o.sourcePath+"."+u.key),s.registerLink(u),u.isReadonly=e.isReadonly,u.isLink=!0,u}return e(r,i),r.prototype.animate=function(t,e,n,i){return this.target.animate(t,e,n,i)},r.prototype.applyValue=function(t){this.target.applyValue(t)},r.prototype.get=function(t,e){return t&&(Lt(this),e=e||{},e.unwrap=!0),this.target.get(!1,e)},r.prototype.getKeypath=function(t){return t&&t!==this.root.ractive?this.target.getKeypath(t):i.prototype.getKeypath.call(this,t)},r.prototype.getKeypathModel=function(t){return this.keypathModel||(this.keypathModel=new Es(this)),t&&t!==this.root.ractive?this.keypathModel.getChild(t):this.keypathModel},r.prototype.handleChange=function(){this.deps.forEach(Rt),this.links.forEach(Rt),this.notifyUpstream()},r.prototype.joinKey=function(t){if(void 0===t||""===t)return this;if(!this.childByKey.hasOwnProperty(t)){var e=new r(this,this,this.target.joinKey(t),t);this.children.push(e),this.childByKey[t]=e}return this.childByKey[t]},r.prototype.mark=function(){this.target.mark()},r.prototype.marked=function(){this.links.forEach(Ut),this.deps.forEach(Rt),this.clearUnresolveds()},r.prototype.notifiedUpstream=function(){this.links.forEach(qt),this.deps.forEach(Rt)},r.prototype.relinked=function(){this.target.registerLink(this),this.children.forEach(function(t){return t.relinked()})},r.prototype.relinking=function(t,e,n){var i=this;e&&this.sourcePath&&(t=ee(this.sourcePath,t,this.target)),t&&this.target!==t&&(this.target.unregisterLink(this),this.keypathModel&&this.keypathModel.rebindChildren(t),this.target=t,this.children.forEach(function(e){e.relinking(t.joinKey(e.key),!1,n)}),e&&this.addShuffleTask(function(){i.relinked(),n||i.notifyUpstream()}))},r.prototype.set=function(t){this.target.set(t)},r.prototype.shuffle=function(t){if(!this.shuffling)if(this.target.shuffling){this.shuffling=!0;for(var e=t.length;e--;){var n=t[e];e!==n&&(e in this.childByKey&&this.childByKey[e].rebinding(~n?this.joinKey(n):void 0,this.childByKey[e],!0),!~n&&this.keyModels[e]?this.keyModels[e].rebinding(void 0,this.keyModels[e],!1):~n&&this.keyModels[e]&&(this.keyModels[n]||this.childByKey[n].getKeyModel(n),this.keyModels[e].rebinding(this.keyModels[n],this.keyModels[e],!1)))}var i=this.source().length!==this.source().value.length;for(this.links.forEach(function(e){return e.shuffle(t)}),e=this.deps.length;e--;)this.deps[e].shuffle&&this.deps[e].shuffle(t);this.marked(),i&&this.notifyUpstream(),this.shuffling=!1}else this.target.shuffle(t)},r.prototype.source=function(){return this.target.source?this.target.source():this.target},r.prototype.teardown=function(){this._link&&this._link.teardown(),this.children.forEach(Ht)},r}(Ss);Ss.prototype.link=function(t,e){var n=this._link||new Os(this.parent,this,t,this.key);n.sourcePath=e,this._link&&this._link.relinking(t,!0,!1),this.rebinding(n,this,!1),te();var i=!this._link;return this._link=n,i&&this.parent.clearUnresolveds(),n.marked(),n},Ss.prototype.unlink=function(){if(this._link){var t=this._link;this._link=void 0,t.rebinding(this,this._link),te(),t.teardown()}};var Ts;po?(!function(t,e,n){var i,r;if(!n.requestAnimationFrame){for(i=0;i<t.length&&!n.requestAnimationFrame;++i)n.requestAnimationFrame=n[t[i]+"RequestAnimationFrame"];n.requestAnimationFrame||(r=n.setTimeout,n.requestAnimationFrame=function(t){var n,i,o;return n=Date.now(),i=Math.max(0,16-(n-e)),o=r(function(){t(n+i)},i),e=n+i,o})}}(Oo,0,po),Ts=po.requestAnimationFrame):Ts=null;var Ns=Ts,Fs=po&&po.performance&&"function"==typeof po.performance.now?function(){return po.performance.now()}:function(){return Date.now()},js=[],Ps=!1,Ms=function(){function t(e){n(this,t),this.duration=e.duration,this.step=e.step,this.complete=e.complete,this.easing=e.easing,this.start=Fs(),this.end=this.start+this.duration,this.running=!0,js.push(this),Ps||Ns(ne)}return t.prototype.tick=function(t){if(!this.running)return!1;if(t>this.end)return this.step&&this.step(1),this.complete&&this.complete(1),!1;var e=t-this.start,n=this.easing(e/this.duration);return this.step&&this.step(n),!0},t.prototype.stop=function(){this.abort&&this.abort(),this.running=!1},t}(),Bs={},Is=function(i){function r(e,o){n(this,r);var s=t(this,i.call(this,e));return s.ticker=null,e&&(s.key=it(o),s.isReadonly=e.isReadonly,e.value&&(s.value=e.value[s.key],x(s.value)&&(s.length=s.value.length),s.adapt())),s}return e(r,i),r.prototype.adapt=function(){var t=this.root.adaptors,e=t.length;if(this.rewrap=!1,0!==e){var n=this.wrapper?"newWrapperValue"in this?this.newWrapperValue:this.wrapperValue:this.value,i=this.root.ractive,r=this.getKeypath();if(this.wrapper){var o=this.wrapperValue!==n&&(!this.wrapper.reset||this.wrapper.reset(n)===!1);if(!o)return delete this.newWrapperValue,this.wrapperValue=n,void(this.value=this.wrapper.get());if(this.wrapper.teardown(),this.wrapper=null,void 0!==this.value){var s=this.parent.value||this.parent.createBranch(this.key);s[this.key]!==n&&(s[this.key]=n)}}var a=void 0;for(a=0;a<e;a+=1){var u=t[a];if(u.filter(n,r,i)){this.wrapper=u.wrap(i,n,r,re(r)),this.wrapperValue=n,this.wrapper.__model=this,this.value=this.wrapper.get();break}}}},r.prototype.animate=function(t,e,n,i){var r=this;this.ticker&&this.ticker.stop();var o=void 0,s=new is(function(t){return o=t});return this.ticker=new Ms({duration:n.duration,easing:n.easing,step:function(t){var e=i(t);r.applyValue(e),n.step&&n.step(t,e)},complete:function(){r.applyValue(e),n.complete&&n.complete(e),r.ticker=null,o()}}),s.stop=this.ticker.stop,s},r.prototype.applyValue=function(t){if(!E(t,this.value)){if(this.registerChange(this.getKeypath(),t),this.parent.wrapper&&this.parent.wrapper.set)this.parent.wrapper.set(this.key,t),this.parent.value=this.parent.wrapper.get(),this.value=this.parent.value[this.key],this.wrapper&&(this.newWrapperValue=this.value),this.adapt();else if(this.wrapper)this.newWrapperValue=t,this.adapt();else{var e=this.parent.value||this.parent.createBranch(this.key);e[this.key]=t,this.value=t,this.adapt()}this.parent.clearUnresolveds(),this.clearUnresolveds(),x(t)?(this.length=t.length,this.isArray=!0):this.isArray=!1,this.links.forEach(Rt),this.children.forEach(Dt),this.deps.forEach(Rt),this.notifyUpstream(),this.parent.isArray&&("length"===this.key?this.parent.length=t:this.parent.joinKey("length").mark())}},r.prototype.createBranch=function(t){var e=_(t)?[]:{};return this.set(e),e},r.prototype.get=function(t,e){return this._link?this._link.get(t,e):(t&&Lt(this),e&&e.virtual?this.getVirtual(!1):(t||e&&e.unwrap)&&this.wrapper?this.wrapperValue:this.value)},r.prototype.getKeypathModel=function(t){return this.keypathModel||(this.keypathModel=new Es(this)),this.keypathModel},r.prototype.joinKey=function(t,e){if(this._link)return!e||!e.lastLink!=!1||void 0!==t&&""!==t?this._link.joinKey(t):this;if(void 0===t||""===t)return this;if(!this.childByKey.hasOwnProperty(t)){var n=new r(this,t);this.children.push(n),this.childByKey[t]=n}return this.childByKey[t]._link?this.childByKey[t]._link:this.childByKey[t]},r.prototype.mark=function(){if(this._link)return this._link.mark();var t=this.retrieve();if(!E(t,this.value)){var e=this.value;this.value=t,(e!==t||this.rewrap)&&(this.wrapper&&(this.newWrapperValue=t),this.adapt()),x(t)?(this.length=t.length,this.isArray=!0):this.isArray=!1,this.children.forEach(Dt),this.links.forEach(Ut),this.deps.forEach(Rt),this.clearUnresolveds()}},r.prototype.merge=function(t,e){var n=this.value,i=t;n===i&&(n=oe(this)),e&&(n=n.map(e),i=i.map(e));var r=n.length,o={},s=0,a=n.map(function(t){var e=void 0,n=s;do{if(e=i.indexOf(t,n),e===-1)return-1;n=e+1}while(o[e]===!0&&n<r);return e===s&&(s+=1),o[e]=!0,e});this.parent.value[this.key]=t,this.shuffle(a)},r.prototype.retrieve=function(){return this.parent.value?this.parent.value[this.key]:void 0},r.prototype.set=function(t){this.ticker&&this.ticker.stop(),this.applyValue(t)},r.prototype.shuffle=function(t){this.shuffling=!0;for(var e=t.length;e--;){var n=t[e];e!==n&&(e in this.childByKey&&this.childByKey[e].rebinding(~n?this.joinKey(n):void 0,this.childByKey[e],!0),!~n&&this.keyModels[e]?this.keyModels[e].rebinding(void 0,this.keyModels[e],!1):~n&&this.keyModels[e]&&(this.keyModels[n]||this.childByKey[n].getKeyModel(n),this.keyModels[e].rebinding(this.keyModels[n],this.keyModels[e],!1)))}var i=this.length!==this.value.length;for(this.links.forEach(function(e){return e.shuffle(t)}),te("early"),e=this.deps.length;e--;)this.deps[e].shuffle&&this.deps[e].shuffle(t);this.mark(),te("mark"),i&&this.notifyUpstream(),this.shuffling=!1},r.prototype.teardown=function(){this._link&&this._link.teardown(),this.children.forEach(Ht),this.wrapper&&this.wrapper.teardown(),this.keypathModel&&this.keypathModel.teardown()},r}(Ss),Ls=function(i){function r(){n(this,r);var e=t(this,i.call(this,null,"@global"));return e.value="undefined"!=typeof global?global:window,e.isRoot=!0,e.root=e,e.adaptors=[],e}return e(r,i),r.prototype.getKeypath=function(){return"@global"},r.prototype.registerChange=function(){},r}(Is),Vs=new Ls,Ks=/^@[^\(]+\(([^\)]+)\)/,Rs=Array.prototype,Ds=function(t){function e(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return n(this.viewmodel.joinAll(nt(t)),i)}function n(e,n){var i=this,r=e.get();if(!x(r)){if(void 0!==r)throw new Error("shuffle array method "+t+" called on non-array at "+e.getKeypath());var o=function(){r=[];var o=Rs[t].apply(r,n),s=as.start(i,!0).then(function(){return o});return e.set(r),as.end(),{v:s}}();if("object"==typeof o)return o.v}var s=he(r.length,t,n),a=Rs[t].apply(r,n),u=as.start(this,!0).then(function(){return a});return u.result=a,s?e.shuffle(s):e.set(a),as.end(),u}return{path:e,model:n}},Us={},qs=new Xo("update"),zs=Ds("push").model,Hs=Ds("pop").model,Ws=Ds("shift").model,Qs=Ds("unshift").model,$s=Ds("sort").model,Gs=Ds("splice").model,Ys=Ds("reverse").model,Js=fo&&fo.querySelector,Zs=function(t){if("string"==typeof t&&Js&&(t=Js.call(document,t)),!t||!t._ractive)return{};var e=t._ractive;return Qe({},e.proxy)},Xs=new Xo("insert"),ta=function(){function t(e,i,r){for(n(this,t),this.fragment=e,this.reference=et(i),this.callback=r,this.keys=nt(i),this.resolved=!1,this.contexts=[];e;)e.context&&(e.context.addUnresolved(this.keys[0],this),this.contexts.push(e.context)),e=e.componentParent||e.parent}return t.prototype.attemptResolution=function(){if(!this.resolved){var t=Mt(this.fragment,this.reference);t&&(this.resolved=!0,this.callback(t))}},t.prototype.forceResolution=function(){if(!this.resolved){var t=this.fragment.findContext().joinAll(this.keys);this.callback(t),this.resolved=!0}},t.prototype.rebinding=function(t,e){var n=this;e&&e.removeUnresolved(this.keys[0],this),t&&as.scheduleTask(function(){return t.addUnresolved(n.keys[0],n)})},t.prototype.unbind=function(){var t=this;this.fragment&&U(this.fragment.unresolved,this),this.resolved||this.contexts.forEach(function(e){return e.removeUnresolved(t.keys[0],t)})},t}(),ea=function(){function t(e,i,r,o){var s=this;n(this,t),this.context=o.context||e,this.callback=r,this.ractive=e,i?this.resolved(i):(this.keypath=o.keypath,this.resolver=new ta(e.fragment,o.keypath,function(t){s.resolved(t)})),o.init!==!1?(this.dirty=!0,this.dispatch()):this.oldValue=this.newValue,this.defer=o.defer,this.once=o.once,this.strict=o.strict,this.dirty=!1}return t.prototype.cancel=function(){this.cancelled=!0,this.model?this.model.unregister(this):this.resolver.unbind()},t.prototype.dispatch=function(){this.cancelled||(this.callback.call(this.context,this.newValue,this.oldValue,this.keypath),this.oldValue=this.model?this.model.get():this.newValue,this.dirty=!1)},t.prototype.handleChange=function(){var t=this;if(!this.dirty){var e=this.model.get();if(E(e,this.oldValue))return;if(this.newValue=e,this.strict&&this.newValue===this.oldValue)return;as.addObserver(this,this.defer),this.dirty=!0,this.once&&as.scheduleTask(function(){return t.cancel()})}},t.prototype.rebinding=function(t,e){var n=this;return t=ee(this.keypath,t,e),t!==this.model&&(this.model&&this.model.unregister(this),void(t&&t.addShuffleTask(function(){return n.resolved(t)})))},t.prototype.resolved=function(t){this.model=t,this.keypath=t.getKeypath(this.ractive),this.oldValue=void 0,this.newValue=t.get(),t.register(this)},t}(),na=function(){function t(e,i,r,o,s){var a=this;n(this,t),this.context=s.context||e,this.ractive=e,this.baseModel=i,this.keys=r,this.callback=o;var u=r.join("\\.").replace(/\*/g,"(.+)"),h=i.getKeypath(e);this.pattern=new RegExp("^"+(h?h+"\\.":"")+u+"$"),this.oldValues={},this.newValues={},this.defer=s.defer,this.once=s.once,this.strict=s.strict,this.dirty=!1,this.changed=[],this.partial=!1;var l=i.findMatches(this.keys);l.forEach(function(t){a.newValues[t.getKeypath(a.ractive)]=t.get()}),s.init!==!1?this.dispatch():this.oldValues=this.newValues,i.registerPatternObserver(this)}return t.prototype.cancel=function(){this.baseModel.unregisterPatternObserver(this)},t.prototype.dispatch=function(){var t=this,e=this.newValues;if(this.newValues={},Object.keys(e).forEach(function(n){if(!t.newKeys||t.newKeys[n]){var i=e[n],r=t.oldValues[n];
if(!(t.strict&&i===r||E(i,r))){var o=[i,r,n];if(n){var s=t.pattern.exec(n);s&&(o=o.concat(s.slice(1)))}t.callback.apply(t.context,o)}}}),this.partial)for(var n in e)this.oldValues[n]=e[n];else this.oldValues=e;this.newKeys=null,this.dirty=!1},t.prototype.notify=function(t){this.changed.push(t)},t.prototype.shuffle=function(t){if(x(this.baseModel.value)){var e=this.baseModel.getKeypath(this.ractive),n=this.baseModel.value.length,i=this.keys.length>1?"."+this.keys.slice(1).join("."):"";this.newKeys={};for(var r=0;r<t.length;r++)t[r]!==-1&&t[r]!==r&&(this.newKeys[e+"."+r+i]=!0);for(var o=t.touchedFrom;o<n;o++)this.newKeys[e+"."+o+i]=!0}},t.prototype.handleChange=function(){var t=this;if(!this.dirty||this.changed.length){if(this.dirty||(this.newValues={}),this.changed.length){var e=function(){var e=0,n=t.baseModel.isRoot?t.changed.map(function(t){return t.map(tt).join(".")}):t.changed.map(function(e){return t.baseModel.getKeypath(t.ractive)+"."+e.map(tt).join(".")});return t.baseModel.findMatches(t.keys).forEach(function(i){var r=i.getKeypath(t.ractive),o=function(t){return 0===t.indexOf(r)&&(t.length===r.length||"."===t[r.length])||0===r.indexOf(t)&&(t.length===r.length||"."===r[t.length])};n.filter(o).length&&(e++,t.newValues[r]=i.get())}),e?void(t.partial=!0):{v:void 0}}();if("object"==typeof e)return e.v}else this.baseModel.findMatches(this.keys).forEach(function(e){var n=e.getKeypath(t.ractive);t.newValues[n]=e.get()}),this.partial=!1;as.addObserver(this,this.defer),this.dirty=!0,this.changed.length=0,this.once&&this.cancel()}},t}(),ia=function(){function t(e,i,r,o){n(this,t),this.context=e,this.model=i,this.keypath=i.getKeypath(),this.callback=r,this.pending=null,i.register(this),o.init!==!1?(this.sliced=[],this.shuffle([]),this.handleChange()):this.sliced=this.slice()}return t.prototype.handleChange=function(){this.pending?(this.callback(this.pending),this.pending=null):(this.shuffle(this.sliced.map(en)),this.handleChange())},t.prototype.shuffle=function(t){var e=this,n=this.slice(),i=[],r=[],o=void 0,s={};t.forEach(function(t,n){s[t]=!0,t!==n&&void 0===o&&(o=n),t===-1&&r.push(e.sliced[n])}),void 0===o&&(o=t.length);for(var a=n.length,u=0;u<a;u+=1)s[u]||i.push(n[u]);this.pending={inserted:i,deleted:r,start:o},this.sliced=n},t.prototype.slice=function(){var t=this.model.get();return x(t)?t.slice():[]},t}(),ra={init:!1,once:!0},oa=function(t){return t.trim()},sa=function(t){return""!==t},aa=Ds("pop").path,ua=Ds("push").path,ha="/* Ractive.js component styles */",la=[],ca=!1,pa=null,fa=null;!fo||pa&&pa.parentNode||(pa=fo.createElement("style"),pa.type="text/css",fo.getElementsByTagName("head")[0].appendChild(pa),fa=!!pa.styleSheet);var da=new Xo("render"),ma=new Xo("complete"),va={extend:function(t,e,n){e.adapt=pn(e.adapt,R(n.adapt))},init:function(){}},ga=/(?:^|\})?\s*([^\{\}]+)\s*\{/g,ya=/\/\*[\s\S]*?\*\//g,ba=/((?:(?:\[[^\]+]\])|(?:[^\s\+\>~:]))+)((?:::?[^\s\+\>\~\(:]+(?:\([^\)]+\))?)*\s*[\s\+\>\~]?)\s*/g,wa=/^(?:@|\d+%)/,ka=/\[data-ractive-css~="\{[a-z0-9-]+\}"]/g,xa={name:"css",extend:function(t,e,n){if(n.css){var i=yn(),r=n.noCssTransform?n.css:vn(n.css,i);e.cssId=i,an({id:i,styles:r})}},init:function(t,e,n){n.css&&F("\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t")}},Ea={name:"data",extend:function(t,e,n){var i=void 0,r=void 0;if(n.data&&A(n.data))for(i in n.data)r=n.data[i],r&&"object"==typeof r&&(A(r)||x(r))&&F("Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }");e.data=wn(e.data,n.data)},init:function(t,e,n){var i=wn(t.prototype.data,n.data);if("function"==typeof i&&(i=i.call(e)),i&&i.constructor===Object)for(var r in i)"function"==typeof i[r]&&(i[r]=rt(i[r],e));return i||{}},reset:function(t){var e=this.init(t.constructor,t,t.viewmodel);return t.viewmodel.root.set(e),!0}},_a=4,Aa=/\$\{([^\}]+)\}/g,Ca=Io(null),Sa=null,Oa=["delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","interpolate","preserveWhitespace","sanitize","stripComments","contextLines"],Ta="Either preparse or use a ractive runtime source that includes the parser. ",Na="Either use:\n\n\tRactive.parse.computedStrings( component.computed )\n\nat build time to pre-convert the strings to functions, or use functions instead of strings in computed properties.",Fa={fromId:function(t,e){if(!fo){if(e&&e.noThrow)return;throw new Error("Cannot retrieve template #"+t+" as Ractive is not running in a browser.")}t&&(t=t.replace(/^#/,""));var n=void 0;if(!(n=fo.getElementById(t))){if(e&&e.noThrow)return;throw new Error("Could not find template element with id #"+t)}if("SCRIPT"!==n.tagName.toUpperCase()){if(e&&e.noThrow)return;throw new Error("Template element with id #"+t+", must be a <script> element")}return"textContent"in n?n.textContent:n.innerHTML},isParsed:function(t){return!("string"==typeof t)},getParseOptions:function(t){return t.defaults&&(t=t.defaults),Oa.reduce(function(e,n){return e[n]=t[n],e},{})},parse:function(t,e){Sn(Sa,"template",Ta);var n=Sa(t,e);return Cn(n),n},parseFor:function(t,e){return this.parse(t,this.getParseOptions(e))}},ja={name:"template",extend:function(t,e,n){if("template"in n){var i=n.template;"function"==typeof i?e.template=i:e.template=jn(i,e)}},init:function(t,e,n){var i="template"in n?n.template:t.prototype.template;if(i=i||{v:_a,t:[]},"function"==typeof i){var r=i;i=Fn(e,r),e._config.template={fn:r,result:i}}i=jn(i,e),e.template=i.t,i.p&&Bn(e.partials,i.p)},reset:function(t){var e=Nn(t);if(e){var n=jn(e,t);return t.template=n.t,Bn(t.partials,n.p,!0),!0}}},Pa=["adaptors","components","computed","decorators","easing","events","interpolators","partials","transitions"],Ma=function(){function t(e,i){n(this,t),this.name=e,this.useDefaults=i}return t.prototype.extend=function(t,e,n){this.configure(this.useDefaults?t.defaults:t,this.useDefaults?e:e.constructor,n)},t.prototype.init=function(){},t.prototype.configure=function(t,e,n){var i=this.name,r=n[i],o=Io(t[i]);for(var s in r)o[s]=r[s];e[i]=o},t.prototype.reset=function(t){var e=t[this.name],n=!1;return Object.keys(e).forEach(function(t){var i=e[t];i._fn&&(i._fn.isOwner?e[t]=i._fn:delete e[t],n=!0)}),n},t}(),Ba=Pa.map(function(t){return new Ma(t,"computed"===t)}),Ia={adapt:va,css:xa,data:Ea,template:ja},La=Object.keys(ho),Va=qn(La.filter(function(t){return!Ia[t]})),Ka=qn(La.concat(Ba.map(function(t){return t.name}))),Ra=[].concat(La.filter(function(t){return!Ba[t]&&!Ia[t]}),Ba,Ia.template,Ia.css),Da={extend:function(t,e,n){return Dn("extend",t,e,n)},init:function(t,e,n){return Dn("init",t,e,n)},reset:function(t){return Ra.filter(function(e){return e.reset&&e.reset(t)}).map(function(t){return t.name})},order:Ra},Ua=["template","partials","components","decorators","events"],qa=new Xo("complete"),za=new Xo("reset"),Ha=new Xo("render"),Wa=new Xo("unrender"),Qa=1,$a=2,Ga=3,Ya=4,Ja=7,Za=8,Xa=13,tu=15,eu=16,nu=18,iu=19,ru=20,ou=21,su=30,au=50,uu=51,hu=52,lu=53,cu=54,pu=70,fu=71,du=72,mu=73,vu=function(t,e){var n=[];Hn(this.fragment.items,t,!1,n);var i=as.start(this,!0);return this.partials[t]=e,n.forEach(Wn),as.end(),i},gu=function(){function t(e){n(this,t),this.parentFragment=e.parentFragment,this.ractive=e.parentFragment.ractive,this.template=e.template,this.index=e.index,this.type=e.template.t,this.dirty=!1}return t.prototype.bubble=function(){this.dirty||(this.dirty=!0,this.parentFragment.bubble())},t.prototype.destroyed=function(){this.fragment&&this.fragment.destroyed()},t.prototype.find=function(){return null},t.prototype.findAll=function(){},t.prototype.findComponent=function(){return null},t.prototype.findAllComponents=function(){},t.prototype.findNextNode=function(){return this.parentFragment.findNextNode(this)},t.prototype.shuffled=function(){this.fragment&&this.fragment.shuffled()},t.prototype.valueOf=function(){return this.toString()},t}(),yu=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.get=function(t){t&&Lt(this);var e=this.parent.get();return e?e[this.key]:void 0},r.prototype.handleChange=function(){this.dirty=!0,this.links.forEach(Ut),this.deps.forEach(Rt),this.children.forEach(Rt),this.clearUnresolveds()},r.prototype.joinKey=function(t){if(void 0===t||""===t)return this;if(!this.childByKey.hasOwnProperty(t)){var e=new r(this,t);this.children.push(e),this.childByKey[t]=e}return this.childByKey[t]},r}(Is),bu=function(i){function r(e,o){n(this,r);var s=t(this,i.call(this,e.ractive.viewmodel,null));return s.fragment=e,s.template=o,s.isReadonly=!0,s.dirty=!0,s.fn=An(o.s,o.r.length),s.resolvers=[],s.models=s.template.r.map(function(t,e){var n=se(s.fragment,t);return n||Qn(s,t,e),n}),s.dependencies=[],s.shuffle=void 0,s.bubble(),s}return e(r,i),r.prototype.bubble=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.registered&&delete this.root.expressions[this.keypath],this.keypath=void 0,t&&(this.dirty=!0,this.handleChange())},r.prototype.get=function(t){return t&&Lt(this),this.dirty&&(this.dirty=!1,this.value=this.getValue(),this.wrapper&&(this.newWrapperValue=this.value),this.adapt()),t&&this.wrapper?this.wrapperValue:this.value},r.prototype.getKeypath=function(){var t=this;return this.template?(this.keypath||(this.keypath="@"+this.template.s.replace(/_(\d+)/g,function(e,n){if(n>=t.models.length)return e;var i=t.models[n];return i?i.getKeypath():"@undefined"}),this.root.expressions[this.keypath]=this,this.registered=!0),this.keypath):"@undefined"},r.prototype.getValue=function(){var t=this;Bt();var e=void 0;try{var n=this.models.map(function(t){return t?t.get(!0):void 0});e=this.fn.apply(this.fragment.ractive,n)}catch(t){F("Failed to compute "+this.getKeypath()+": "+(t.message||t))}var i=It();return this.dependencies.filter(function(t){return!~i.indexOf(t)}).forEach(function(e){e.unregister(t),U(t.dependencies,e)}),i.filter(function(e){return!~t.dependencies.indexOf(e)}).forEach(function(e){e.register(t),t.dependencies.push(e)}),e},r.prototype.handleChange=function(){this.dirty=!0,this.links.forEach(Ut),this.deps.forEach(Rt),this.children.forEach(Rt),this.clearUnresolveds()},r.prototype.joinKey=function(t){if(void 0===t||""===t)return this;if(!this.childByKey.hasOwnProperty(t)){var e=new yu(this,t);this.children.push(e),this.childByKey[t]=e}return this.childByKey[t]},r.prototype.mark=function(){this.handleChange()},r.prototype.rebinding=function(t,e,n){var i=this.models.indexOf(e);~i&&(t=ee(this.template.r[i],t,e),t!==e&&(e.unregister(this),this.models.splice(i,1,t),t&&t.addShuffleRegister(this,"mark"))),this.bubble(!n)},r.prototype.retrieve=function(){return this.get()},r.prototype.teardown=function(){var t=this;this.unbind(),this.fragment=void 0,this.dependencies&&this.dependencies.forEach(function(e){return e.unregister(t)}),i.prototype.teardown.call(this)},r.prototype.unregister=function(t){i.prototype.unregister.call(this,t),this.deps.length||this.teardown()},r.prototype.unbind=function(){this.resolvers.forEach(Wt)},r}(Is),wu=function(i){function r(e,o){return n(this,r),t(this,i.call(this,e,o))}return e(r,i),r.prototype.applyValue=function(t){if(!E(t,this.value))for(var e=this.parent,n=[this.key];e;){if(e.base){var i=e.model.joinAll(n);i.applyValue(t);break}n.unshift(e.key),e=e.parent}},r.prototype.joinKey=function(t){if(void 0===t||""===t)return this;if(!this.childByKey.hasOwnProperty(t)){var e=new r(this,t);this.children.push(e),this.childByKey[t]=e}return this.childByKey[t]},r.prototype.retrieve=function(){var t=this.parent.get();return t&&t[this.key]},r}(Is),ku=function(i){function r(e,o){n(this,r);var s=t(this,i.call(this,null,null));s.dirty=!0,s.root=e.ractive.viewmodel,s.template=o,s.resolvers=[],s.base=$n(e,o);var a=void 0;s.base||(a=e.resolve(o.r,function(t){s.base=t,s.bubble(),U(s.resolvers,a)}),s.resolvers.push(a));var u=s.intermediary={handleChange:function(){return s.handleChange()},rebinding:function(t,e){if(e===s.base)t=ee(o,t,e),t!==s.base&&(s.base.unregister(u),s.base=t);else{var n=s.members.indexOf(e);~n&&(t=ee(o.m[n].n,t,e),t!==s.members[n]&&s.members.splice(n,1,t))}t!==e&&e.unregister(u),t&&t.addShuffleTask(function(){return t.register(u)}),s.bubble()}};return s.members=o.m.map(function(t,n){if("string"==typeof t)return{get:function(){return t}};var i=void 0,r=void 0;return t.t===su?(i=se(e,t.n),i?i.register(u):(r=e.resolve(t.n,function(t){s.members[n]=t,t.register(u),s.handleChange(),U(s.resolvers,r)}),s.resolvers.push(r)),i):(i=new bu(e,t),i.register(u),i)}),s.isUnresolved=!0,s.bubble(),s}return e(r,i),r.prototype.bubble=function(){this.base&&(this.dirty||this.handleChange())},r.prototype.forceResolution=function(){this.resolvers.forEach(function(t){return t.forceResolution()}),this.dirty=!0,this.bubble()},r.prototype.get=function(t){if(this.dirty){this.bubble();for(var e=this.members.length,n=!0;n&&e--;)this.members[e]||(n=!1);if(this.base&&n){var i=this.members.map(function(t){return tt(String(t.get()))}),r=this.base.joinAll(i);r!==this.model&&(this.model&&(this.model.unregister(this),this.model.unregisterTwowayBinding(this)),this.model=r,this.parent=r.parent,this.model.register(this),this.model.registerTwowayBinding(this),this.keypathModel&&this.keypathModel.handleChange())}return this.value=this.model?this.model.get(t):void 0,this.dirty=!1,this.mark(),this.value}return this.model?this.model.get(t):void 0},r.prototype.getValue=function(){this.value=this.model?this.model.get():void 0;for(var t=this.bindings.length;t--;){var e=this.bindings[t].getValue();if(e!==this.value)return e}var n=Xt(this.deps);return n?n.value:this.value},r.prototype.getKeypath=function(){return this.model?this.model.getKeypath():"@undefined"},r.prototype.handleChange=function(){this.dirty=!0,this.mark()},r.prototype.joinKey=function(t){if(void 0===t||""===t)return this;if(!this.childByKey.hasOwnProperty(t)){var e=new wu(this,t);this.children.push(e),this.childByKey[t]=e}return this.childByKey[t]},r.prototype.mark=function(){this.dirty&&this.deps.forEach(Rt),this.links.forEach(Ut),this.children.forEach(Dt),this.clearUnresolveds()},r.prototype.retrieve=function(){return this.value},r.prototype.rebinding=function(){},r.prototype.set=function(t){if(!this.model)throw new Error("Unresolved reference expression. This should not happen!");this.model.set(t)},r.prototype.unbind=function(){this.resolvers.forEach(Wt),this.model&&(this.model.unregister(this),this.model.unregisterTwowayBinding(this))},r}(Is),xu=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.fragment=null,o}return e(r,i),r.prototype.bind=function(){Gn(this),this.fragment=new $l({owner:this,template:this.template.f}).bind()},r.prototype.detach=function(){return this.fragment?this.fragment.detach():d()},r.prototype.find=function(t){if(this.fragment)return this.fragment.find(t)},r.prototype.findAll=function(t,e){this.fragment&&this.fragment.findAll(t,e)},r.prototype.findComponent=function(t){if(this.fragment)return this.fragment.findComponent(t)},r.prototype.findAllComponents=function(t,e){this.fragment&&this.fragment.findAllComponents(t,e)},r.prototype.firstNode=function(t){return this.fragment&&this.fragment.firstNode(t)},r.prototype.rebinding=function(){var t=this;this.locked||(this.locked=!0,as.scheduleTask(function(){t.locked=!1,Gn(t)}))},r.prototype.render=function(t){this.rendered=!0,this.fragment&&this.fragment.render(t)},r.prototype.toString=function(t){return this.fragment?this.fragment.toString(t):""},r.prototype.unbind=function(){this.aliases={},this.fragment&&this.fragment.unbind()},r.prototype.unrender=function(t){this.rendered&&this.fragment&&this.fragment.unrender(t),this.rendered=!1},r.prototype.update=function(){this.dirty&&(this.dirty=!1,this.fragment.update())},r}(gu),Eu=/\s+/,_u=/\/\*(?:[\s\S]*?)\*\//g,Au=/url\(\s*(['"])(?:\\[\s\S]|(?!\1).)*\1\s*\)|url\((?:\\[\s\S]|[^)])*\)|(['"])(?:\\[\s\S]|(?!\1).)*\2/gi,Cu=/\0(\d+)/g,Su=[void 0,"text","search","url","email","hidden","password","search","reset","submit"],Ou={"accept-charset":"acceptCharset",accesskey:"accessKey",bgcolor:"bgColor",class:"className",codebase:"codeBase",colspan:"colSpan",contenteditable:"contentEditable",datetime:"dateTime",dirname:"dirName",for:"htmlFor","http-equiv":"httpEquiv",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",pubdate:"pubDate",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"},Tu=/^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i,Nu=/^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i,Fu={quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},ju=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376],Pu=new RegExp("&(#?(?:x[\\w\\d]+|\\d+|"+Object.keys(Fu).join("|")+"));?","g"),Mu="function"==typeof String.fromCodePoint,Bu=Mu?String.fromCodePoint:String.fromCharCode,Iu=/</g,Lu=/>/g,Vu=/&/g,Ku=65533,Ru=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.name=e.template.n,o.namespace=null,o.owner=e.owner||e.parentFragment.owner||e.element||Yn(e.parentFragment),o.element=e.element||(o.owner.attributeByName?o.owner:Yn(e.parentFragment)),o.parentFragment=e.parentFragment,o.ractive=o.parentFragment.ractive,o.rendered=!1,o.updateDelegate=null,o.fragment=null,o.element.attributeByName[o.name]=o,x(e.template.f)?o.fragment=new $l({owner:o,template:e.template.f}):(o.value=e.template.f,0===o.value&&(o.value="")),o.interpolator=o.fragment&&1===o.fragment.items.length&&o.fragment.items[0].type===$a&&o.fragment.items[0],o.interpolator&&(o.interpolator.owner=o),o}return e(r,i),r.prototype.bind=function(){this.fragment&&this.fragment.bind()},r.prototype.bubble=function(){this.dirty||(this.parentFragment.bubble(),this.element.bubble(),this.dirty=!0)},r.prototype.destroyed=function(){this.updateDelegate(!0)},r.prototype.getString=function(){return this.fragment?this.fragment.toString():null!=this.value?""+this.value:""},r.prototype.getValue=function(){return this.fragment?this.fragment.valueOf():!!Tu.test(this.name)||this.value},r.prototype.render=function(){var t=this.element.node;if(this.node=t,t.namespaceURI&&t.namespaceURI!==Bo.html||(this.propertyName=Ou[this.name]||this.name,void 0!==t[this.propertyName]&&(this.useProperty=!0),(Tu.test(this.name)||this.isTwoway)&&(this.isBoolean=!0),"value"===this.propertyName&&(t._ractive.value=this.value)),t.namespaceURI){var e=this.name.indexOf(":");e!==-1?this.namespace=bi(t,this.name.slice(0,e)):this.namespace=t.namespaceURI}this.rendered=!0,this.updateDelegate=Xn(this),this.updateDelegate()},r.prototype.toString=function(){var t=this.getValue();if("value"!==this.name||void 0===this.element.getAttribute("contenteditable")&&"select"!==this.element.name&&"textarea"!==this.element.name){if("name"===this.name&&"input"===this.element.name&&this.interpolator&&"radio"===this.element.getAttribute("type"))return'name="{{'+this.interpolator.model.getKeypath()+'}}"';if(this.owner!==this.element||"style"!==this.name&&"class"!==this.name&&!this.style&&!this.inlineClass){if(!(this.rendered||this.owner!==this.element||this.name.indexOf("style-")&&this.name.indexOf("class-")))return void(this.name.indexOf("style-")?this.inlineClass=this.name.substr(6):this.style=b(this.name.substr(6)));if(Tu.test(this.name))return t?this.name:"";if(null==t)return"";var e=y(this.getString());return e?this.name+'="'+e+'"':this.name}}},r.prototype.unbind=function(){this.fragment&&this.fragment.unbind()},r.prototype.unrender=function(){this.updateDelegate(!0),this.rendered=!1},r.prototype.update=function(){this.dirty&&(this.dirty=!1,this.fragment&&this.fragment.update(),this.rendered&&this.updateDelegate(),this.isTwoway&&!this.locked&&this.interpolator.twowayBinding.lastVal(!0,this.interpolator.model.get()))},r}(gu),Du=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.owner=e.owner||e.parentFragment.owner||Yn(e.parentFragment),o.element=o.owner.attributeByName?o.owner:Yn(e.parentFragment),o.flag="l"===e.template.v?"lazy":"twoway",o.element.type===Ja&&(x(e.template.f)&&(o.fragment=new $l({owner:o,template:e.template.f})),o.interpolator=o.fragment&&1===o.fragment.items.length&&o.fragment.items[0].type===$a&&o.fragment.items[0]),o}return e(r,i),r.prototype.bind=function(){this.fragment&&this.fragment.bind(),wi(this,this.getValue(),!0)},r.prototype.bubble=function(){this.dirty||(this.element.bubble(),this.dirty=!0)},r.prototype.getValue=function(){return this.fragment?this.fragment.valueOf():"value"in this?this.value:!("f"in this.template)||this.template.f},r.prototype.render=function(){wi(this,this.getValue(),!0)},r.prototype.toString=function(){return""},r.prototype.unbind=function(){this.fragment&&this.fragment.unbind(),delete this.element[this.flag]},r.prototype.unrender=function(){this.element.rendered&&this.element.recreateTwowayBinding()},r.prototype.update=function(){this.dirty&&(this.fragment&&this.fragment.update(),wi(this,this.getValue(),!0))},r}(gu),Uu=fo?yo("div"):null,qu=!1,zu=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.attributes=[],o.owner=e.owner,o.fragment=new $l({ractive:o.ractive,owner:o,template:o.template}),o.fragment.findNextNode=Ho,o.dirty=!1,o}return e(r,i),r.prototype.bind=function(){this.fragment.bind()},r.prototype.bubble=function(){this.dirty||(this.dirty=!0,this.owner.bubble())},r.prototype.render=function(){this.node=this.owner.node,this.node&&(this.isSvg=this.node.namespaceURI===Fo),qu=!0,this.rendered||this.fragment.render(),qu=!1,this.rendered=!0,this.dirty=!0,this.update()},r.prototype.toString=function(){return this.fragment.toString()},r.prototype.unbind=function(){this.fragment.unbind()},r.prototype.unrender=function(){this.rendered=!1,this.fragment.unrender()},r.prototype.update=function(){var t=this,e=void 0,n=void 0;this.dirty&&(this.dirty=!1,qu=!0,this.fragment.update(),qu=!1,this.rendered&&this.node&&(e=this.fragment.toString(),n=Ei(e,this.isSvg),this.attributes.filter(function(t){return _i(n,t)}).forEach(function(e){t.node.removeAttribute(e.name)}),n.forEach(function(e){t.node.setAttribute(e.name,e.value)}),this.attributes=n))},r}(gu),Hu=function(t,e,n,i){var r=t.__model;i&&r.shuffle(i)},Wu=["pop","push","reverse","shift","sort","splice","unshift"],Qu=[];Wu.forEach(function(t){var e=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=he(this.length,t,n);this._ractive.wrappers.forEach(function(t){t.magic&&(t.magic.locked=!0)});var o=Array.prototype[t].apply(this,arguments);as.start(),this._ractive.setting=!0;for(var s=this._ractive.wrappers.length;s--;)Hu(this._ractive.wrappers[s],this,t,r);return as.end(),this._ractive.setting=!1,this._ractive.wrappers.forEach(function(t){t.magic&&(t.magic.locked=!1)}),o};Lo(Qu,t,{value:e,configurable:!0})});var $u=void 0,Gu=void 0;({}).__proto__?($u=function(t){return t.__proto__=Qu},Gu=function(t){return t.__proto__=Array.prototype}):($u=function(t){for(var e=Wu.length;e--;){var n=Wu[e];Lo(t,n,{value:Qu[n],configurable:!0})}},Gu=function(t){for(var e=Wu.length;e--;)delete t[Wu[e]]}),$u.unpatch=Gu;var Yu=$u,Ju="Something went wrong in a rather interesting way",Zu={filter:function(t){return x(t)&&(!t._ractive||!t._ractive.setting)},wrap:function(t,e,n){return new Xu(t,e,n)}},Xu=function(){function t(e,i){n(this,t),this.root=e,this.value=i,this.__model=null,i._ractive||(Lo(i,"_ractive",{value:{wrappers:[],instances:[],setting:!1},configurable:!0}),Yu(i)),i._ractive.instances[e._guid]||(i._ractive.instances[e._guid]=0,i._ractive.instances.push(e)),i._ractive.instances[e._guid]+=1,i._ractive.wrappers.push(this)}return t.prototype.get=function(){return this.value},t.prototype.reset=function(t){return this.value===t},t.prototype.teardown=function(){var t,e,n,i,r;if(t=this.value,e=t._ractive,n=e.wrappers,i=e.instances,e.setting)return!1;if(r=n.indexOf(this),r===-1)throw new Error(Ju);if(n.splice(r,1),n.length){if(i[this.root._guid]-=1,!i[this.root._guid]){if(r=i.indexOf(this.root),r===-1)throw new Error(Ju);i.splice(r,1)}}else delete t._ractive,Yu.unpatch(this.value)},t}(),th=void 0;try{Object.defineProperty({},"test",{get:function(){},set:function(){}}),th={filter:function(t){return t&&"object"==typeof t},wrap:function(t,e,n){return new rh(t,e,n)}}}catch(t){th=!1}var eh,nh,ih=th,rh=function(){function t(e,i,r){var o=this;n(this,t),this.ractive=e,this.value=i,this.keypath=r,this.originalDescriptors={},Object.keys(i).forEach(function(t){var n=Object.getOwnPropertyDescriptor(o.value,t);o.originalDescriptors[t]=n;var i=r?r+"."+tt(t):tt(t),s=Ai(n,e,i,o);Object.defineProperty(o.value,t,s)})}return t.prototype.get=function(){return this.value},t.prototype.reset=function(t){return this.value===t},t.prototype.set=function(t,e){this.value[t]=e},t.prototype.teardown=function(){var t=this;Object.keys(this.value).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t.value,e);n.set&&n.set.__magic&&(Ci(n),1===n.set.__magic.dependants.length&&Object.defineProperty(t.value,e,n.set.__magic.originalDescriptor))})},t}(),oh=function(){function t(e,i,r){n(this,t),this.value=i,this.magic=!0,this.magicWrapper=ih.wrap(e,i,r),this.arrayWrapper=Zu.wrap(e,i,r),this.arrayWrapper.magic=this.magicWrapper,Object.defineProperty(this,"__model",{get:function(){return this.arrayWrapper.__model},set:function(t){this.arrayWrapper.__model=t}})}return t.prototype.get=function(){return this.value},t.prototype.teardown=function(){this.arrayWrapper.teardown(),this.magicWrapper.teardown()},t.prototype.reset=function(t){return this.arrayWrapper.reset(t)&&this.magicWrapper.reset(t)},t}(),sh={filter:function(t,e,n){return ih.filter(t,e,n)&&Zu.filter(t)},wrap:function(t,e,n){return new oh(t,e,n)}},ah=function(i){function r(e,o,s){n(this,r);var a=t(this,i.call(this,null,null));return a.root=a.parent=e,a.signature=o,a.key=s,a.isExpression=s&&"@"===s[0],a.isReadonly=!a.signature.setter,a.context=e.computationContext,a.dependencies=[],a.children=[],a.childByKey={},a.deps=[],a.dirty=!0,a.shuffle=void 0,a}return e(r,i),r.prototype.get=function(t){return t&&Lt(this),this.dirty&&(this.dirty=!1,this.value=this.getValue(),this.wrapper&&(this.newWrapperValue=this.value),this.adapt()),t&&this.wrapper?this.wrapperValue:this.value},r.prototype.getValue=function(){Bt();var t=void 0;try{t=this.signature.getter.call(this.context)}catch(t){if(F("Failed to compute "+this.getKeypath()+": "+(t.message||t)),vo){console.groupCollapsed&&console.groupCollapsed("%cshow details","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;");var e=Si(this.signature.getterString),n=this.signature.getterUseStack?"\n\n"+Oi(t.stack):"";console.error(t.name+": "+t.message+"\n\n"+e+n),console.groupCollapsed&&console.groupEnd()}}var i=It();return this.setDependencies(i),"value"in this&&t!==this.value&&this.registerChange(this.getKeypath(),t),t},r.prototype.handleChange=function(){this.dirty=!0,this.links.forEach(Ut),this.deps.forEach(Rt),this.children.forEach(Rt),this.clearUnresolveds()},r.prototype.joinKey=function(t){if(void 0===t||""===t)return this;if(!this.childByKey.hasOwnProperty(t)){var e=new yu(this,t);this.children.push(e),this.childByKey[t]=e}return this.childByKey[t]},r.prototype.mark=function(){this.handleChange()},r.prototype.rebinding=function(t,e){t!==e&&this.handleChange()},r.prototype.set=function(t){if(!this.signature.setter)throw new Error("Cannot set read-only computed value '"+this.key+"'");this.signature.setter(t),this.mark()},r.prototype.setDependencies=function(t){for(var e=this.dependencies.length;e--;){var n=this.dependencies[e];~t.indexOf(n)||n.unregister(this)}for(e=t.length;e--;){var i=t[e];~this.dependencies.indexOf(i)||i.register(this)}this.dependencies=t},r.prototype.teardown=function(){for(var t=this.dependencies.length;t--;)this.dependencies[t]&&this.dependencies[t].unregister(this);this.root.computations[this.key]===this&&delete this.root.computations[this.key],i.prototype.teardown.call(this)},r.prototype.unregister=function(t){i.prototype.unregister.call(this,t),this.isExpression&&0===this.deps.length&&this.teardown()},r}(Is),uh=function(i){function r(e){n(this,r);var o=t(this,i.call(this,null,""));return o.value=e,o.isRoot=!0,o.root=o,o.adaptors=[],o.ractive=e,o.changes={},o}return e(r,i),r.prototype.getKeypath=function(){return"@this"},r}(Is),hh=Object.prototype.hasOwnProperty,lh=function(i){function r(e){n(this,r);var o=t(this,i.call(this,null,null));return o.changes={},o.isRoot=!0,o.root=o,o.ractive=e.ractive,o.value=e.data,o.adaptors=e.adapt,o.adapt(),o.computationContext=e.ractive,o.computations={},o.expressions={},o}return e(r,i),r.prototype.applyChanges=function(){return this._changeHash={},this.flush(),this._changeHash},r.prototype.compute=function(t,e){
var n=new ah(this,e,t);return this.computations[tt(t)]=n,n},r.prototype.createLink=function(t,e,n){for(var i=nt(t),r=this;i.length;){var o=i.shift();r=this.childByKey[o]||this.joinKey(o)}return r.link(e,n)},r.prototype.get=function(t,e){if(t&&Lt(this),e&&e.virtual===!1)return this.value;for(var n=this.getVirtual(),i=Object.keys(this.computations),r=i.length;r--;){var o=this.computations[i[r]];o.isExpression||(n[i[r]]=o.get())}return n},r.prototype.getKeypath=function(){return""},r.prototype.getRactiveModel=function(){return this.ractiveModel||(this.ractiveModel=new uh(this.ractive))},r.prototype.getValueChildren=function(){var t=i.prototype.getValueChildren.call(this,this.value);this.children.forEach(function(e){if(e._link){var n=t.indexOf(e);~n?t.splice(n,1,e._link):t.push(e._link)}});for(var e in this.computations)t.push(this.computations[e]);return t},r.prototype.handleChange=function(){this.deps.forEach(Rt)},r.prototype.has=function(t){var e=this.value,n=it(t);if(hh.call(e,n))return!0;if(t in this.computations||this.childByKey[n]&&this.childByKey[n]._link)return!0;if(t in this.expressions)return!0;for(var i=e.constructor;i!==Function&&i!==Array&&i!==Object;){if(hh.call(i.prototype,n))return!0;i=i.constructor}return!1},r.prototype.joinKey=function(t,e){return"@global"===t?Vs:"@this"===t?this.getRactiveModel():this.expressions.hasOwnProperty(t)?(F("Accessing expression keypaths ("+t.substr(1)+") from the instance is deprecated. You can used a getNodeInfo or event object to access keypaths with expression context."),this.expressions[t]):this.computations.hasOwnProperty(t)?this.computations[t]:i.prototype.joinKey.call(this,t,e)},r.prototype.map=function(t,e){var n=this.joinKey(t);n.link(e)},r.prototype.rebinding=function(){},r.prototype.set=function(t){var e=this.wrapper;if(e){var n=!e.reset||e.reset(t)===!1;n&&(e.teardown(),this.wrapper=null,this.value=t,this.adapt())}else this.value=t,this.adapt();this.deps.forEach(Rt),this.children.forEach(Dt),this.clearUnresolveds()},r.prototype.retrieve=function(){return this.wrapper?this.wrapper.get():this.value},r.prototype.update=function(){},r}(Is),ch=new Xo("construct"),ph=["adaptors","components","decorators","easing","events","interpolators","partials","transitions"],fh=0,dh=function(){function t(e){n(this,t),this.hook=new Xo(e),this.inProcess={},this.queue={}}return t.prototype.begin=function(t){this.inProcess[t._guid]=!0},t.prototype.end=function(t){var e=t.parent;e&&this.inProcess[e._guid]?Bi(this.queue,e).push(t):Ii(this,t),delete this.inProcess[t._guid]},t}(),mh=new Xo("config"),vh=new dh("init"),gh=function(){function t(e,i){n(this,t),e.indexOf("*")!==-1&&S('Only component proxy-events may contain "*" wildcards, <'+i.name+" on-"+e+'="..."/> is not valid'),this.name=e,this.owner=i,this.node=null,this.handler=null}return t.prototype.listen=function(t){var e=this.node=this.owner.node,n=this.name;"on"+n in e||N(Yo(n,"events")),e.addEventListener(n,this.handler=function(n){t.fire({node:e,original:n})},!1)},t.prototype.unlisten=function(){this.handler&&this.node.removeEventListener(this.name,this.handler,!1)},t}(),yh=function(){function t(e,i){n(this,t),this.eventPlugin=e,this.owner=i,this.handler=null}return t.prototype.listen=function(t){var e=this.owner.node;this.handler=this.eventPlugin(e,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.node=n.node||e,t.fire(n)})},t.prototype.unlisten=function(){this.handler.teardown()},t}(),bh=function(){function t(e,i){n(this,t),this.ractive=e,this.name=i,this.handler=null}return t.prototype.listen=function(t){var e=this.ractive;this.handler=e.on(this.name,function(){var n=void 0;arguments.length&&arguments[0]&&arguments[0].node&&(n=Array.prototype.shift.call(arguments),n.component=e);var i=Array.prototype.slice.call(arguments);return t.fire(n,i),!1})},t.prototype.unlisten=function(){this.handler.cancel()},t}(),wh=/^(event|arguments)(\..+)?$/,kh=/^\$(\d+)(\..+)?$/,xh=function(){function t(e){var i=this;n(this,t),this.owner=e.owner||e.parentFragment.owner||Yn(e.parentFragment),this.element=this.owner.attributeByName?this.owner:Yn(e.parentFragment),this.template=e.template,this.parentFragment=e.parentFragment,this.ractive=e.parentFragment.ractive,this.events=[],this.element.type===tu?this.template.n.split("-").forEach(function(t){i.events.push(new bh(i.element.instance,t))}):this.template.n.split("-").forEach(function(t){var e=P("events",i.ractive,t);i.events.push(e?new yh(e,i.element):new gh(t,i.element))}),this.context=null,this.resolvers=null,this.models=null,this.action=null,this.args=null}return t.prototype.bind=function(){var t=this;this.context=this.parentFragment.findContext();var e=this.template.f;e.x?(this.fn=An(e.x.s,e.x.r.length),this.resolvers=[],this.models=e.x.r.map(function(e,n){var i=wh.exec(e);if(i)return{special:i[1],keys:i[2]?nt(i[2].substr(1)):[]};var r=kh.exec(e);if(r)return{special:"arguments",keys:[r[1]-1].concat(r[2]?nt(r[2].substr(1)):[])};var o=void 0,s=se(t.parentFragment,e);return s?s.register(t):(o=t.parentFragment.resolve(e,function(e){t.models[n]=e,U(t.resolvers,o),e.register(t)}),t.resolvers.push(o)),s})):(this.action="string"==typeof e?e:"string"==typeof e.n?e.n:new $l({owner:this,template:e.n}),this.args=e.a?"string"==typeof e.a?[e.a]:e.a:e.d?new $l({owner:this,template:e.d}):[]),this.action&&"string"!=typeof this.action&&this.action.bind(),this.args&&e.d&&this.args.bind()},t.prototype.bubble=function(){this.dirty||(this.dirty=!0,this.owner.bubble())},t.prototype.destroyed=function(){this.events.forEach(function(t){return t.unlisten()})},t.prototype.fire=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t&&!t.hasOwnProperty("_element")&&Qe(t,this.owner),this.fn)!function(){var i=[];t&&n.unshift(t),e.models&&e.models.forEach(function(e){if(!e)return i.push(void 0);if(e.special){for(var r="event"===e.special?t:n,o=e.keys.slice();o.length;)r=r[o.shift()];return i.push(r)}return e.wrapper?i.push(e.wrapperValue):void i.push(e.get())});var r=e.ractive,o=r.event;r.event=t;var s=e.fn.apply(r,i).pop();if(s===!1){var a=t?t.original:void 0;a?(a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()):j("handler '"+e.template.n+"' returned false, but there is no event available to cancel")}r.event=o}();else{var i=this.action.toString(),r=this.template.f.d?this.args.getArgsList():this.args;n.length&&(r=r.concat(n)),t&&(t.name=i),Ot(this.ractive,i,{event:t,args:r})}},t.prototype.handleChange=function(){},t.prototype.rebinding=function(t,e){var n=this;if(this.models){var i=this.models.indexOf(e);~i&&(this.models.splice(i,1,t),e.unregister(this),t&&t.addShuffleTask(function(){return t.register(n)}))}},t.prototype.render=function(){var t=this;as.scheduleTask(function(){return t.events.forEach(function(e){return e.listen(t)},!0)})},t.prototype.toString=function(){return""},t.prototype.unbind=function(){var t=this,e=this.template.f;e.m?(this.resolvers&&this.resolvers.forEach(Wt),this.resolvers=[],this.models&&this.models.forEach(function(e){e.unregister&&e.unregister(t)}),this.models=null):(this.action&&this.action.unbind&&this.action.unbind(),this.args&&this.args.unbind&&this.args.unbind())},t.prototype.unrender=function(){this.events.forEach(function(t){return t.unlisten()})},t.prototype.update=function(){!this.method&&this.dirty&&(this.dirty=!1,this.action&&this.action.update&&this.action.update(),this.args&&this.args.update&&this.args.update())},t}(),Eh=new Xo("teardown"),_h=function(i){function r(e,o){n(this,r);var s=t(this,i.call(this,e));s.type=tu;var a=Io(o.prototype);s.instance=a,s.name=e.template.e,s.parentFragment=e.parentFragment,s.liveQueries=[],a.el&&F("The <"+s.name+"> component has a default 'el' property; it has been disregarded");var u=e.template.p||{};"content"in u||(u.content=e.template.f||[]),s._partials=u,s.yielders={};for(var h=e.parentFragment,l=void 0;h;){if(h.owner.type===eu){l=h.owner.container;break}h=h.parent}a.parent=s.parentFragment.ractive,a.container=l||null,a.root=a.parent.root,a.component=s,Ni(s.instance,{partials:u}),a._inlinePartials=u,s.attributeByName={},s.attributes=[];var c=[];return(s.template.m||[]).forEach(function(t){switch(t.t){case Xa:case pu:case du:s.attributes.push(Ar({owner:s,parentFragment:s.parentFragment,template:t}));break;case mu:case fu:break;default:c.push(t)}}),s.attributes.push(new zu({owner:s,parentFragment:s.parentFragment,template:c})),s.eventHandlers=[],s.template.v&&s.setupEvents(),s}return e(r,i),r.prototype.bind=function(){this.attributes.forEach(Vt),Li(this.instance,{partials:this._partials},{cssIds:this.parentFragment.cssIds}),this.eventHandlers.forEach(Vt),this.bound=!0},r.prototype.bubble=function(){this.dirty||(this.dirty=!0,this.parentFragment.bubble())},r.prototype.checkYielders=function(){var t=this;Object.keys(this.yielders).forEach(function(e){if(t.yielders[e].length>1)throw as.end(),new Error("A component template can only have one {{yield"+(e?" "+e:"")+"}} declaration at a time")})},r.prototype.destroyed=function(){this.instance.fragment&&this.instance.fragment.destroyed()},r.prototype.detach=function(){return this.instance.fragment.detach()},r.prototype.find=function(t){return this.instance.fragment.find(t)},r.prototype.findAll=function(t,e){this.instance.fragment.findAll(t,e)},r.prototype.findComponent=function(t){return t&&this.name!==t?this.instance.fragment?this.instance.fragment.findComponent(t):void 0:this.instance},r.prototype.findAllComponents=function(t,e){e.test(this)&&(e.add(this.instance),e.live&&this.liveQueries.push(e)),this.instance.fragment.findAllComponents(t,e)},r.prototype.firstNode=function(t){return this.instance.fragment.firstNode(t)},r.prototype.render=function(t,e){ln(this.instance,t,null,e),this.checkYielders(),this.attributes.forEach(zt),this.eventHandlers.forEach(zt),Vi(this),this.rendered=!0},r.prototype.setupEvents=function(){var t=this,e=this.eventHandlers;Object.keys(this.template.v).forEach(function(n){var i=n.split("-"),r=t.template.v[n];i.forEach(function(n){var i=new bh(t.instance,n);e.push(new xh(t,i,r))})})},r.prototype.shuffled=function(){this.liveQueries.forEach(Ri),i.prototype.shuffled.call(this)},r.prototype.toString=function(){return this.instance.toHTML()},r.prototype.unbind=function(){this.bound=!1,this.attributes.forEach(Wt);var t=this.instance;t.viewmodel.teardown(),t.fragment.unbind(),t._observers.forEach(Kt),Ki(this),t.fragment.rendered&&t.el.__ractive_instances__&&U(t.el.__ractive_instances__,t),Eh.fire(t)},r.prototype.unrender=function(t){var e=this;this.rendered=!1,this.shouldDestroy=t,this.instance.unrender(),this.attributes.forEach(Qt),this.eventHandlers.forEach(Qt),this.liveQueries.forEach(function(t){return t.remove(e.instance)})},r.prototype.update=function(){this.dirty=!1,this.instance.fragment.update(),this.checkYielders(),this.attributes.forEach(Gt),this.eventHandlers.forEach(Gt)},r}(gu),Ah={update:Ho,teardown:Ho},Ch=function(){function t(e){n(this,t),this.owner=e.owner||e.parentFragment.owner||Yn(e.parentFragment),this.element=this.owner.attributeByName?this.owner:Yn(e.parentFragment),this.parentFragment=this.owner.parentFragment,this.ractive=this.owner.ractive;var i=this.template=e.template;this.dynamicName="object"==typeof i.f.n,this.dynamicArgs=!!i.f.d,this.dynamicName?this.nameFragment=new $l({owner:this,template:i.f.n}):this.name=i.f.n||i.f,this.dynamicArgs?this.argsFragment=new $l({owner:this,template:i.f.d}):i.f.a&&i.f.a.s?this.args=[]:this.args=i.f.a||[],this.node=null,this.intermediary=null,this.element.decorators.push(this)}return t.prototype.bind=function(){var t=this;this.dynamicName&&(this.nameFragment.bind(),this.name=this.nameFragment.toString()),this.dynamicArgs&&this.argsFragment.bind(),this.template.f.a&&this.template.f.a.s&&(this.resolvers=[],this.models=this.template.f.a.r.map(function(e,n){var i=void 0,r=se(t.parentFragment,e);return r?r.register(t):(i=t.parentFragment.resolve(e,function(e){t.models[n]=e,U(t.resolvers,i),e.register(t)}),t.resolvers.push(i)),r}),this.argsFn=An(this.template.f.a.s,this.template.f.a.r.length))},t.prototype.bubble=function(){this.dirty||(this.dirty=!0,this.owner.bubble())},t.prototype.destroyed=function(){this.intermediary&&this.intermediary.teardown(),this.shouldDestroy=!0},t.prototype.handleChange=function(){this.bubble()},t.prototype.rebinding=function(t,e,n){var i=this.models.indexOf(e);~i&&(t=ee(this.template.f.a.r[i],t,e),t!==e&&(e.unregister(this),this.models.splice(i,1,t),t&&t.addShuffleRegister(this,"mark"),n||this.bubble()))},t.prototype.render=function(){var t=this;as.scheduleTask(function(){var e=P("decorators",t.ractive,t.name);if(!e)return N(Yo(t.name,"decorator")),void(t.intermediary=Ah);t.node=t.element.node;var n=void 0;if(t.argsFn?(n=t.models.map(function(t){if(t)return t.get()}),n=t.argsFn.apply(t.ractive,n)):n=t.dynamicArgs?t.argsFragment.getArgsList():t.args,t.intermediary=e.apply(t.ractive,[t.node].concat(n)),!t.intermediary||!t.intermediary.teardown)throw new Error("The '"+t.name+"' decorator must return an object with a teardown method");t.shouldDestroy&&t.destroyed()},!0),this.rendered=!0},t.prototype.toString=function(){return""},t.prototype.unbind=function(){var t=this;this.dynamicName&&this.nameFragment.unbind(),this.dynamicArgs&&this.argsFragment.unbind(),this.resolvers&&this.resolvers.forEach(Wt),this.models&&this.models.forEach(function(e){e&&e.unregister(t)})},t.prototype.unrender=function(t){t&&!this.element.rendered||!this.intermediary||this.intermediary.teardown(),this.rendered=!1},t.prototype.update=function(){if(this.dirty){this.dirty=!1;var t=!1;if(this.dynamicName&&this.nameFragment.dirty){var e=this.nameFragment.toString();t=e!==this.name,this.name=e}if(this.intermediary)if(t||!this.intermediary.update)this.unrender(),this.render();else if(this.dynamicArgs){if(this.argsFragment.dirty){var n=this.argsFragment.getArgsList();this.intermediary.update.apply(this.ractive,n)}}else if(this.argsFn){var i=this.models.map(function(t){if(t)return t.get()});this.intermediary.update.apply(this.ractive,this.argsFn.apply(this.ractive,i))}else this.intermediary.update.apply(this.ractive,this.args);this.dynamicName&&this.nameFragment.dirty&&this.nameFragment.update(),this.dynamicArgs&&this.argsFragment.dirty&&this.argsFragment.update()}},t}(),Sh=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.bind=function(){},r.prototype.render=function(){},r.prototype.teardown=function(){},r.prototype.toString=function(){return"<!DOCTYPE"+this.template.a+">"},r.prototype.unbind=function(){},r.prototype.unrender=function(){},r.prototype.update=function(){},r}(gu),Oh=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";n(this,t),this.element=e,this.ractive=e.ractive,this.attribute=e.attributeByName[i];var r=this.attribute.interpolator;r.twowayBinding=this;var o=r.model;if(o){if(o.isUnresolved)o.forceResolution(),Ui("expression",this.ractive);else if(o.isReadonly){var s=o.getKeypath().replace(/^@/,"");return j("Cannot use two-way binding on <"+e.name+"> element: "+s+" is read-only. To suppress this warning use <"+e.name+" twoway='false'...>",{ractive:this.ractive}),!1}}else r.resolver.forceResolution(),o=r.model,Ui("'"+r.template.r+"' reference",this.ractive);this.attribute.isTwoway=!0,this.model=o;var a=o.get();this.wasUndefined=void 0===a,void 0===a&&this.getInitialValue&&(a=this.getInitialValue(),o.set(a)),this.lastVal(!0,a);var u=Yn(this.element,!1,"form");u&&(this.resetValue=a,u.formBindings.push(this))}return t.prototype.bind=function(){this.model.registerTwowayBinding(this)},t.prototype.handleChange=function(){var t=this,e=this.getValue();this.lastVal()!==e&&(as.start(this.root),this.attribute.locked=!0,this.model.set(e),this.lastVal(!0,e),this.model.get()!==e?this.attribute.locked=!1:as.scheduleTask(function(){return t.attribute.locked=!1}),as.end())},t.prototype.lastVal=function(t,e){return t?void(this.lastValue=e):this.lastValue},t.prototype.rebinding=function(t,e){var n=this;this.model&&this.model===e&&e.unregisterTwowayBinding(this),t&&(this.model=t,as.scheduleTask(function(){return t.registerTwowayBinding(n)}))},t.prototype.render=function(){this.node=this.element.node,this.node._ractive.binding=this,this.rendered=!0},t.prototype.setFromNode=function(t){this.model.set(t.value)},t.prototype.unbind=function(){this.model.unregisterTwowayBinding(this)},t.prototype.unrender=function(){},t}(),Th=function(i){function r(e){return n(this,r),t(this,i.call(this,e,"checked"))}return e(r,i),r.prototype.render=function(){i.prototype.render.call(this),this.node.addEventListener("change",qi,!1),this.node.attachEvent&&this.node.addEventListener("click",qi,!1)},r.prototype.unrender=function(){this.node.removeEventListener("change",qi,!1),this.node.removeEventListener("click",qi,!1)},r.prototype.getInitialValue=function(){return!!this.element.getAttribute("checked")},r.prototype.getValue=function(){return this.node.checked},r.prototype.setFromNode=function(t){this.model.set(t.checked)},r}(Oh),Nh=function(){function t(e,i,r){var o=this;n(this,t),this.model=i,this.hash=e,this.getValue=function(){return o.value=r.call(o),o.value},this.bindings=[]}return t.prototype.add=function(t){this.bindings.push(t)},t.prototype.bind=function(){this.value=this.model.get(),this.model.registerTwowayBinding(this),this.bound=!0},t.prototype.remove=function(t){U(this.bindings,t),this.bindings.length||this.unbind()},t.prototype.unbind=function(){this.model.unregisterTwowayBinding(this),this.bound=!1,delete this.model[this.hash]},t}(),Fh=[].push,jh=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e,"name"));if(o.checkboxName=!0,o.group=zi("checkboxes",o.model,Hi),o.group.add(o),o.noInitialValue&&(o.group.noInitialValue=!0),o.group.noInitialValue&&o.element.getAttribute("checked")){var s=o.model.get(),a=o.element.getAttribute("value");V(s,a)||Fh.call(s,a)}return o}return e(r,i),r.prototype.bind=function(){this.group.bound||this.group.bind()},r.prototype.changed=function(){var t=!!this.isChecked;return this.isChecked=this.node.checked,this.isChecked===t},r.prototype.getInitialValue=function(){return this.noInitialValue=!0,[]},r.prototype.getValue=function(){return this.group.value},r.prototype.handleChange=function(){this.isChecked=this.element.node.checked,this.group.value=this.model.get();var t=this.element.getAttribute("value");this.isChecked&&!V(this.group.value,t)?this.group.value.push(t):!this.isChecked&&V(this.group.value,t)&&U(this.group.value,t),this.lastValue=null,i.prototype.handleChange.call(this)},r.prototype.render=function(){i.prototype.render.call(this);var t=this.node,e=this.model.get(),n=this.element.getAttribute("value");x(e)?this.isChecked=V(e,n):this.isChecked=e==n,t.name="{{"+this.model.getKeypath()+"}}",t.checked=this.isChecked,t.addEventListener("change",qi,!1),t.attachEvent&&t.addEventListener("click",qi,!1)},r.prototype.setFromNode=function(t){if(this.group.bindings.forEach(function(t){return t.wasUndefined=!0}),t.checked){var e=this.group.getValue();e.push(this.element.getAttribute("value")),this.group.model.set(e)}},r.prototype.unbind=function(){this.group.remove(this)},r.prototype.unrender=function(){var t=this.element.node;t.removeEventListener("change",qi,!1),t.removeEventListener("click",qi,!1)},r}(Oh),Ph=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.getInitialValue=function(){return this.element.fragment?this.element.fragment.toString():""},r.prototype.getValue=function(){return this.element.node.innerHTML},r.prototype.render=function(){i.prototype.render.call(this);var t=this.node;t.addEventListener("change",qi,!1),t.addEventListener("blur",qi,!1),this.ractive.lazy||(t.addEventListener("input",qi,!1),t.attachEvent&&t.addEventListener("keyup",qi,!1))},r.prototype.setFromNode=function(t){this.model.set(t.innerHTML)},r.prototype.unrender=function(){var t=this.node;t.removeEventListener("blur",qi,!1),t.removeEventListener("change",qi,!1),t.removeEventListener("input",qi,!1),t.removeEventListener("keyup",qi,!1)},r}(Oh),Mh=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.getInitialValue=function(){return""},r.prototype.getValue=function(){return this.node.value},r.prototype.render=function(){i.prototype.render.call(this);var t=this.ractive.lazy,e=!1;"lazy"in this.element&&(t=this.element.lazy),_(t)&&(e=+t,t=!1),this.handler=e?Qi(e):qi;var n=this.node;n.addEventListener("change",qi,!1),t||(n.addEventListener("input",this.handler,!1),n.attachEvent&&n.addEventListener("keyup",this.handler,!1)),n.addEventListener("blur",Wi,!1)},r.prototype.unrender=function(){var t=this.element.node;this.rendered=!1,t.removeEventListener("change",qi,!1),t.removeEventListener("input",this.handler,!1),t.removeEventListener("keyup",this.handler,!1),t.removeEventListener("blur",Wi,!1)},r}(Oh),Bh=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.getInitialValue=function(){},r.prototype.getValue=function(){return this.node.files},r.prototype.render=function(){this.element.lazy=!1,i.prototype.render.call(this)},r.prototype.setFromNode=function(t){this.model.set(t.files)},r}(Mh),Ih=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.forceUpdate=function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,as.scheduleTask(function(){return t.attribute.locked=!1}),this.model.set(e))},r.prototype.getInitialValue=function(){return this.element.options.filter(function(t){return t.getAttribute("selected")}).map(function(t){return t.getAttribute("value")})},r.prototype.getValue=function(){for(var t=this.element.node.options,e=t.length,n=[],i=0;i<e;i+=1){var r=t[i];if(r.selected){var o=r._ractive?r._ractive.value:r.value;n.push(o)}}return n},r.prototype.handleChange=function(){var t=this.attribute,e=t.getValue(),n=this.getValue();return void 0!==e&&K(n,e)||i.prototype.handleChange.call(this),this},r.prototype.render=function(){i.prototype.render.call(this),this.node.addEventListener("change",qi,!1),void 0===this.model.get()&&this.handleChange()},r.prototype.setFromNode=function(t){for(var e=$i(t),n=e.length,i=new Array(n);n--;){var r=e[n];i[n]=r._ractive?r._ractive.value:r.value}this.model.set(i)},r.prototype.setValue=function(){throw new Error("TODO not implemented yet")},r.prototype.unrender=function(){this.node.removeEventListener("change",qi,!1)},r.prototype.updateModel=function(){void 0!==this.attribute.value&&this.attribute.value.length||this.keypath.set(this.initialValue)},r}(Oh),Lh=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.getInitialValue=function(){},r.prototype.getValue=function(){var t=parseFloat(this.node.value);return isNaN(t)?void 0:t},r.prototype.setFromNode=function(t){var e=parseFloat(t.value);isNaN(e)||this.model.set(e)},r}(Mh),Vh={},Kh=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e,"checked"));return o.siblings=Gi(o.ractive._guid+o.element.getAttribute("name")),o.siblings.push(o),o}return e(r,i),r.prototype.getValue=function(){return this.node.checked},r.prototype.handleChange=function(){as.start(this.root),this.siblings.forEach(function(t){t.model.set(t.getValue())}),as.end()},r.prototype.render=function(){i.prototype.render.call(this),this.node.addEventListener("change",qi,!1),this.node.attachEvent&&this.node.addEventListener("click",qi,!1)},r.prototype.setFromNode=function(t){this.model.set(t.checked)},r.prototype.unbind=function(){U(this.siblings,this)},r.prototype.unrender=function(){this.node.removeEventListener("change",qi,!1),this.node.removeEventListener("click",qi,!1)},r}(Oh),Rh=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e,"name"));return o.group=zi("radioname",o.model,Yi),o.group.add(o),e.checked&&(o.group.value=o.getValue()),o}return e(r,i),r.prototype.bind=function(){var t=this;this.group.bound||this.group.bind(),this.nameAttributeBinding={handleChange:function(){return t.node.name="{{"+t.model.getKeypath()+"}}"}},this.model.getKeypathModel().register(this.nameAttributeBinding)},r.prototype.getInitialValue=function(){if(this.element.getAttribute("checked"))return this.element.getAttribute("value")},r.prototype.getValue=function(){return this.element.getAttribute("value")},r.prototype.handleChange=function(){this.node.checked&&(this.group.value=this.getValue(),i.prototype.handleChange.call(this))},r.prototype.lastVal=function(t,e){if(this.group)return t?void(this.group.lastValue=e):this.group.lastValue},r.prototype.render=function(){i.prototype.render.call(this);var t=this.node;t.name="{{"+this.model.getKeypath()+"}}",t.checked=this.model.get()==this.element.getAttribute("value"),t.addEventListener("change",qi,!1),t.attachEvent&&t.addEventListener("click",qi,!1)},r.prototype.setFromNode=function(t){t.checked&&this.group.model.set(this.element.getAttribute("value"))},r.prototype.unbind=function(){this.group.remove(this),this.model.getKeypathModel().unregister(this.nameAttributeBinding)},r.prototype.unrender=function(){var t=this.node;t.removeEventListener("change",qi,!1),t.removeEventListener("click",qi,!1)},r}(Oh),Dh=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.forceUpdate=function(){var t=this,e=this.getValue();void 0!==e&&(this.attribute.locked=!0,as.scheduleTask(function(){return t.attribute.locked=!1}),this.model.set(e))},r.prototype.getInitialValue=function(){if(void 0===this.element.getAttribute("value")){var t=this.element.options,e=t.length;if(e){for(var n=void 0,i=void 0,r=e;r--;){var o=t[r];if(o.getAttribute("selected")){o.getAttribute("disabled")||(n=o.getAttribute("value")),i=!0;break}}if(!i)for(;++r<e;)if(!t[r].getAttribute("disabled")){n=t[r].getAttribute("value");break}return void 0!==n&&(this.element.attributeByName.value.value=n),n}}},r.prototype.getValue=function(){var t=this.node.options,e=t.length,n=void 0;for(n=0;n<e;n+=1){var i=t[n];if(t[n].selected&&!t[n].disabled)return i._ractive?i._ractive.value:i.value}},r.prototype.render=function(){i.prototype.render.call(this),this.node.addEventListener("change",qi,!1)},r.prototype.setFromNode=function(t){var e=$i(t)[0];this.model.set(e._ractive?e._ractive.value:e.value)},r.prototype.setValue=function(t){this.model.set(t)},r.prototype.unrender=function(){this.node.removeEventListener("change",qi,!1)},r}(Oh),Uh=/;\s*$/,qh=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));if(o.liveQueries=[],o.name=e.template.e.toLowerCase(),o.isVoid=Nu.test(o.name),o.parent=Yn(o.parentFragment,!1),o.parent&&"option"===o.parent.name)throw new Error("An <option> element cannot contain other elements (encountered <"+o.name+">)");o.decorators=[],o.attributeByName={},o.attributes=[];var s=[];(o.template.m||[]).forEach(function(t){switch(t.t){case Xa:case mu:case fu:case pu:case du:o.attributes.push(Ar({owner:o,parentFragment:o.parentFragment,template:t}));break;default:s.push(t)}}),s.length&&o.attributes.push(new zu({owner:o,parentFragment:o.parentFragment,template:s}));for(var a=o.attributes.length;a--;){var u=o.attributes[a];"type"===u.name?o.attributes.unshift(o.attributes.splice(a,1)[0]):"max"===u.name?o.attributes.unshift(o.attributes.splice(a,1)[0]):"min"===u.name?o.attributes.unshift(o.attributes.splice(a,1)[0]):"class"===u.name?o.attributes.unshift(o.attributes.splice(a,1)[0]):"value"===u.name&&o.attributes.push(o.attributes.splice(a,1)[0])}return e.template.f&&!e.deferContent&&(o.fragment=new $l({template:e.template.f,owner:o,cssIds:null})),o.binding=null,o}return e(r,i),r.prototype.bind=function(){this.attributes.binding=!0,this.attributes.forEach(Vt),this.attributes.binding=!1,this.fragment&&this.fragment.bind(),this.binding||this.recreateTwowayBinding()},r.prototype.createTwowayBinding=function(){var t="twoway"in this?this.twoway:this.ractive.twoway;if(!t)return null;var e=Zi(this);if(!e)return null;var n=new e(this);return n&&n.model?n:null},r.prototype.destroyed=function(){this.attributes.forEach(function(t){return t.destroyed()}),this.fragment&&this.fragment.destroyed()},r.prototype.detach=function(){return this.rendered||this.destroyed(),v(this.node)},r.prototype.find=function(t){return this.node&&bo(this.node,t)?this.node:this.fragment?this.fragment.find(t):void 0},r.prototype.findAll=function(t,e){var n=e.test(this.node);n&&(e.add(this.node),e.live&&this.liveQueries.push(e)),this.fragment&&this.fragment.findAll(t,e)},r.prototype.findComponent=function(t){if(this.fragment)return this.fragment.findComponent(t)},r.prototype.findAllComponents=function(t,e){this.fragment&&this.fragment.findAllComponents(t,e)},r.prototype.findNextNode=function(){return null},r.prototype.firstNode=function(){return this.node},r.prototype.getAttribute=function(t){var e=this.attributeByName[t];return e?e.getValue():void 0},r.prototype.recreateTwowayBinding=function(){this.binding&&(this.binding.unbind(),this.binding.unrender()),(this.binding=this.createTwowayBinding())&&(this.binding.bind(),this.rendered&&this.binding.render())},r.prototype.render=function(t,e){this.namespace=ir(this);var n=void 0,i=!1;if(e)for(var r=void 0;r=e.shift();){if(r.nodeName.toUpperCase()===this.template.e.toUpperCase()&&r.namespaceURI===this.namespace){this.node=n=r,i=!0;break}v(r)}if(n||(n=yo(this.template.e,this.namespace,this.getAttribute("is")),this.node=n),Lo(n,"_ractive",{value:{proxy:this}}),this.parentFragment.cssIds&&n.setAttribute("data-ractive-css",this.parentFragment.cssIds.map(function(t){return"{"+t+"}"}).join(" ")),i&&this.foundNode&&this.foundNode(n),this.fragment){var o=i?q(n.childNodes):void 0;this.fragment.render(n,o),o&&o.forEach(v)}if(i){this.binding&&this.binding.wasUndefined&&this.binding.setFromNode(n);for(var s=n.attributes.length;s--;){var a=n.attributes[s].name;a in this.attributeByName||n.removeAttribute(a)}}this.attributes.forEach(zt),this.binding&&this.binding.render(),Di(this),this._introTransition&&this.ractive.transitionsEnabled&&(this._introTransition.isIntro=!0,as.registerTransition(this._introTransition)),i||t.appendChild(n),this.rendered=!0},r.prototype.shuffled=function(){this.liveQueries.forEach(Xi),i.prototype.shuffled.call(this)},r.prototype.toString=function(){var t=this.template.e,e=this.attributes.map(er).join("");"option"===this.name&&this.isSelected()&&(e+=" selected"),"input"===this.name&&tr(this)&&(e+=" checked");var n=void 0,i=void 0;this.attributes.forEach(function(t){"class"===t.name?i=(i||"")+(i?" ":"")+y(t.getString()):"style"===t.name?(n=(n||"")+(n?" ":"")+y(t.getString()),n&&!Uh.test(n)&&(n+=";")):t.style?n=(n||"")+(n?" ":"")+(t.style+": "+y(t.getString())+";"):t.inlineClass&&t.getValue()&&(i=(i||"")+(i?" ":"")+t.inlineClass)}),void 0!==n&&(e=" style"+(n?'="'+n+'"':"")+e),void 0!==i&&(e=" class"+(i?'="'+i+'"':"")+e);var r="<"+t+e+">";return this.isVoid?r:("textarea"===this.name&&void 0!==this.getAttribute("value")?r+=gi(this.getAttribute("value")):void 0!==this.getAttribute("contenteditable")&&(r+=this.getAttribute("value")||""),this.fragment&&(r+=this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e))),r+="</"+t+">")},r.prototype.unbind=function(){this.attributes.unbinding=!0,this.attributes.forEach(Wt),this.attributes.unbinding=!1,this.binding&&this.binding.unbind(),this.fragment&&this.fragment.unbind()},r.prototype.unrender=function(t){if(this.rendered){this.rendered=!1;var e=this._introTransition;e&&e.complete&&e.complete(),"option"===this.name?this.detach():t&&as.detachWhenReady(this),this.fragment&&this.fragment.unrender(),this.binding&&this.binding.unrender(),this._outroTransition&&this.ractive.transitionsEnabled&&(this._outroTransition.isIntro=!1,as.registerTransition(this._outroTransition)),nr(this)}},r.prototype.update=function(){this.dirty&&(this.dirty=!1,this.attributes.forEach(Gt),this.fragment&&this.fragment.update())},r}(gu),zh=function(i){function r(e){
n(this,r);var o=t(this,i.call(this,e));return o.formBindings=[],o}return e(r,i),r.prototype.render=function(t,e){i.prototype.render.call(this,t,e),this.node.addEventListener("reset",rr,!1)},r.prototype.unrender=function(t){this.node.removeEventListener("reset",rr,!1),i.prototype.unrender.call(this,t)},r}(qh),Hh=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.parentFragment=e.parentFragment,o.template=e.template,o.index=e.index,e.owner&&(o.parent=e.owner),o.isStatic=!!e.template.s,o.model=null,o.dirty=!1,o}return e(r,i),r.prototype.bind=function(){var t=this,e=$n(this.parentFragment,this.template),n=e?e.get():void 0;return this.isStatic?void(this.model={get:function(){return n}}):void(e?(e.register(this),this.model=e):this.resolver=this.parentFragment.resolve(this.template.r,function(e){t.model=e,e.register(t),t.handleChange(),t.resolver=null}))},r.prototype.handleChange=function(){this.bubble()},r.prototype.rebinding=function(t,e,n){return t=ee(this.template,t,e),!this.static&&(t!==this.model&&(this.model&&this.model.unregister(this),t&&t.addShuffleRegister(this,"mark"),this.model=t,n||this.handleChange(),!0))},r.prototype.unbind=function(){this.isStatic||(this.model&&this.model.unregister(this),this.model=void 0,this.resolver&&this.resolver.unbind())},r}(gu),Wh=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.bubble=function(){this.owner&&this.owner.bubble(),i.prototype.bubble.call(this)},r.prototype.detach=function(){return v(this.node)},r.prototype.firstNode=function(){return this.node},r.prototype.getString=function(){return this.model?g(this.model.get()):""},r.prototype.render=function(t,e){if(!ki()){var n=this.getString();if(this.rendered=!0,e){var i=e[0];i&&3===i.nodeType?(e.shift(),i.nodeValue!==n&&(i.nodeValue=n)):(i=this.node=fo.createTextNode(n),e[0]?t.insertBefore(i,e[0]):t.appendChild(i)),this.node=i}else this.node=fo.createTextNode(n),t.appendChild(this.node)}},r.prototype.toString=function(t){var e=this.getString();return t?gi(e):e},r.prototype.unrender=function(t){t&&this.detach(),this.rendered=!1},r.prototype.update=function(){this.dirty&&(this.dirty=!1,this.rendered&&(this.node.data=this.getString()))},r.prototype.valueOf=function(){return this.model?this.model.get():void 0},r}(Hh),Qh=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.render=function(t,e){i.prototype.render.call(this,t,e),this.node.defaultValue=this.node.value},r}(qh),$h=/^\s+/;nh=function(t){this.name="ParseError",this.message=t;try{throw new Error(t)}catch(t){this.stack=t.stack}},nh.prototype=Error.prototype,eh=function(t,e){var n,i,r=0;for(this.str=t,this.options=e||{},this.pos=0,this.lines=this.str.split("\n"),this.lineEnds=this.lines.map(function(t){var e=r+t.length+1;return r=e,e},0),this.init&&this.init(t,e),n=[];this.pos<this.str.length&&(i=this.read());)n.push(i);this.leftover=this.remaining(),this.result=this.postProcess?this.postProcess(n,e):n},eh.prototype={read:function(t){var e,n,i,r;for(t||(t=this.converters),e=this.pos,i=t.length,n=0;n<i;n+=1)if(this.pos=e,r=t[n](this))return r;return null},getContextMessage:function(t,e){var n=this.getLinePos(t),i=n[0],r=n[1];if(this.options.contextLines===-1)return[i,r,e+" at line "+i+" character "+r];var o=this.lines[i-1],s="",a="";if(this.options.contextLines){var u=i-1-this.options.contextLines<0?0:i-1-this.options.contextLines;s=this.lines.slice(u,i-1-u).join("\n").replace(/\t/g,"  "),a=this.lines.slice(i,i+this.options.contextLines).join("\n").replace(/\t/g,"  "),s&&(s+="\n"),a&&(a="\n"+a)}var h=0,l=s+o.replace(/\t/g,function(t,e){return e<r&&(h+=1),"  "})+"\n"+new Array(r+h).join(" ")+"^----"+a;return[i,r,e+" at line "+i+" character "+r+":\n"+l]},getLinePos:function(t){for(var e,n=0,i=0;t>=this.lineEnds[n];)i=this.lineEnds[n],n+=1;return e=t-i,[n+1,e+1,t]},error:function(t){var e=this.getContextMessage(this.pos,t),n=e[0],i=e[1],r=e[2],o=new nh(r);throw o.line=n,o.character=i,o.shortMessage=t,o},matchString:function(t){if(this.str.substr(this.pos,t.length)===t)return this.pos+=t.length,t},matchPattern:function(t){var e;if(e=t.exec(this.remaining()))return this.pos+=e[0].length,e[1]||e[0]},allowWhitespace:function(){this.matchPattern($h)},remaining:function(){return this.str.substring(this.pos)},nextChar:function(){return this.str.charAt(this.pos)}},eh.extend=function(t){var e,n,i=this;e=function(t,e){eh.call(this,t,e)},e.prototype=Io(i.prototype);for(n in t)qo.call(t,n)&&(e.prototype[n]=t[n]);return e.extend=eh.extend,e};var Gh,Yh,Jh,Zh=eh;Gh=/^(?=.)[^"'\\]+?(?:(?!.)|(?=["'\\]))/,Yh=/^\\(?:['"\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/,Jh=/^\\(?:\r\n|[\u000A\u000D\u2028\u2029])/;var Xh=function(t){return function(e){for(var n='"',i=!1,r=void 0;!i;)r=e.matchPattern(Gh)||e.matchPattern(Yh)||e.matchString(t),r?n+='"'===r?'\\"':"\\'"===r?"'":r:(r=e.matchPattern(Jh),r?n+="\\u"+("000"+r.charCodeAt(1).toString(16)).slice(-4):i=!0);return n+='"',JSON.parse(n)}},tl=Xh('"'),el=Xh("'"),nl=function(t){var e,n;return e=t.pos,t.matchString('"')?(n=el(t),t.matchString('"')?{t:ou,v:n}:(t.pos=e,null)):t.matchString("'")?(n=tl(t),t.matchString("'")?{t:ou,v:n}:(t.pos=e,null)):null},il=/^(?:[+-]?)0*(?:(?:(?:[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,rl=/^[a-zA-Z_$][a-zA-Z_$0-9]*/,ol=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/,sl={true:!0,false:!1,null:null,undefined:void 0},al=new RegExp("^(?:"+Object.keys(sl).join("|")+")"),ul=/^(?:[+-]?)(?:(?:(?:0|[1-9]\d*)?\.\d+)|(?:(?:0|[1-9]\d*)\.)|(?:0|[1-9]\d*))(?:[eE][+-]?\d+)?/,hl=/\$\{([^\}]+)\}/g,ll=/^\$\{([^\}]+)\}/,cl=/^\s*$/,pl=Zh.extend({init:function(t,e){this.values=e.values,this.allowWhitespace()},postProcess:function(t){return 1===t.length&&cl.test(this.leftover)?{value:t[0].v}:null},converters:[function(t){if(!t.values)return null;var e=t.matchPattern(ll);return e&&t.values.hasOwnProperty(e)?{v:t.values[e]}:void 0},function(t){var e=t.matchPattern(al);if(e)return{v:sl[e]}},function(t){var e=t.matchPattern(ul);if(e)return{v:+e}},function(t){var e=nl(t),n=t.values;return e&&n?{v:e.v.replace(hl,function(t,e){return e in n?n[e]:e})}:e},function(t){if(!t.matchString("{"))return null;var e={};if(t.allowWhitespace(),t.matchString("}"))return{v:e};for(var n=void 0;n=ur(t);){if(e[n.key]=n.value,t.allowWhitespace(),t.matchString("}"))return{v:e};if(!t.matchString(","))return null}return null},function(t){if(!t.matchString("["))return null;var e=[];if(t.allowWhitespace(),t.matchString("]"))return{v:e};for(var n=void 0;n=t.read();){if(e.push(n.v),t.allowWhitespace(),t.matchString("]"))return{v:e};if(!t.matchString(","))return null;t.allowWhitespace()}return null}]}),fl=function(t,e){var n=new pl(t,{values:e});return n.result},dl=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.name=e.template.n,o.owner=e.owner||e.parentFragment.owner||e.element||Yn(e.parentFragment),o.element=e.element||(o.owner.attributeByName?o.owner:Yn(e.parentFragment)),o.parentFragment=o.element.parentFragment,o.ractive=o.parentFragment.ractive,o.fragment=null,o.element.attributeByName[o.name]=o,o.value=e.template.f,o}return e(r,i),r.prototype.bind=function(){this.fragment&&this.fragment.bind();var t=this.template.f,e=this.element.instance.viewmodel;if(0===t)e.joinKey(this.name).set(!0);else if("string"==typeof t){var n=fl(t);e.joinKey(this.name).set(n?n.value:t)}else x(t)&&hr(this,!0)},r.prototype.render=function(){},r.prototype.unbind=function(){this.fragment&&this.fragment.unbind(),this.boundFragment&&this.boundFragment.unbind(),this.element.bound&&this.link.target===this.model&&this.link.owner.unlink()},r.prototype.unrender=function(){},r.prototype.update=function(){this.dirty&&(this.dirty=!1,this.fragment&&this.fragment.update(),this.boundFragment&&this.boundFragment.update(),this.rendered&&this.updateDelegate())},r}(gu),ml=function(i){function r(e){n(this,r);var o=e.template;o.a||(o.a={}),void 0!==o.a.value||"disabled"in o.a||(o.a.value=o.f||"");var s=t(this,i.call(this,e));return s.select=Yn(s.parent||s.parentFragment,!1,"select"),s}return e(r,i),r.prototype.bind=function(){if(!this.select)return void i.prototype.bind.call(this);var t=this.attributeByName.selected;if(t&&void 0!==this.select.getAttribute("value")){var e=this.attributes.indexOf(t);this.attributes.splice(e,1),delete this.attributeByName.selected}i.prototype.bind.call(this),this.select.options.push(this)},r.prototype.bubble=function(){var t=this.getAttribute("value");this.node&&this.node.value!==t&&(this.node._ractive.value=t),i.prototype.bubble.call(this)},r.prototype.getAttribute=function(t){var e=this.attributeByName[t];return e?e.getValue():"value"===t&&this.fragment?this.fragment.valueOf():void 0},r.prototype.isSelected=function(){var t=this.getAttribute("value");if(void 0===t||!this.select)return!1;var e=this.select.getAttribute("value");if(e==t)return!0;if(this.select.getAttribute("multiple")&&x(e))for(var n=e.length;n--;)if(e[n]==t)return!0},r.prototype.render=function(t,e){i.prototype.render.call(this,t,e),this.attributeByName.value||(this.node._ractive.value=this.getAttribute("value"))},r.prototype.unbind=function(){i.prototype.unbind.call(this),this.select&&U(this.select.options,this)},r}(qh),vl=function(i){function r(){return n(this,r),t(this,i.apply(this,arguments))}return e(r,i),r.prototype.bind=function(){this.refName=this.template.r;var t=this.refName?lr(this.ractive,this.refName,this.parentFragment)||null:null,e=void 0;t&&(this.named=!0,this.setTemplate(this.template.r,t)),t||(i.prototype.bind.call(this),this.model&&(e=this.model.get())&&"object"==typeof e&&("string"==typeof e.template||x(e.t))?(e.template?(this.source=e.template,e=mr(this.template.r,e.template,this.ractive)):this.source=e.t,this.setTemplate(this.template.r,e.t)):this.model&&"string"==typeof this.model.get()||!this.refName?this.setTemplate(this.model.get()):this.setTemplate(this.refName,t)),this.fragment=new $l({owner:this,template:this.partialTemplate}).bind()},r.prototype.detach=function(){return this.fragment.detach()},r.prototype.find=function(t){return this.fragment.find(t)},r.prototype.findAll=function(t,e){this.fragment.findAll(t,e)},r.prototype.findComponent=function(t){return this.fragment.findComponent(t)},r.prototype.findAllComponents=function(t,e){this.fragment.findAllComponents(t,e)},r.prototype.firstNode=function(t){return this.fragment.firstNode(t)},r.prototype.forceResetTemplate=function(){var t=this;this.partialTemplate=void 0,this.refName&&(this.partialTemplate=lr(this.ractive,this.refName,this.parentFragment)),this.partialTemplate||(this.partialTemplate=lr(this.ractive,this.name,this.parentFragment)),this.partialTemplate||(j("Could not find template for partial '"+this.name+"'"),this.partialTemplate=[]),this.inAttribute?xi(function(){return t.fragment.resetTemplate(t.partialTemplate)}):this.fragment.resetTemplate(this.partialTemplate),this.bubble()},r.prototype.render=function(t,e){this.fragment.render(t,e)},r.prototype.setTemplate=function(t,e){this.name=t,e||null===e||(e=lr(this.ractive,t,this.parentFragment)),e||j("Could not find template for partial '"+t+"'"),this.partialTemplate=e||[]},r.prototype.toString=function(t){return this.fragment.toString(t)},r.prototype.unbind=function(){i.prototype.unbind.call(this),this.fragment.unbind()},r.prototype.unrender=function(t){this.fragment.unrender(t)},r.prototype.update=function(){var t=void 0;this.dirty&&(this.dirty=!1,this.named||(this.model&&(t=this.model.get()),t&&"string"==typeof t&&t!==this.name?(this.setTemplate(t),this.fragment.resetTemplate(this.partialTemplate)):t&&"object"==typeof t&&("string"==typeof t.template||x(t.t))&&t.t!==this.source&&t.template!==this.source&&(t.template?(this.source=t.template,t=mr(this.name,t.template,this.ractive)):this.source=t.t,this.setTemplate(this.name,t.t),this.fragment.resetTemplate(this.partialTemplate))),this.fragment.update())},r}(Hh),gl=function(){function t(e){n(this,t),this.parent=e.owner.parentFragment,this.parentFragment=this,this.owner=e.owner,this.ractive=this.parent.ractive,this.cssIds="cssIds"in e?e.cssIds:this.parent?this.parent.cssIds:null,this.context=null,this.rendered=!1,this.iterations=[],this.template=e.template,this.indexRef=e.indexRef,this.keyRef=e.keyRef,this.pendingNewIndices=null,this.previousIterations=null,this.isArray=!1}return t.prototype.bind=function(t){var e=this;this.context=t;var n=t.get();if(this.isArray=x(n)){this.iterations=[];for(var i=n.length,r=0;r<i;r+=1)this.iterations[r]=this.createIteration(r,r)}else if(A(n)){if(this.isArray=!1,this.indexRef){var o=this.indexRef.split(",");this.keyRef=o[0],this.indexRef=o[1]}this.iterations=Object.keys(n).map(function(t,n){return e.createIteration(t,n)})}return this},t.prototype.bubble=function(){this.owner.bubble()},t.prototype.createIteration=function(t,e){var n=new $l({owner:this,template:this.template});n.key=t,n.index=e,n.isIteration=!0;var i=this.context.joinKey(t);return this.owner.template.z&&(n.aliases={},n.aliases[this.owner.template.z[0].n]=i),n.bind(i)},t.prototype.destroyed=function(){this.iterations.forEach(function(t){return t.destroyed()})},t.prototype.detach=function(){var t=d();return this.iterations.forEach(function(e){return t.appendChild(e.detach())}),t},t.prototype.find=function(t){var e=this.iterations.length,n=void 0;for(n=0;n<e;n+=1){var i=this.iterations[n].find(t);if(i)return i}},t.prototype.findAll=function(t,e){var n=this.iterations.length,i=void 0;for(i=0;i<n;i+=1)this.iterations[i].findAll(t,e)},t.prototype.findComponent=function(t){var e=this.iterations.length,n=void 0;for(n=0;n<e;n+=1){var i=this.iterations[n].findComponent(t);if(i)return i}},t.prototype.findAllComponents=function(t,e){var n=this.iterations.length,i=void 0;for(i=0;i<n;i+=1)this.iterations[i].findAllComponents(t,e)},t.prototype.findNextNode=function(t){if(t.index<this.iterations.length-1)for(var e=t.index+1;e<this.iterations.length;e++){var n=this.iterations[e].firstNode(!0);if(n)return n}return this.owner.findNextNode()},t.prototype.firstNode=function(t){return this.iterations[0]?this.iterations[0].firstNode(t):null},t.prototype.rebinding=function(t){var e=this;this.context=t,this.iterations.forEach(function(n){var i=t?t.joinKey(n.key||n.index):void 0;n.context=i,e.owner.template.z&&(n.aliases={},n.aliases[e.owner.template.z[0].n]=i)})},t.prototype.render=function(t,e){this.iterations&&this.iterations.forEach(function(n){return n.render(t,e)}),this.rendered=!0},t.prototype.shuffle=function(t){var e=this;this.pendingNewIndices||(this.previousIterations=this.iterations.slice()),this.pendingNewIndices||(this.pendingNewIndices=[]),this.pendingNewIndices.push(t);var n=[];t.forEach(function(t,i){if(t!==-1){var r=e.iterations[i];n[t]=r,t!==i&&r&&(r.dirty=!0)}}),this.iterations=n,this.bubble()},t.prototype.shuffled=function(){this.iterations.forEach(function(t){return t.shuffled()})},t.prototype.toString=function(t){return this.iterations?this.iterations.map(t?Jt:Yt).join(""):""},t.prototype.unbind=function(){return this.iterations.forEach(Wt),this},t.prototype.unrender=function(t){this.iterations.forEach(t?$t:Qt),this.pendingNewIndices&&this.previousIterations&&this.previousIterations.forEach(function(e){e.rendered&&(t?$t(e):Qt(e))}),this.rendered=!1},t.prototype.update=function(){var t=this;if(this.pendingNewIndices)return void this.updatePostShuffle();if(!this.updating){this.updating=!0;var e=this.context.get(),n=this.isArray,i=void 0,r=void 0,o=!0,s=void 0;if(this.isArray=x(e))n&&(o=!1,this.iterations.length>e.length&&(i=this.iterations.splice(e.length)));else if(A(e)&&!n)for(o=!1,i=[],r={},s=this.iterations.length;s--;){var a=this.iterations[s];a.key in e?r[a.key]=!0:(this.iterations.splice(s,1),i.push(a))}o&&(i=this.iterations,this.iterations=[]),i&&i.forEach(function(t){t.unbind(),t.unrender(!0)}),this.iterations.forEach(Gt);var u=x(e)?e.length:A(e)?Object.keys(e).length:0,h=void 0,l=void 0;if(u>this.iterations.length){if(h=this.rendered?d():null,s=this.iterations.length,x(e))for(;s<e.length;)l=this.createIteration(s,s),this.iterations.push(l),this.rendered&&l.render(h),s+=1;else if(A(e)){if(this.indexRef&&!this.keyRef){var c=this.indexRef.split(",");this.keyRef=c[0],this.indexRef=c[1]}Object.keys(e).forEach(function(e){r&&e in r||(l=t.createIteration(e,s),t.iterations.push(l),t.rendered&&l.render(h),s+=1)})}if(this.rendered){var p=this.parent.findParentNode(),f=this.parent.findNextNode(this.owner);p.insertBefore(h,f)}}this.updating=!1}},t.prototype.updatePostShuffle=function(){var t=this,e=this.pendingNewIndices[0];this.pendingNewIndices.slice(1).forEach(function(t){e.forEach(function(n,i){e[i]=t[n]})});var n=this.context.get().length,i=this.previousIterations.length,r=void 0,o={};e.forEach(function(e,n){var i=t.previousIterations[n];if(t.previousIterations[n]=null,e===-1)o[n]=i;else if(i.index!==e){var r=t.context.joinKey(e);i.index=e,i.context=r,t.owner.template.z&&(i.aliases={},i.aliases[t.owner.template.z[0].n]=r)}}),this.previousIterations.forEach(function(t,e){t&&(o[e]=t)});var s=this.rendered?d():null,a=this.rendered?this.parent.findParentNode():null,u="startIndex"in e;for(r=u?e.startIndex:0;r<n;r++){var h=this.iterations[r];h&&u?this.rendered&&(o[r]&&s.appendChild(o[r].detach()),s.childNodes.length&&a.insertBefore(s,h.firstNode())):(h||(this.iterations[r]=this.createIteration(r,r)),this.rendered&&(o[r]&&s.appendChild(o[r].detach()),h?s.appendChild(h.detach()):this.iterations[r].render(s)))}if(this.rendered){for(r=n;r<i;r++)o[r]&&s.appendChild(o[r].detach());s.childNodes.length&&a.insertBefore(s,this.owner.findNextNode())}Object.keys(o).forEach(function(t){return o[t].unbind().unrender(!0)}),this.iterations.forEach(Gt),this.pendingNewIndices=null,this.shuffled()},t}(),yl=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.sectionType=e.template.n||null,o.templateSectionType=o.sectionType,o.subordinate=1===e.template.l,o.fragment=null,o}return e(r,i),r.prototype.bind=function(){i.prototype.bind.call(this),this.subordinate&&(this.sibling=this.parentFragment.items[this.parentFragment.items.indexOf(this)-1],this.sibling.nextSibling=this),this.model?(this.dirty=!0,this.update()):!this.sectionType||this.sectionType!==uu||this.sibling&&this.sibling.isTruthy()||(this.fragment=new $l({owner:this,template:this.template.f}).bind())},r.prototype.detach=function(){return this.fragment?this.fragment.detach():d()},r.prototype.find=function(t){if(this.fragment)return this.fragment.find(t)},r.prototype.findAll=function(t,e){this.fragment&&this.fragment.findAll(t,e)},r.prototype.findComponent=function(t){if(this.fragment)return this.fragment.findComponent(t)},r.prototype.findAllComponents=function(t,e){this.fragment&&this.fragment.findAllComponents(t,e)},r.prototype.firstNode=function(t){return this.fragment&&this.fragment.firstNode(t)},r.prototype.isTruthy=function(){if(this.subordinate&&this.sibling.isTruthy())return!0;var t=this.model?this.model.isRoot?this.model.value:this.model.get():void 0;return!(!t||this.templateSectionType!==cu&&vr(t))},r.prototype.rebinding=function(t,e,n){i.prototype.rebinding.call(this,t,e,n)&&this.fragment&&this.sectionType!==au&&this.sectionType!==uu&&this.fragment.rebinding(t,e)},r.prototype.render=function(t,e){this.rendered=!0,this.fragment&&this.fragment.render(t,e)},r.prototype.shuffle=function(t){this.fragment&&this.sectionType===hu&&this.fragment.shuffle(t)},r.prototype.toString=function(t){return this.fragment?this.fragment.toString(t):""},r.prototype.unbind=function(){i.prototype.unbind.call(this),this.fragment&&this.fragment.unbind()},r.prototype.unrender=function(t){this.rendered&&this.fragment&&this.fragment.unrender(t),this.rendered=!1},r.prototype.update=function(){if(this.dirty&&(this.fragment&&this.sectionType!==au&&this.sectionType!==uu&&(this.fragment.context=this.model),this.model||this.sectionType===uu)){this.dirty=!1;var t=this.model?this.model.isRoot?this.model.value:this.model.get():void 0,e=!this.subordinate||!this.sibling.isTruthy(),n=this.sectionType;null!==this.sectionType&&null!==this.templateSectionType||(this.sectionType=gr(t,this.template.i)),n&&n!==this.sectionType&&this.fragment&&(this.rendered&&this.fragment.unbind().unrender(!0),this.fragment=null);var i=void 0,r=this.sectionType===hu||this.sectionType===lu||e&&(this.sectionType===uu?!this.isTruthy():this.isTruthy());if(r)if(this.fragment)this.fragment.update();else if(this.sectionType===hu)i=new gl({owner:this,template:this.template.f,indexRef:this.template.i}).bind(this.model);else{var o=this.sectionType!==au&&this.sectionType!==uu?this.model:null;i=new $l({owner:this,template:this.template.f}).bind(o)}else this.fragment&&this.rendered&&this.fragment.unbind().unrender(!0),this.fragment=null;if(i){if(this.rendered){var s=this.parentFragment.findParentNode(),a=this.parentFragment.findNextNode(this);if(a){var u=d();i.render(u),a.parentNode.insertBefore(u,a)}else i.render(s)}this.fragment=i}this.nextSibling&&(this.nextSibling.dirty=!0,this.nextSibling.update())}},r}(Hh),bl=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.options=[],o}return e(r,i),r.prototype.foundNode=function(t){if(this.binding){var e=$i(t);e.length>0&&(this.selectedOptions=e)}},r.prototype.render=function(t,e){i.prototype.render.call(this,t,e),this.sync();for(var n=this.node,r=n.options.length;r--;)n.options[r].defaultSelected=n.options[r].selected;this.rendered=!0},r.prototype.sync=function(){var t=this,e=this.node;if(e){var n=q(e.options);if(this.selectedOptions)return n.forEach(function(e){t.selectedOptions.indexOf(e)>=0?e.selected=!0:e.selected=!1}),this.binding.setFromNode(e),void delete this.selectedOptions;var i=this.getAttribute("value"),r=this.getAttribute("multiple");if(void 0!==i){var o=void 0;n.forEach(function(t){var e=t._ractive?t._ractive.value:t.value,n=r?yr(i,e):i==e;n&&(o=!0),t.selected=n}),o||r||this.binding&&this.binding.forceUpdate()}else this.binding&&this.binding.forceUpdate()}},r.prototype.update=function(){i.prototype.update.call(this),this.sync()},r}(qh),wl=function(i){function r(e){n(this,r);var o=e.template;e.deferContent=!0;var s=t(this,i.call(this,e));return s.attributeByName.value||(o.f&&Ji({template:o})?s.attributes.push(Ar({owner:s,template:{t:Xa,f:o.f,n:"value"},parentFragment:s.parentFragment})):s.fragment=new $l({owner:s,cssIds:null,template:o.f})),s}return e(r,i),r.prototype.bubble=function(){var t=this;this.dirty||(this.dirty=!0,this.rendered&&!this.binding&&this.fragment&&as.scheduleTask(function(){t.dirty=!1,t.node.value=t.fragment.toString()}),this.parentFragment.bubble())},r}(Qh),kl=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.type=Qa,o}return e(r,i),r.prototype.bind=function(){},r.prototype.detach=function(){return v(this.node)},r.prototype.firstNode=function(){return this.node},r.prototype.render=function(t,e){if(!ki())if(this.rendered=!0,e){var n=e[0];n&&3===n.nodeType?(e.shift(),n.nodeValue!==this.template&&(n.nodeValue=this.template)):(n=this.node=fo.createTextNode(this.template),e[0]?t.insertBefore(n,e[0]):t.appendChild(n)),this.node=n}else this.node=fo.createTextNode(this.template),t.appendChild(this.node)},r.prototype.toString=function(t){return t?gi(this.template):this.template},r.prototype.unbind=function(){},r.prototype.unrender=function(t){this.rendered&&t&&this.detach(),this.rendered=!1},r.prototype.update=function(){},r.prototype.valueOf=function(){return this.template},r}(gu),xl=function(t){return t.replace(/-([a-zA-Z])/g,function(t,e){return e.toUpperCase()})},El=void 0;mo?!function(){var t={},e=yo("div").style;El=function(n){if(n=xl(n),!t[n])if(void 0!==e[n])t[n]=n;else for(var i=n.charAt(0).toUpperCase()+n.substring(1),r=Oo.length;r--;){var o=Oo[r];if(void 0!==e[o+i]){t[n]=o+i;break}}return t[n]}}():El=null;var _l=El,Al=void 0,Cl="hidden";if(fo){var Sl=void 0;if(Cl in fo)Sl="";else for(var Ol=Oo.length;Ol--;){var Tl=Oo[Ol];if(Cl=Tl+"Hidden",Cl in fo){Sl=Tl;break}}void 0!==Sl?(fo.addEventListener(Sl+"visibilitychange",br),br()):("onfocusout"in fo?(fo.addEventListener("focusout",wr),fo.addEventListener("focusin",kr)):(po.addEventListener("pagehide",wr),po.addEventListener("blur",wr),po.addEventListener("pageshow",kr),po.addEventListener("focus",kr)),Al=!0)}var Nl=new RegExp("^-(?:"+Oo.join("|")+")-"),Fl=function(t){return t.replace(Nl,"")},jl=new RegExp("^(?:"+Oo.join("|")+")([A-Z])"),Pl=function(t){return t?(jl.test(t)&&(t="-"+t),t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})):""},Ml=void 0;mo?!function(){var t=yo("div").style,e=function(t){return t},n={},i={},r=void 0,o=void 0,s=void 0,a=void 0,u=void 0,h=void 0;void 0!==t.transition?(r="transition",o="transitionend",s=!0):void 0!==t.webkitTransition?(r="webkitTransition",o="webkitTransitionEnd",s=!0):s=!1,r&&(a=r+"Duration",u=r+"Property",h=r+"TimingFunction"),Ml=function(t,r,l,c,p){setTimeout(function(){function f(){clearTimeout(b)}function d(){g&&y&&(t.unregisterCompleteHandler(f),t.ractive.fire(t.name+":end",t.node,t.isIntro),p())}function m(t){var e=c.indexOf(xl(Fl(t.propertyName)));e!==-1&&c.splice(e,1),c.length||(clearTimeout(b),v())}function v(){k[u]=x.property,k[h]=x.duration,k[a]=x.timing,t.node.removeEventListener(o,m,!1),y=!0,d()}var g=void 0,y=void 0,b=void 0,w=(t.node.namespaceURI||"")+t.node.tagName,k=t.node.style,x={property:k[u],timing:k[h],duration:k[a]};k[u]=c.map(_l).map(Pl).join(","),k[h]=Pl(l.easing||"linear"),k[a]=l.duration/1e3+"s",t.node.addEventListener(o,m,!1),b=setTimeout(function(){c=[],v()},l.duration+(l.delay||0)+50),t.registerCompleteHandler(f),setTimeout(function(){for(var a=c.length,u=void 0,h=void 0,p=void 0,f=[],v=void 0,b=void 0,x=void 0;a--;)v=c[a],u=w+v,s&&!i[u]&&(k[_l(v)]=r[v],n[u]||(h=t.getStyle(v),n[u]=t.getStyle(v)!=r[v],i[u]=!n[u],i[u]&&(k[_l(v)]=h))),s&&!i[u]||(void 0===h&&(h=t.getStyle(v)),p=c.indexOf(v),p===-1?F("Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!",{node:t.node}):c.splice(p,1),b=/[^\d]*$/.exec(r[v])[0],x=B(parseFloat(h),parseFloat(r[v]))||function(){return r[v]},f.push({name:_l(v),interpolator:x,suffix:b}));if(f.length){var E=void 0;"string"==typeof l.easing?(E=t.ractive.easing[l.easing],E||(j(Yo(l.easing,"easing")),E=e)):E="function"==typeof l.easing?l.easing:e,new Ms({duration:l.duration,easing:E,step:function(e){for(var n=f.length;n--;){var i=f[n];t.node.style[i.name]=i.interpolator(e)+i.suffix}},complete:function(){g=!0,d()}})}else g=!0;c.length||(t.node.removeEventListener(o,m,!1),y=!0,d())},0)},l.delay||0)}}():Ml=null;var Bl=Ml,Il=po&&(po.getComputedStyle||co.getComputedStyle),Ll=is.resolve(),Vl={t0:"intro-outro",t1:"intro",t2:"outro"},Kl=function(){function t(e){n(this,t),this.owner=e.owner||e.parentFragment.owner||Yn(e.parentFragment),this.element=this.owner.attributeByName?this.owner:Yn(e.parentFragment),this.ractive=this.owner.ractive,this.template=e.template,this.parentFragment=e.parentFragment,this.options=e,this.onComplete=[]}return t.prototype.animateStyle=function(t,e,n){var i=this;if(4===arguments.length)throw new Error("t.animateStyle() returns a promise - use .then() instead of passing a callback");if(!Al)return this.setStyle(t,e),Ll;var r=void 0;return"string"==typeof t?(r={},r[t]=e):(r=t,n=e),n||(j('The "%s" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340',this.name),n=this),new is(function(t){if(!n.duration)return i.setStyle(r),void t();for(var e=Object.keys(r),o=[],s=Il(i.node),a=e.length;a--;){var u=e[a],h=s[_l(u)];"0px"===h&&(h=0),h!=r[u]&&(o.push(u),i.node.style[_l(u)]=h)}return o.length?void Bl(i,r,n,o,t):void t()})},t.prototype.bind=function(){var t=this,e=this.options,n=e.template&&e.template.v;n&&("t0"!==n&&"t1"!==n||(this.element._introTransition=this),"t0"!==n&&"t2"!==n||(this.element._outroTransition=this),this.eventName=Vl[n]);var i=this.owner.ractive;if(e.name)this.name=e.name;else{var r=e.template.f;if("string"==typeof r.n&&(r=r.n),"string"!=typeof r){var o=new $l({owner:this.owner,template:r.n}).bind();if(r=o.toString(),o.unbind(),""===r)return}this.name=r}if(e.params)this.params=e.params;else if(e.template.f.a&&!e.template.f.a.s)this.params=e.template.f.a;else if(e.template.f.d){var s=new $l({owner:this.owner,template:e.template.f.d}).bind();this.params=s.getArgsList(),s.unbind()}"function"==typeof this.name?(this._fn=this.name,this.name=this._fn.name):this._fn=P("transitions",i,this.name),this._fn||j(Yo(this.name,"transition"),{ractive:i}),e.template&&this.template.f.a&&this.template.f.a.s&&(this.resolvers=[],this.models=this.template.f.a.r.map(function(e,n){var i=void 0,r=se(t.parentFragment,e);return r?r.register(t):(i=t.parentFragment.resolve(e,function(e){t.models[n]=e,U(t.resolvers,i),e.register(t)}),t.resolvers.push(i)),r}),this.argsFn=An(this.template.f.a.s,this.template.f.a.r.length))},t.prototype.destroyed=function(){},t.prototype.getStyle=function(t){var e=Il(this.node);if("string"==typeof t){var n=e[_l(t)];return"0px"===n?0:n}if(!x(t))throw new Error("Transition$getStyle must be passed a string, or an array of strings representing CSS properties");for(var i={},r=t.length;r--;){var o=t[r],s=e[_l(o)];"0px"===s&&(s=0),i[o]=s}return i},t.prototype.processParams=function(t,e){return"number"==typeof t?t={duration:t}:"string"==typeof t?t="slow"===t?{duration:600}:"fast"===t?{duration:200}:{duration:400}:t||(t={}),w({},e,t)},t.prototype.rebinding=function(t,e){var n=this.models.indexOf(e);~n&&(t=ee(this.template.f.a.r[n],t,e),t!==e&&(e.unregister(this),this.models.splice(n,1,t),t&&t.addShuffleRegister(this,"mark")))},t.prototype.registerCompleteHandler=function(t){L(this.onComplete,t)},t.prototype.render=function(){},t.prototype.setStyle=function(t,e){if("string"==typeof t)this.node.style[_l(t)]=e;else{var n=void 0;for(n in t)t.hasOwnProperty(n)&&(this.node.style[_l(n)]=t[n])}return this},t.prototype.start=function(){var t=this,e=this.node=this.element.node,n=e.getAttribute("style"),i=void 0,r=this.params;if(this.complete=function(r){i||(t.onComplete.forEach(function(t){return t()}),!r&&t.isIntro&&xr(e,n),t._manager.remove(t),i=!0)},!this._fn)return void this.complete();if(this.argsFn){var o=this.models.map(function(t){if(t)return t.get()});r=this.argsFn.apply(this.ractive,o)}var s=this._fn.apply(this.ractive,[this].concat(r));s&&s.then(this.complete)},t.prototype.toString=function(){return""},t.prototype.unbind=function(){if(this.resolvers&&this.resolvers.forEach(Wt),!this.element.attributes.unbinding){var t=this.options&&this.options.template&&this.options.template.v;"t0"!==t&&"t1"!==t||(this.element._introTransition=null),"t0"!==t&&"t2"!==t||(this.element._outroTransition=null)}},t.prototype.unregisterCompleteHandler=function(t){U(this.onComplete,t)},t.prototype.unrender=function(){},t.prototype.update=function(){},t}(),Rl={},Dl=void 0,Ul=void 0;try{yo("table").innerHTML="foo"}catch(t){Dl=!0,Ul={TABLE:['<table class="x">',"</table>"],THEAD:['<table><thead class="x">',"</thead></table>"],TBODY:['<table><tbody class="x">',"</tbody></table>"],TR:['<table><tr class="x">',"</tr></table>"],SELECT:['<select class="x">',"</select>"]}}var ql=function(t,e,n){var i=[];if(null==t||""===t)return i;var r=void 0,o=void 0,s=void 0;Dl&&(o=Ul[e.tagName])?(r=Er("DIV"),r.innerHTML=o[0]+t+o[1],r=r.querySelector(".x"),"SELECT"===r.tagName&&(s=r.options[r.selectedIndex])):e.namespaceURI===Fo?(r=Er("DIV"),r.innerHTML='<svg class="x">'+t+"</svg>",r=r.querySelector(".x")):"TEXTAREA"===e.tagName?(r=yo("div"),"undefined"!=typeof r.textContent?r.textContent=t:r.innerHTML=t):(r=Er(e.tagName),r.innerHTML=t,"SELECT"===r.tagName&&(s=r.options[r.selectedIndex]));for(var a=void 0;a=r.firstChild;)i.push(a),n.appendChild(a);var u=void 0;if("SELECT"===e.tagName)for(u=i.length;u--;)i[u]!==s&&(i[u].selected=!1);return i},zl=function(i){function r(e){return n(this,r),t(this,i.call(this,e));
}return e(r,i),r.prototype.detach=function(){var t=d();return this.nodes.forEach(function(e){return t.appendChild(e)}),t},r.prototype.find=function(t){var e=this.nodes.length,n=void 0;for(n=0;n<e;n+=1){var i=this.nodes[n];if(1===i.nodeType){if(bo(i,t))return i;var r=i.querySelector(t);if(r)return r}}return null},r.prototype.findAll=function(t,e){var n=this.nodes.length,i=void 0;for(i=0;i<n;i+=1){var r=this.nodes[i];if(1===r.nodeType){e.test(r)&&e.add(r);var o=r.querySelectorAll(t);if(o){var s=o.length,a=void 0;for(a=0;a<s;a+=1)e.add(o[a])}}}},r.prototype.findComponent=function(){return null},r.prototype.firstNode=function(){return this.nodes[0]},r.prototype.render=function(t){var e=this.model?this.model.get():"";this.nodes=ql(e,this.parentFragment.findParentNode(),t),this.rendered=!0},r.prototype.toString=function(){return this.model&&null!=this.model.get()?vi(""+this.model.get()):""},r.prototype.unrender=function(){this.nodes&&this.nodes.forEach(function(t){return v(t)}),this.rendered=!1},r.prototype.update=function(){if(this.rendered&&this.dirty){this.dirty=!1,this.unrender();var t=d();this.render(t);var e=this.parentFragment.findParentNode(),n=this.parentFragment.findNextNode(this);e.insertBefore(t,n)}else this.dirty=!1},r}(Hh),Hl=function(i){function r(e){n(this,r);var o=t(this,i.call(this,e));return o.container=e.parentFragment.ractive,o.component=o.container.component,o.containerFragment=e.parentFragment,o.parentFragment=o.component.parentFragment,o.name=e.template.n||"",o}return e(r,i),r.prototype.bind=function(){var t=this.name;(this.component.yielders[t]||(this.component.yielders[t]=[])).push(this);var e=this.container._inlinePartials[t||"content"];"string"==typeof e&&(e=Sa(e).t),e||(F('Could not find template for partial "'+t+'"',{ractive:this.ractive}),e=[]),this.fragment=new $l({owner:this,ractive:this.container.parent,template:e}).bind()},r.prototype.bubble=function(){this.dirty||(this.containerFragment.bubble(),this.dirty=!0)},r.prototype.detach=function(){return this.fragment.detach()},r.prototype.find=function(t){return this.fragment.find(t)},r.prototype.findAll=function(t,e){this.fragment.findAll(t,e)},r.prototype.findComponent=function(t){return this.fragment.findComponent(t)},r.prototype.findAllComponents=function(t,e){this.fragment.findAllComponents(t,e)},r.prototype.findNextNode=function(){return this.containerFragment.findNextNode(this)},r.prototype.firstNode=function(t){return this.fragment.firstNode(t)},r.prototype.render=function(t,e){return this.fragment.render(t,e)},r.prototype.setTemplate=function(t){var e=this.parentFragment.ractive.partials[t];"string"==typeof e&&(e=Sa(e).t),this.partialTemplate=e||[]},r.prototype.toString=function(t){return this.fragment.toString(t)},r.prototype.unbind=function(){this.fragment.unbind(),U(this.component.yielders[this.name],this)},r.prototype.unrender=function(t){this.fragment.unrender(t)},r.prototype.update=function(){this.dirty=!1,this.fragment.update()},r}(gu),Wl={};Wl[iu]=xu,Wl[nu]=Sh,Wl[$a]=Wh,Wl[Za]=vl,Wl[Ya]=yl,Wl[Ga]=zl,Wl[eu]=Hl,Wl[Xa]=Ru,Wl[mu]=Du,Wl[fu]=Ch,Wl[pu]=xh,Wl[du]=Kl;var Ql={doctype:Sh,form:zh,input:Qh,option:ml,select:bl,textarea:wl},$l=function(){function t(e){n(this,t),this.owner=e.owner,this.isRoot=!e.owner.parentFragment,this.parent=this.isRoot?null:this.owner.parentFragment,this.ractive=e.ractive||(this.isRoot?e.owner:this.parent.ractive),this.componentParent=this.isRoot&&this.ractive.component?this.ractive.component.parentFragment:null,this.context=null,this.rendered=!1,this.cssIds="cssIds"in e?e.cssIds:this.parent?this.parent.cssIds:null,this.resolvers=[],this.dirty=!1,this.dirtyArgs=this.dirtyValue=!0,this.template=e.template||[],this.createItems()}return t.prototype.bind=function(t){return this.context=t,this.items.forEach(Vt),this.bound=!0,this.dirty&&this.update(),this},t.prototype.bubble=function(){this.dirtyArgs=this.dirtyValue=!0,this.dirty||(this.dirty=!0,this.isRoot?this.ractive.component?this.ractive.component.bubble():this.bound&&as.addFragment(this):this.owner.bubble())},t.prototype.createItems=function(){var t=this.template.length;this.items=[];for(var e=0;e<t;e++)this.items[e]=Ar({parentFragment:this,template:this.template[e],index:e})},t.prototype.destroyed=function(){this.items.forEach(function(t){return t.destroyed()})},t.prototype.detach=function(){var t=d();return this.items.forEach(function(e){return t.appendChild(e.detach())}),t},t.prototype.find=function(t){var e=this.items.length,n=void 0;for(n=0;n<e;n+=1){var i=this.items[n].find(t);if(i)return i}},t.prototype.findAll=function(t,e){if(this.items){var n=this.items.length,i=void 0;for(i=0;i<n;i+=1){var r=this.items[i];r.findAll&&r.findAll(t,e)}}return e},t.prototype.findComponent=function(t){var e=this.items.length,n=void 0;for(n=0;n<e;n+=1){var i=this.items[n].findComponent(t);if(i)return i}},t.prototype.findAllComponents=function(t,e){if(this.items){var n=this.items.length,i=void 0;for(i=0;i<n;i+=1){var r=this.items[i];r.findAllComponents&&r.findAllComponents(t,e)}}return e},t.prototype.findContext=function(){for(var t=this;t&&!t.context;)t=t.parent;return t?t.context:this.ractive.viewmodel},t.prototype.findNextNode=function(t){if(t)for(var e=t.index+1;e<this.items.length;e++)if(this.items[e]){var n=this.items[e].firstNode(!0);if(n)return n}return this.isRoot?this.ractive.component?this.ractive.component.parentFragment.findNextNode(this.ractive.component):null:this.parent?this.owner.findNextNode(this):void 0},t.prototype.findParentNode=function(){var t=this;do{if(t.owner.type===Ja)return t.owner.node;if(t.isRoot&&!t.ractive.component)return t.ractive.el;t=t.owner.type===eu?t.owner.containerFragment:t.componentParent||t.parent}while(t);throw new Error("Could not find parent node")},t.prototype.findRepeatingFragment=function(){for(var t=this;(t.parent||t.componentParent)&&!t.isIteration;)t=t.parent||t.componentParent;return t},t.prototype.firstNode=function(t){for(var e=void 0,n=0;n<this.items.length;n++)if(e=this.items[n].firstNode(!0))return e;return t?null:this.parent.findNextNode(this.owner)},t.prototype.getArgsList=function(){if(this.dirtyArgs){var t={},e=Cr(this.items,t,this.ractive._guid),n=fl("["+e+"]",t);this.argsList=n?n.value:[this.toString()],this.dirtyArgs=!1}return this.argsList},t.prototype.rebinding=function(t){this.context=t},t.prototype.render=function(t,e){if(this.rendered)throw new Error("Fragment is already rendered!");this.rendered=!0,this.items.forEach(function(n){return n.render(t,e)})},t.prototype.resetTemplate=function(t){var e=this.bound,n=this.rendered;if(e&&(n&&this.unrender(!0),this.unbind()),this.template=t,this.createItems(),e&&(this.bind(this.context),n)){var i=this.findParentNode(),r=this.findNextNode();if(r){var o=d();this.render(o),i.insertBefore(o,r)}else this.render(i)}},t.prototype.resolve=function(t,e){if(!this.context&&this.parent.resolve)return this.parent.resolve(t,e);var n=new ta(this,t,e);return this.resolvers.push(n),n},t.prototype.shuffled=function(){this.items.forEach(function(t){return t.shuffled()})},t.prototype.toHtml=function(){return this.toString()},t.prototype.toString=function(t){return this.items.map(t?Jt:Yt).join("")},t.prototype.unbind=function(){return this.items.forEach(Wt),this.bound=!1,this},t.prototype.unrender=function(t){this.items.forEach(t?Sr:Qt),this.rendered=!1},t.prototype.update=function(){this.dirty&&(this.updating?this.isRoot&&as.addFragmentToRoot(this):(this.dirty=!1,this.updating=!0,this.items.forEach(Gt),this.updating=!1))},t.prototype.valueOf=function(){if(1===this.items.length)return this.items[0].valueOf();if(this.dirtyValue){var t={},e=Cr(this.items,t,this.ractive._guid),n=fl(e,t);this.value=n?n.value:this.toString(),this.dirtyValue=!1}return this.value},t}(),Gl=Ds("reverse").path,Yl=Ds("shift").path,Jl=Ds("sort").path,Zl=Ds("splice").path,Xl=new Xo("teardown"),tc=new Xo("unrender"),ec=Ds("unshift").path,nc={add:ht,animate:pt,detach:ft,find:dt,findAll:bt,findAllComponents:wt,findComponent:kt,findContainer:xt,findParent:Et,fire:jt,get:ae,getNodeInfo:$e,insert:Ge,link:Je,merge:fe,observe:Ze,observeList:tn,observeOnce:nn,off:rn,on:on,once:sn,pop:aa,push:ua,render:cn,reset:zn,resetPartial:vu,resetTemplate:Or,reverse:Gl,set:Tr,shift:Yl,sort:Jl,splice:Zl,subtract:Nr,teardown:Fr,toggle:jr,toCSS:Pr,toCss:Pr,toHTML:Mr,toHtml:Mr,toText:Br,transition:Ir,unlink:Lr,unrender:Vr,unshift:ec,update:me,updateModel:Kr},ic=function(t,e,n){return n||Rr(t,e)?function(){var n,i="_super"in this,r=this._super;return this._super=e,n=t.apply(this,arguments),i&&(this._super=r),n}:t},rc="function";if(typeof Date.now!==rc||typeof String.prototype.trim!==rc||typeof Object.keys!==rc||typeof Array.prototype.indexOf!==rc||typeof Array.prototype.forEach!==rc||typeof Array.prototype.map!==rc||typeof Array.prototype.filter!==rc||po&&typeof po.addEventListener!==rc)throw new Error("It looks like you're attempting to use Ractive.js in an older browser. You'll need to use one of the 'legacy builds' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.");w(Gr.prototype,nc,ho),Gr.prototype.constructor=Gr,Gr.defaults=Gr.prototype,Vo(Gr,{DEBUG:{writable:!0,value:!0},DEBUG_PROMISES:{writable:!0,value:!0},extend:{value:Hr},escapeKey:{value:tt},getNodeInfo:{value:Zs},joinKeys:{value:Qr},parse:{value:Sa},splitKeypath:{value:$r},unescapeKey:{value:it},getCSS:{value:hn},Promise:{value:is},enhance:{writable:!0,value:!1},svg:{value:So},magic:{value:go},VERSION:{value:"0.8.9"},adaptors:{writable:!0,value:{}},components:{writable:!0,value:{}},decorators:{writable:!0,value:{}},easing:{writable:!0,value:lo},events:{writable:!0,value:{}},interpolators:{writable:!0,value:Jo},partials:{writable:!0,value:{}},transitions:{writable:!0,value:{}}});var oc={exports:{}};oc.exports.template={v:4,t:[{t:4,f:[{t:8,r:"Inputs",p:[2,3,19]}],n:54,r:"inputs",p:[1,1,0]},{t:4,f:[{t:4,f:[{t:8,r:"Timespan",p:[7,5,92]}],n:50,x:{r:["days.length"],s:"_0>0"},p:[6,3,64]}],n:54,r:"timespan",p:[5,1,43]},{p:[11,1,128],t:7,e:"a",m:[{n:"href",f:"https://github.com/Permutatrix/scheduler",t:13}],f:[{p:[11,52,179],t:7,e:"img",m:[{n:"style",f:"position: absolute; top: 0; right: 0; border: 0;",t:13},{n:"src",f:"https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67",t:13},{n:"alt",f:"Fork me on GitHub",t:13},{n:"data-canonical-src",f:"https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png",t:13}]}]}],p:{Inputs:[{p:[15,3,600],t:7,e:"section",m:[{n:"class",f:"inputs",t:13}],f:[{p:[16,5,629],t:7,e:"Heading",f:["Inputs"]}," ",{p:[17,5,659],t:7,e:"label",f:["Number of days: ",{p:[19,7,695],t:7,e:"input",m:[{n:"type",f:"number",t:13},{t:71,f:"ClampedNumber"},{n:"min",f:"1",t:13},{n:"value",f:[{t:2,r:"dayCount",p:[20,21,761]}],t:13}]}]}," ",{p:[22,5,797],t:7,e:"label",f:["Slots per day: ",{t:4,f:[{t:2,r:"slotsPerDay",p:[25,9,875]}],n:50,x:{r:["~/timespan.days.length"],s:"_0>0"},p:[24,7,832]},{t:4,n:51,f:[{p:[27,9,916],t:7,e:"input",m:[{n:"type",f:"number",t:13},{t:71,f:"ClampedNumber"},{n:"min",f:"1",t:13},{n:"value",f:[{t:2,r:"slotsPerDay",p:[28,23,984]}],t:13}]}],l:1}]}," ",{p:[31,5,1037],t:7,e:"br"}," ",{p:[32,5,1048],t:7,e:"label",f:["First day: ",{t:4,f:[{t:2,r:"firstDay",p:[35,9,1122]}],n:50,x:{r:["~/timespan.days.length"],s:"_0>0"},p:[34,7,1079]},{t:4,n:51,f:[{p:[37,9,1160],t:7,e:"input",m:[{n:"type",f:"date",t:13},{n:"value",f:[{t:2,r:"firstDay",p:[37,35,1186]}],t:13}]}],l:1}]}," ",{p:[40,5,1236],t:7,e:"label",f:["Start of day: ",{t:4,f:[{t:2,r:"dayStart",p:[43,9,1313]}],n:50,x:{r:["~/timespan.days.length"],s:"_0>0"},p:[42,7,1270]},{t:4,n:51,f:[{p:[45,9,1351],t:7,e:"input",m:[{n:"type",f:"time",t:13},{n:"value",f:[{t:2,r:"dayStart",p:[45,35,1377]}],t:13}]}],l:1}]}," ",{p:[48,5,1427],t:7,e:"label",f:["End of day: ",{t:4,f:[{t:2,r:"dayEnd",p:[51,9,1502]}],n:50,x:{r:["~/timespan.days.length"],s:"_0>0"},p:[50,7,1459]},{t:4,n:51,f:[{p:[53,9,1538],t:7,e:"input",m:[{n:"type",f:"time",t:13},{n:"value",f:[{t:2,r:"dayEnd",p:[53,35,1564]}],t:13}]}],l:1}]}," ",{p:[56,5,1612],t:7,e:"div",f:[{t:19,z:[{n:"level",x:{x:{r:["level"],s:"_0+1"}}}],f:[{t:8,r:"Activities"}],p:[57,7,1624]}," ",{t:19,z:[{n:"level",x:{x:{r:["level"],s:"_0+1"}}}],f:[{t:8,r:"Patterns"}],p:[58,7,1664]}]}," ",{p:[60,5,1711],t:7,e:"p",m:[{n:"class",f:"error-text",t:13},{n:"click",f:{x:{r:["@this"],s:'[_0.set("error",null)]'}},t:70}],f:[{t:2,r:"~/error.text",p:[61,7,1776]}]}," ",{p:[63,5,1808],t:7,e:"p",f:[{p:[64,7,1818],t:7,e:"button",m:[{n:"click",f:"save-to-file",t:70}],f:["Save to file"]}," ",{p:[65,7,1878],t:7,e:"button",m:[{n:"click",f:"load-from-file",t:70}],f:["Load from file"]}]}," ",{p:[67,5,1949],t:7,e:"button",m:[{n:"click",f:"generate-schedule",t:70}],f:["Schedule!"]}," ",{t:4,f:[{p:[69,7,2050],t:7,e:"button",m:[{n:"click",f:"absorb-schedule",t:70}],f:["Absorb"]}," ",{p:[70,7,2107],t:7,e:"button",m:[{n:"click",f:"discard-schedule",t:70}],f:["Discard"]}],n:50,x:{r:["~/timespan.days.length"],s:"_0>0"},p:[68,5,2009]}]}],Activities:[{p:[76,3,2225],t:7,e:"ul",m:[{n:"class",f:"activities",t:13}],f:[{t:4,f:[{p:[78,7,2280],t:7,e:"li",m:[{n:"style-background-color",f:[{t:2,x:{r:["cssColorFromRGB","color"],s:"_0(_1)"},p:[78,35,2308]}],t:13},{n:"class-white-text",f:[{t:2,x:{r:["isDark","color"],s:"_0(_1)"},p:[79,29,2366]}],t:13},{f:{a:{r:["~/selectionEnd","~/selectionStart"],s:'[{Duplicate:"duplicate-activity",Remove:"remove-activity"},_0>_1&&{Apply:"apply-activity"}]'},n:"ContextMenu"},t:71}],f:[{p:[81,9,2552],t:7,e:"DisguisedInput",m:[{n:"value",f:[{t:2,r:"name",p:[81,32,2575]}],t:13}]}," ",{p:[82,9,2598],t:7,e:"span",m:[{n:"class",f:"controls",t:13}],f:[{p:[83,11,2632],t:7,e:"input",m:[{n:"type",f:"number",t:13},{t:71,f:"ClampedNumber"},{n:"min",f:"0",t:13},{n:"value",f:[{t:2,r:"timeSpentSoFar",p:[84,25,2702]}],t:13},{f:{a:{r:[],s:'["time spent so far"]'},n:"Label"},t:71}]}," / ",{p:[87,11,2797],t:7,e:"input",m:[{n:"type",f:"number",t:13},{t:71,f:"ClampedNumber"},{n:"min",f:"1",t:13},{n:"value",f:[{t:2,r:"allotment",p:[88,25,2867]}],t:13},{f:{a:{r:[],s:'["allotment"]'},n:"Label"},t:71}]}," ",{p:[91,11,2948],t:7,e:"input",m:[{n:"type",f:"color",t:13},{f:{a:{r:[],s:'["color"]'},n:"RGB"},t:71},{f:{a:{r:[],s:'["color"]'},n:"Label"},t:71}]}]}]}],n:52,r:"activities",p:[77,5,2253]}]}],Patterns:[{p:[100,3,3112],t:7,e:"ul",m:[{n:"class",f:"patterns",t:13}],f:[{t:4,f:[{p:[102,7,3165],t:7,e:"li",m:[{t:71,f:"Button"},{n:"class-selected",f:[{t:2,x:{r:["i","~/inputs.selectedPattern"],s:"_0===_1"},p:[103,27,3205]}],t:13},{n:"click",f:{x:{r:["@this","i"],s:'[_0.fire("select-pattern",_1)]'}},t:70},{f:{a:{r:[],s:'[{Duplicate:"duplicate-pattern",Remove:"remove-pattern"}]'},n:"ContextMenu"},t:71}],f:[{t:2,r:"name",p:[106,9,3393]}]}],n:52,i:"i",r:"patterns",p:[101,5,3138]}]}," ",{t:4,f:[{p:[111,5,3480],t:7,e:"section",m:[{n:"class",f:"pattern",t:13}],f:[{p:[112,7,3512],t:7,e:"Heading",f:[{p:[112,16,3521],t:7,e:"DisguisedInput",m:[{n:"value",f:[{t:2,r:"name",p:[112,39,3544]}],t:13}]}]}," ",{t:19,z:[{n:"level",x:{x:{r:["level"],s:"_0+1"}}}],f:[{t:8,r:"PatternSlots"}],p:[113,7,3575]}," ",{p:[114,7,3617],t:7,e:"div",m:[{n:"class",f:"requires-excludes",t:13}],f:[{p:[115,9,3657],t:7,e:"section",m:[{n:"class",f:"requires",t:13}],f:[{p:[116,11,3694],t:7,e:"Heading",m:[{n:"level",f:[{t:2,x:{r:["level"],s:"_0+1"},p:[116,27,3710]}],t:13}],f:["Requires"]}," ",{p:[117,11,3756],t:7,e:"textarea",m:[{f:{a:{r:[],s:'["requires"]'},n:"ListOfOneBasedLists"},t:71}]}]}," ",{p:[119,9,3841],t:7,e:"section",m:[{n:"class",f:"excludes",t:13}],f:[{p:[120,11,3878],t:7,e:"Heading",m:[{n:"level",f:[{t:2,x:{r:["level"],s:"_0+1"},p:[120,27,3894]}],t:13}],f:["Excludes"]}," ",{p:[121,11,3940],t:7,e:"textarea",m:[{f:{a:{r:[],s:'["excludes"]'},n:"ListOfOneBasedLists"},t:71}]}]}]}]}],n:54,rx:{r:"patterns",m:[{t:30,n:"selectedPattern"}]},p:[110,3,3440]}],PatternSlots:[{p:[129,3,4099],t:7,e:"ol",m:[{n:"class",f:"slots",t:13}],f:[{t:4,f:[{p:[131,7,4144],t:7,e:"li",m:[{n:"style-background-color",f:[{t:2,x:{r:["cssColorFromRGB","activity","~/inputs.activities"],s:"_0(_2[_1].color)"},p:[131,35,4172]}],t:13},{n:"class-white-text",f:[{t:2,x:{r:["isDark","activity","~/inputs.activities"],s:"_0(_2[_1].color)"},p:[132,29,4260]}],t:13},{n:"class-non-optional",f:[{t:2,x:{r:["optional"],s:"!_0"},p:[133,31,4341]}],t:13},{n:"class-disabled",f:[{t:2,x:{r:["enabled"],s:"!_0"},p:[134,27,4384]}],t:13},{f:{a:{r:["optional","enabled"],s:'[{Duplicate:"duplicate-pattern-slot",Remove:"remove-pattern-slot"},_0?{"Make Mandatory":"toggle-pattern-slot-optional"}:{"Make Optional":"toggle-pattern-slot-optional"},_1?{Disable:"toggle-pattern-slot-enabled"}:{Enable:"toggle-pattern-slot-enabled"}]'},n:"ContextMenu"},t:71}],f:[{p:[136,9,4728],t:7,e:"DisguisedSelect",m:[{n:"values",f:[{t:2,r:"~/inputs.activities",p:[136,34,4753]}],t:13},{n:"i",f:[{t:2,r:"activity",p:[136,64,4783]}],t:13}],f:[{t:2,r:"name",p:[137,11,4810]}]}," ",{p:[139,9,4856],t:7,e:"span",m:[{n:"class",f:"controls",t:13}],f:[{p:[140,11,4890],t:7,e:"input",m:[{n:"type",f:"number",t:13},{t:71,f:"ClampedNumber"},{n:"min",f:"1",t:13},{n:"max",f:[{t:2,r:"maximumTime",p:[141,31,4958]}],t:13},{n:"value",f:[{t:2,r:"minimumTime",p:[142,25,5001]}],t:13},{f:{a:{r:[],s:'["minimum time"]'},n:"Label"},t:71}]}," ≤ ",{p:[145,11,5091],t:7,e:"input",m:[{n:"type",f:"number",t:13},{t:71,f:"ClampedNumber"},{n:"min",f:[{t:2,r:"minimumTime",p:[146,23,5151]}],t:13},{n:"max",f:[{t:2,r:"maximumTime",p:[146,47,5175]}],t:13},{n:"value",f:[{t:2,r:"preferredTime",p:[147,25,5218]}],t:13},{f:{a:{r:[],s:'["preferred time"]'},n:"Label"},t:71}]}," ≤ ",{p:[150,11,5312],t:7,e:"input",m:[{n:"type",f:"number",t:13},{t:71,f:"ClampedNumber"},{n:"min",f:[{t:2,r:"minimumTime",p:[151,23,5372]}],t:13},{n:"value",f:[{t:2,r:"maximumTime",p:[152,25,5415]}],t:13},{f:{a:{r:[],s:'["maximum time"]'},n:"Label"},t:71}]}]}]}],n:52,r:"slots",p:[130,5,4122]}]}],Timespan:[{p:[162,3,5569],t:7,e:"section",m:[{n:"class",f:"timespan",t:13},{n:"style---day-length",f:[{t:2,r:"dayLength",p:[162,49,5615]}],t:13}],f:[{p:[163,5,5637],t:7,e:"Heading",f:["Timespan"]}," ",{t:4,f:[{t:4,f:[{t:4,f:[{t:19,z:[{n:"level",x:{x:{r:["level"],s:"_0+1"}}}],f:[{t:8,r:"Hours"}],p:[167,13,5783]}],n:50,x:{r:["i"],s:"_0!==0"},p:[166,11,5752]}," ",{p:[169,9,5836],t:7,e:"div",m:[{n:"class",f:"spacer",t:13}]}," ",{t:19,z:[{n:"level",x:{x:{r:["level"],s:"_0+1"}}}],f:[{t:8,r:"Hours"}],p:[170,9,5871]}],n:50,x:{r:["i","date"],s:"_0===0||_1.getUTCDay()===0"},p:[165,9,5697]},{t:19,z:[{n:"level",x:{x:{r:["level"],s:"_0+1"}}}],f:[{t:8,r:"Day"}],p:[172,9,5930]}],n:52,i:"i",r:"days",p:[164,5,5669]},{t:19,z:[{n:"level",x:{x:{r:["level"],s:"_0+1"}}}],f:[{t:8,r:"Hours"}],p:[174,7,5985]}]}],Hours:[{p:[179,3,6062],t:7,e:"ol",m:[{n:"class",f:"hours",t:13},{n:"style-width",f:[{t:2,r:"hoursWidth",p:[179,34,6093]},"px"],t:13}],f:[{t:4,f:[{p:[181,7,6142],t:7,e:"li",m:[{n:"style---slot-index",f:[{t:2,r:"start",p:[181,31,6166]}],t:13}],f:[{t:2,r:"name",p:[182,9,6188]}]}],n:52,i:"i",r:"hours",p:[180,5,6118]}]}],Day:[{p:[189,3,6266],t:7,e:"section",m:[{n:"class",f:"day",t:13},{n:"style-width",f:[{t:2,r:"~/timespan.dayWidth",p:[189,37,6300]},"px"],t:13}],f:[{p:[190,5,6334],t:7,e:"Heading",f:[{t:2,r:"name",p:[190,14,6343]}]}," ",{p:[191,5,6368],t:7,e:"ol",m:[{n:"class",f:"slots",t:13},{n:"class-selection",f:[{t:2,x:{r:["~/selectionStart","./end","~/selectionEnd","./start"],s:"_0<_1&&_2>_3"},p:[192,26,6411]}],t:13},{n:"style---selection-start",f:[{t:2,x:{r:["~/selectionStart","./start"],s:"Math.max(0,_0-_1)|0"},p:[193,34,6510]}],t:13},{n:"style---selection-length",f:[{t:2,x:{r:["./end","~/selectionEnd","./start","~/selectionStart"],s:"Math.min(_0,_1)-Math.max(_2,_3)|0"},p:[194,35,6596]}],t:13},{n:"mousedown",f:"selectionStart",t:70},{n:"mousemove",f:"selectionProgress",t:70}],f:[{t:4,f:[{t:19,f:[{t:19,z:[{n:"level",x:{x:{r:["level"],s:"_0+1"}}}],f:[{t:8,r:"Slot"}],p:[199,11,6880]}],n:54,z:[{n:"slotLength",x:{x:{r:["i","slots","dayLength","start"],s:"(_1[_0+1]||{start:_2}).start-_3"}}}],p:[198,9,6793]}],n:52,i:"i",r:"slots",p:[197,7,6767]}]}]}],Slot:[{p:[207,3,6999],t:7,e:"li",m:[{n:"style---slot-index",f:[{t:2,r:"start",p:[207,27,7023]}],t:13},{n:"style---slot-length",f:[{t:2,r:"slotLength",p:[208,28,7063]}],t:13},{n:"style-background-color",f:[{t:2,x:{r:["cssColorFromRGB","color"],s:"_0(_1)"},p:[209,31,7111]}],t:13},{n:"class-white-text",f:[{t:2,x:{r:["isDark","color"],s:"_0(_1)"},p:[210,25,7165]}],t:13}],f:[{p:[211,5,7191],t:7,e:"span",m:[{n:"class",f:"activity",t:13}],f:[{t:2,r:"activity",p:[211,28,7214]}]}," ",{p:[212,5,7240],t:7,e:"span",m:[{n:"class",f:"duration",t:13}],f:[{t:2,x:{r:["formatDuration","slotLength"],s:"_0(_1)"},p:[212,28,7263]}]}]}]},e:{"_0>0":function(t){return t>0}}};var sc=Gr.extend(oc.exports),ac={exports:{}};ac.exports.template={v:4,t:[{t:4,f:[{p:[2,3,21],t:7,e:"h1",f:[{t:16,p:[2,7,25]}]}],n:50,x:{r:["level"],s:"_0==1"},p:[1,1,0]},{t:4,n:50,f:[{p:[4,3,64],t:7,e:"h2",f:[{t:16,p:[4,7,68]}]}],x:{r:["level"],s:"_0==2"},l:1},{t:4,n:50,f:[" ",{p:[6,3,107],t:7,e:"h3",f:[{t:16,p:[6,7,111]}]}],x:{r:["level"],s:"_0==3"},l:1},{t:4,n:50,f:[" ",{p:[8,3,150],t:7,e:"h4",f:[{t:16,p:[8,7,154]}]}],x:{r:["level"],s:"_0==4"},l:1},{t:4,n:50,f:[" ",{p:[10,3,193],t:7,e:"h5",f:[{t:16,p:[10,7,197]}]}],x:{r:["level"],s:"_0==5"},l:1},{t:4,n:51,f:[" ",{p:[12,3,223],t:7,e:"h6",f:[{t:16,p:[12,7,227]}]}],l:1}],e:{"_0==1":function(t){return 1==t},"_0==2":function(t){return 2==t},"_0==3":function(t){return 3==t},"_0==4":function(t){return 4==t},"_0==5":function(t){return 5==t}}};var uc=Gr.extend(ac.exports),hc={exports:{}};hc.exports.template={v:4,t:[{t:4,f:[{p:[2,3,21],t:7,e:"input",m:[{n:"type",f:"text",t:13},{n:"value",f:[{t:2,r:"value",p:[2,29,47]}],t:13},{n:"blur",f:{x:{r:["@this"],s:'[_0.set("selected",false)]'}},t:70},{n:"keypress",f:{x:{r:["event.original.key","@this"],s:'[/^(Enter|Escape)$/.test(_0)?_1.set("selected",false):true]'}},t:70},{t:71,f:"PreSelected"}]}],n:50,r:"~/selected",p:[1,1,0]},{t:4,n:51,f:[{p:[4,3,224],t:7,e:"span",m:[{t:71,f:"Button"},{n:"click",f:{x:{r:["@this"],s:'[_0.set("selected",true)]'}},t:70}],f:[{t:2,r:"value",p:[4,58,279]}]}],l:1}],e:{'[_0.set("selected",false)]':function(t){return[t.set("selected",!1)]},'[/^(Enter|Escape)$/.test(_0)?_1.set("selected",false):true]':function(t,e){return[!/^(Enter|Escape)$/.test(t)||e.set("selected",!1)]},'[_0.set("selected",true)]':function(t){return[t.set("selected",!0)]}}};var lc=Gr.extend(hc.exports),cc={exports:{}};cc.exports.template={v:4,t:[{t:4,f:[{p:[2,3,21],t:7,e:"select",m:[{n:"value",f:[{t:2,r:"i",p:[2,18,36]}],t:13},{n:"blur",f:{x:{r:["@this"],s:'[_0.set("selected",false)]'}},t:70},{n:"change",f:{x:{r:["@this"],s:'[_0.set("selected",false)]'}},t:70},{t:71,f:"PreSelected"}],f:[{t:4,f:[{p:[4,7,170],t:7,e:"option",m:[{n:"value",f:[{t:2,r:"i",p:[4,22,185]}],t:13}],f:[{t:8,r:"content",p:[4,31,194]}]}],n:52,i:"i",r:"values",p:[3,5,145]}]}],n:50,r:"~/selected",p:[1,1,0]},{t:4,n:51,f:[{p:[8,3,254],t:7,e:"span",m:[{t:71,f:"Button"},{n:"click",f:{x:{r:["@this"],s:'[_0.set("selected",true)]'}},t:70},{n:"tabindex",f:"0",t:13}],f:[{t:4,f:[{t:8,r:"content",p:[10,7,353]}],n:54,rx:{r:"values",m:[{t:30,n:"i"}]},p:[9,5,327]}]}],l:1}],e:{'[_0.set("selected",false)]':function(t){return[t.set("selected",!1)]},'[_0.set("selected",true)]':function(t){return[t.set("selected",!0)]}}};var pc=Gr.extend(cc.exports),fc=0,dc=[],mc=!1;Gr.DEBUG=mc,window.addEventListener("load",function(){function t(){var t=window.devicePixelRatio||1;t!==c&&(c=t,document.body.style.setProperty("--physical-pixel",1/t+"px"))}function e(t){for(var e=1;e<arguments.length;++e)t+=".",t+=arguments[e];return t}function n(t,n,i){for(var r=p.get(t),o=0;o<r.length;++o){var s=i?r[o][i]:r[o];s===n?p.splice(t,o--,1):s>n&&(i?p.set(e(t,o,i),s-1):p.set(e(t,o),s-1))}}function i(t,n,i){for(var r=p.get(t),o=0;o<r.length;++o){var s=i?r[o][i]:r[o];s>=n&&(i?p.set(e(t,o,i),s+1):p.set(e(t,o),s+1))}}function r(t,n,i){for(var r=n.slice(0,n.lastIndexOf(".")),o=p.get(e(r,"requires")).length,s=0;s<o;++s)t(e(r,"requires",s),i);for(var a=p.get(e(r,"excludes")).length,u=0;u<a;++u)t(e(r,"excludes",u),i)}function o(t,n){for(var i=p.get("inputs.patterns").length,r=0;r<i;++r)t(e("inputs.patterns",r,"slots"),n,"activity"),t(e("inputs.patterns",r,"once"),n,"activity");t("inputs.once",n,"activity")}function s(t,e){t("inputs.week",e);var i=p.get("inputs.selectedPattern");if(t===n&&i===e)p.set("inputs.selectedPattern",-1);else if(i>=e){var r=t===n?-1:1;p.set("inputs.selectedPattern",i+r)}}function a(t,e,n,i){for(var r=e,o=[];r<n;){var s=t.get(r);o.push({start:r-e,color:s?i[s]:{r:0,g:0,b:0},activity:s||""}),r=t.findEnd({from:r,to:n})}return o}function u(t,n,i){var r=p.get("timespan.dayLength"),o=Math.floor(n/r),s=Math.ceil(i/r),u={};p.get("inputs.activities").forEach(function(t){var e=t.name,n=t.color;u[e]=n});for(var h=o;h<s;++h)p.set(e("timespan.days",h,"slots"),a(t,h*r,(h+1)*r,u))}var c=0;t(),window.addEventListener("resize",t);var p=window.rct=new sc({el:document.body,data:{cssColorFromRGB:function(t){function e(t){return Math.round(255*t)}var n=t.r,i=t.g,r=t.b;return"rgb("+e(n)+", "+e(i)+", "+e(r)+")"},isDark:function(t){var e=t.r,n=t.g,i=t.b;return.299*e*e+.587*n*n+.114*i*i<.25},formatDuration:function(t){t=t*this.get("timespan.dayLengthInSeconds")/this.get("timespan.dayLength");var e=Math.round(t%60);t=t/60|0;var n=t%60;t=t/60|0;var i="";return t&&(i+=t+"h"),n&&(i+=n+"m"),e&&(i+=e+"s"),i},formatVersion:2,level:1,error:null,inputs:{dayCount:7,slotsPerDay:28,dayStart:"9:00",dayEnd:"23:00",firstDay:(new Date).toDateString(),activities:[{name:"activity 1",color:{r:.85,g:.85,b:.85},allotment:1,timeSpentSoFar:0},{name:"activity 2",color:{r:.2,g:.3,b:.9},allotment:2,timeSpentSoFar:0}],patterns:[{name:"pattern 1",slots:[{activity:0,preferredTime:6,minimumTime:1,maximumTime:12,enabled:!0,optional:!0},{activity:1,preferredTime:6,minimumTime:1,maximumTime:12,enabled:!0,optional:!0},{activity:0,preferredTime:6,minimumTime:1,maximumTime:12,enabled:!0,optional:!0},{activity:1,preferredTime:6,minimumTime:1,maximumTime:12,enabled:!0,optional:!0}],requires:[],excludes:[[0,2],[1,3]],once:[]}],selectedPattern:-1,week:[],once:[]},timespan:{data:null,rawSelection:{start:NaN,end:NaN},hoursWidth:40,dayWidth:150,dayLength:24,dayLengthInSeconds:86400,hours:[],days:[]}},computed:{selectionStart:function(){return Math.min(this.get("timespan.rawSelection.start"),this.get("timespan.rawSelection.end"))},selectionEnd:function(){return Math.max(this.get("timespan.rawSelection.start"),this.get("timespan.rawSelection.end"))+1}},components:{Heading:uc,DisguisedInput:lc,DisguisedSelect:pc},decorators:{ClampedNumber:Yr,RGB:Xr,Label:to,PreSelected:eo,Button:no,ContextMenu:io,ListOfOneBasedLists:ao}});p.on("duplicate-pattern-slot",function(t,e){var n=t.resolve(),o=n.lastIndexOf("."),s=Gr.getNodeInfo(e.closest(".pattern")).resolve()+".slots",a=+n.slice(o+1),u=Object.assign({},t.get());p.splice(s,a+1,0,u),r(i,s,a+1)}),p.on("remove-pattern-slot",function(t,e){var i=t.resolve(),o=i.lastIndexOf("."),s=Gr.getNodeInfo(e.closest(".pattern")).resolve()+".slots",a=+i.slice(o+1);r(n,s,a),p.splice(s,a,1)}),p.on("toggle-pattern-slot-optional",function(t){t.toggle("optional")}),p.on("toggle-pattern-slot-enabled",function(t){t.toggle("enabled")}),p.on("duplicate-activity",function(t){var e=t.resolve(),n=e.lastIndexOf("."),r=e.slice(0,n),s=+e.slice(n+1),a=Object.assign({},t.get());p.splice(r,s+1,0,a),o(i,s+1)}),p.on("remove-activity",function(t){var e=t.resolve(),i=e.lastIndexOf("."),r=e.slice(0,i),s=+e.slice(i+1);o(n,s),p.splice(r,s,1)}),p.on("duplicate-pattern",function(t){var e=t.resolve(),n=e.lastIndexOf("."),r=e.slice(0,n),o=+e.slice(n+1),a=JSON.parse(JSON.stringify(t.get()));p.splice(r,o+1,0,a),s(i,o+1)}),p.on("remove-pattern",function(t){var e=t.resolve(),i=e.lastIndexOf("."),r=e.slice(0,i),o=+e.slice(i+1);s(n,o),p.splice(r,o,1)}),p.on("select-pattern",function(t){p.get("inputs.selectedPattern")===t?p.set("inputs.selectedPattern",-1):(p.set("inputs.selectedPattern",t),so())}),p.on("generate-schedule",function(){var t={},e={},n={},i=p.get("inputs.activities");i.forEach(function(i){var r=i.name,o=i.color,s=i.allotment,a=i.timeSpentSoFar;t[r]=a,e[r]=s,n[r]=o});var r=p.get("timespan.days"),o=p.get("timespan.data"),s=0;if(o){s=o.length;for(var u=0;u<s;){var l=o.findEnd({from:u}),c=o.get(u);"number"==typeof t[c]&&(t[c]+=l-u),u=l}}for(var d={patterns:p.get("inputs.patterns").map(function(t){function e(t){return t.map(function(t){return t.filter(function(t){return n[t].enabled}).map(function(t){return""+t})})}for(var n=t.slots,r={},o=[],s=0;s<n.length;++s){var a=""+s,u=n[s];u.enabled&&(r[a]={activity:i[u.activity].name,preferredTime:u.preferredTime,minimumTime:u.minimumTime,maximumTime:u.maximumTime},u.optional||o.push(a))}return{slots:r,requires:e(t.requires),excludes:e(t.excludes),nonoptional:o,once:{}}}),once:{},timeSpentSoFar:t,allotments:e},m=p.get("inputs.slotsPerDay"),v=p.get("inputs.dayCount"),g=f({dayLength:m,dayCount:v,activities:d}),y=[],b=new Date(p.get("inputs.firstDay")).getTime()+864e5*r.length,w=0;w<m*v;b+=864e5){var k=w,x=w+m,E=new Date(b);y.push({name:E.toDateString(),date:E,start:k+s,end:x+s,slots:a(g,k,x,n)}),w=x}for(var _=p.get("timespan"),A=_.hoursWidth,C=_.dayWidth,S=p.get("inputs.slotsPerDay"),O=0|h(p.get("inputs.dayStart")),T=h(p.get("inputs.dayEnd"))||86400,N=T-O,F=[],j=0;j<S;j+=2){var P=j*N/m+O;F.push({start:j,name:(P/60/60|0)+":"+("0"+(P/60|0)%60).slice(-2)})}if(o){var M=o.resize(s+g.length);M.copyFrom({other:g,start:s}),p.set("timespan.data",M),p.push.apply(p,["timespan.days"].concat(y))}else p.set("timespan",{data:g,hoursWidth:A,dayWidth:C,dayLength:S,dayLengthInSeconds:N,hours:F,days:y})}),p.on("absorb-schedule",function(){var t=p.get("timespan.data");if(t){var e=p.get("timespan.days"),n=p.get("timespan.dayLength"),i=Math.ceil(p.get("selectionEnd")/n);(Number.isNaN(i)||Number.isNaN(+p.get("selectionStart")))&&(i=e.length);for(var r={},o=0;o<i*n;){var s=t.findEnd({from:o,to:i*n}),a=s-o,u=t.get(o);r[u]=(0|r[u])+a,o=s}for(var h=p.get("inputs.activities"),c=0;c<h.length;++c){var f=r[h[c].name];f&&p.add("inputs.activities."+c+".timeSpentSoFar",f)}if(p.set("inputs.firstDay",new Date(new Date(p.get("inputs.firstDay")).getTime()+864e5*i).toDateString()),i!==e.length){e.splice(0,i);for(var d=0,m=e.length;d<m;++d)e[d].start-=i*n,e[d].end-=i*n;p.update("timespan.days");var v=l(e.length*n);v.copyFrom({other:t,from:i*n}),p.set("timespan.data",v),p.set("timespan.rawSelection",{start:NaN,end:NaN})}else p.set("timespan.data",null),p.set("timespan.days",[])}}),p.on("discard-schedule",function(){var t=p.get("timespan.data");if(t){var e=+p.get("selectionStart"),n=+p.get("selectionEnd");if(n>e){for(var i=p.get("timespan.dayLength"),r=Math.floor(e/i),o=Math.ceil(n/i),s=o-r,a=p.get("timespan.days"),u=o,h=a.length;u<h;++u)a[u-s].slots=a[u].slots;a.length-=s,p.update("timespan.days"),t.copyFrom({from:o*i,start:r*i}),p.set("timespan.data",t=t.resize(t.length-s*i)),p.set("timespan.rawSelection",{start:NaN,end:NaN})}else p.set("timespan.data",null),p.set("timespan.days",[])}}),p.on("selectionStart selectionProgress",function(t){if(1&t.original.buttons){var e=t.original.offsetY/20+t.get("start")|0;"selectionStart"===t.name&&p.set("timespan.rawSelection.start",e),p.set("timespan.rawSelection.end",e),t.original.preventDefault(),t.original.stopPropagation()}}),document.body.addEventListener("mousedown",function(t){1&t.buttons&&"BUTTON"!==t.target.tagName&&p.set("timespan.rawSelection",{start:NaN,end:NaN})}),p.on("apply-activity",function(t){var e=+p.get("selectionStart"),n=+p.get("selectionEnd");if(n>e){var i=t?t.get("name"):void 0,r=p.get("timespan.data");r.overwrite({from:e,to:n,activity:i}),u(r,e,n)}}),window.addEventListener("keypress",function(t){"Delete"===t.key&&p.fire("apply-activity",!1)}),p.on("save-to-file",function(){var t=JSON.stringify(p.get(),function(t,e){if("level"!==t&&"selectionStart"!==t&&"selectionEnd"!==t&&"rawSelection"!==t&&"data"!==t&&("color"!==t||"number"!=typeof this.start))return e;
},2);window.open("data:application/json;charset=utf-8,"+encodeURIComponent(t))}),p.on("load-from-file",function(){var t=document.createElement("input");t.setAttribute("type","file"),t.addEventListener("change",function(){var e=t.files[0];if(e){var n=new FileReader;n.addEventListener("load",function(){var t=void 0;try{!function(){t=JSON.parse(n.result);var e=t.formatVersion;if(e!==(0|e)||e<1||e>p.get("formatVersion"))throw Error("Unsupported version "+e+"!");e<=1&&t.inputs.patterns.forEach(function(t){return t.slots.forEach(function(t){t.enabled=!0})}),t.timespan.rawSelection={start:NaN,end:NaN};var i=t.timespan,r=i.days,o=i.dayLength,s=t.timespan.data=l(r.length*o),a={};t.inputs.activities.forEach(function(t){var e=t.name,n=t.color;a[e]=n});for(var u=0;u<r.length;++u){for(var h=r[u],c=(h.start,h.end),f=h.slots,d=0;d<f.length;++d){var m=d+1<f.length?f[d+1].start:c;s.overwrite({from:f[d].start,to:m,activity:f[d].activity}),f[d].color=a[f[d].activity]||{r:0,g:0,b:0}}r[u].date=new Date(r[u].date)}}()}catch(t){return void p.set("error",{text:String(t),time:Date.now()})}p.set("inputs",t.inputs),p.set("timespan",t.timespan)}),n.readAsText(e)}}),t.click()})})}();